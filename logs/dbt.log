[0m18:10:59.326851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae02bd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb11a9de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb11a9db50>]}


============================== 18:10:59.345667 | 9d93b273-607d-4555-938b-76cf17955c8e ==============================
[0m18:10:59.345667 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:10:59.346272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/remi.turpaud/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:11:00.521593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d93b273-607d-4555-938b-76cf17955c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb10e174c0>]}
[0m18:11:00.560564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d93b273-607d-4555-938b-76cf17955c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad023a880>]}
[0m18:11:00.569077 [info ] [MainThread]: Registered adapter: teradata=1.8.0
[0m18:11:00.679683 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:11:00.680801 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:11:00.681183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9d93b273-607d-4555-938b-76cf17955c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad01e05b0>]}
[0m18:11:03.064355 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:11:03.064966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9d93b273-607d-4555-938b-76cf17955c8e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb10f0deb0>]}
[0m18:11:03.075345 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_payment_methods' in the 'models' section of file 'models/consumption/schema.yml'
[0m18:11:03.243113 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop_teradata.unique_dim_payment_methods_payment_method.e12b7484d3' (models/consumption/schema.yml) depends on a node named 'dim_payment_methods' in package '' which was not found
[0m18:11:03.243619 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop_teradata.not_null_dim_payment_methods_payment_method.7e4391cf98' (models/consumption/schema.yml) depends on a node named 'dim_payment_methods' in package '' which was not found
[0m18:11:03.343972 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop
- models.jaffle_shop.staging
[0m18:11:03.356241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d93b273-607d-4555-938b-76cf17955c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad03d8a60>]}
[0m18:11:03.599237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d93b273-607d-4555-938b-76cf17955c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac00e46d0>]}
[0m18:11:03.600006 [info ] [MainThread]: Found 19 models, 1 snapshot, 3 seeds, 8 data tests, 1 source, 573 macros
[0m18:11:03.600462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d93b273-607d-4555-938b-76cf17955c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac00ed940>]}
[0m18:11:03.602576 [info ] [MainThread]: 
[0m18:11:03.603213 [debug] [MainThread]: Acquiring new teradata connection 'master'
[0m18:11:03.609633 [debug] [ThreadPool]: Acquiring new teradata connection 'list_schemas'
[0m18:11:03.617530 [debug] [ThreadPool]: Using teradata connection "list_schemas"
[0m18:11:03.617956 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_schemas"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
[0m18:11:03.618268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:06.798985 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:06.801671 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:07.192658 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 46 in 3.573 seconds
[0m18:11:07.198519 [debug] [ThreadPool]: On list_schemas: Close
[0m18:11:07.292504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_schemas, now list_None_demo_user)
[0m18:11:07.299951 [debug] [ThreadPool]: Using teradata connection "list_None_demo_user"
[0m18:11:07.300552 [debug] [ThreadPool]: On list_None_demo_user: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_None_demo_user"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
[0m18:11:07.301077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:08.325463 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:08.328255 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:08.605353 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 0 in 1.304 seconds
[0m18:11:08.609980 [debug] [ThreadPool]: On list_None_demo_user: Close
[0m18:11:08.765657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None_demo_user, now list_None_rt186001)
[0m18:11:08.776116 [debug] [ThreadPool]: Using teradata connection "list_None_rt186001"
[0m18:11:08.776983 [debug] [ThreadPool]: On list_None_rt186001: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_None_rt186001"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'rt186001' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
[0m18:11:08.777621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:09.839996 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:09.841799 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:10.075940 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 0 in 1.298 seconds
[0m18:11:10.080844 [debug] [ThreadPool]: On list_None_rt186001: Close
[0m18:11:10.177826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d93b273-607d-4555-938b-76cf17955c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb11e07ee0>]}
[0m18:11:10.179887 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:11:10.180444 [info ] [MainThread]: 
[0m18:11:10.195811 [debug] [Thread-1  ]: Began running node seed.jaffle_shop_teradata.raw_customers
[0m18:11:10.197200 [info ] [Thread-1  ]: 1 of 3 START seed file demo_user.raw_customers ................................. [RUN]
[0m18:11:10.198197 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_None_rt186001, now seed.jaffle_shop_teradata.raw_customers)
[0m18:11:10.198910 [debug] [Thread-1  ]: Began compiling node seed.jaffle_shop_teradata.raw_customers
[0m18:11:10.199603 [debug] [Thread-1  ]: Began executing node seed.jaffle_shop_teradata.raw_customers
[0m18:11:10.226364 [debug] [Thread-1  ]: Setting query_band
[0m18:11:10.245133 [debug] [Thread-1  ]: model : {'schema': 'demo_user', 'name': 'raw_customers', 'resource_type': 'seed', 'package_name': 'jaffle_shop_teradata', 'path': 'raw_customers.csv', 'original_file_path': 'data/raw_customers.csv', 'unique_id': 'seed.jaffle_shop_teradata.raw_customers', 'fqn': ['jaffle_shop_teradata', 'raw_customers'], 'alias': 'raw_customers', 'checksum': {'name': 'sha256', 'checksum': '38a2c3b55aed9b798b98b1b249d48ee89b4fa1c494b6e7a73b8dc66aaaae188f'}, 'config': {'enabled': True, 'tags': [], 'meta': {}, 'materialized': 'seed', 'persist_docs': {}, 'post-hook': [], 'pre-hook': [], 'quoting': {}, 'column_types': {}, 'on_schema_change': 'ignore', 'on_configuration_change': 'apply', 'grants': {}, 'packages': [], 'docs': {'show': True}, 'contract': {'enforced': False, 'alias_types': True}, 'delimiter': ','}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'unrendered_config': {}, 'created_at': 1725293462.959593, 'config_call_dict': {}, 'relation_name': '"demo_user"."raw_customers"', 'raw_code': '', 'root_path': '/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata', 'depends_on': {'macros': []}}
[0m18:11:10.246466 [debug] [Thread-1  ]: Using teradata connection "seed.jaffle_shop_teradata.raw_customers"
[0m18:11:10.246841 [debug] [Thread-1  ]: On seed.jaffle_shop_teradata.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "seed.jaffle_shop_teradata.raw_customers"} */

    
    CREATE  TABLE "demo_user"."raw_customers"
    
    ("id" INTEGER,"first_name" LONG VARCHAR,"last_name" LONG VARCHAR,"email" LONG VARCHAR)
    ;

  
[0m18:11:10.247171 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:11.254922 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:11.257764 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:11.641608 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 1.394 seconds
[0m18:11:11.657309 [debug] [Thread-1  ]: Using teradata connection "seed.jaffle_shop_teradata.raw_customers"
[0m18:11:11.657791 [debug] [Thread-1  ]: On seed.jaffle_shop_teradata.raw_customers: insert into "demo_user"."raw_customers" ("id", "first_name", "last_name", "email") values
                (?,?,?,?)
        ...
[0m18:11:12.024278 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 1 in 0.365 seconds
[0m18:11:12.034026 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.jaffle_shop_teradata.raw_customers"
[0m18:11:12.061700 [debug] [Thread-1  ]: On seed.jaffle_shop_teradata.raw_customers: Close
[0m18:11:12.154138 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d93b273-607d-4555-938b-76cf17955c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb11c6b8e0>]}
[0m18:11:12.155545 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file demo_user.raw_customers ............................. [[32mINSERT 100[0m in 1.95s]
[0m18:11:12.156720 [debug] [Thread-1  ]: Finished running node seed.jaffle_shop_teradata.raw_customers
[0m18:11:12.157499 [debug] [Thread-1  ]: Began running node seed.jaffle_shop_teradata.raw_orders
[0m18:11:12.158546 [info ] [Thread-1  ]: 2 of 3 START seed file demo_user.raw_orders .................................... [RUN]
[0m18:11:12.159417 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.jaffle_shop_teradata.raw_customers, now seed.jaffle_shop_teradata.raw_orders)
[0m18:11:12.160037 [debug] [Thread-1  ]: Began compiling node seed.jaffle_shop_teradata.raw_orders
[0m18:11:12.160617 [debug] [Thread-1  ]: Began executing node seed.jaffle_shop_teradata.raw_orders
[0m18:11:12.165173 [debug] [Thread-1  ]: Setting query_band
[0m18:11:12.176228 [debug] [Thread-1  ]: model : {'schema': 'demo_user', 'name': 'raw_orders', 'resource_type': 'seed', 'package_name': 'jaffle_shop_teradata', 'path': 'raw_orders.csv', 'original_file_path': 'data/raw_orders.csv', 'unique_id': 'seed.jaffle_shop_teradata.raw_orders', 'fqn': ['jaffle_shop_teradata', 'raw_orders'], 'alias': 'raw_orders', 'checksum': {'name': 'sha256', 'checksum': 'ddecd7adf70a07a88b9c302aec2a03fce615b925c2c06f2d5ef99a5c97b41250'}, 'config': {'enabled': True, 'tags': [], 'meta': {}, 'materialized': 'seed', 'persist_docs': {}, 'post-hook': [], 'pre-hook': [], 'quoting': {}, 'column_types': {}, 'on_schema_change': 'ignore', 'on_configuration_change': 'apply', 'grants': {}, 'packages': [], 'docs': {'show': True}, 'contract': {'enforced': False, 'alias_types': True}, 'delimiter': ','}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'unrendered_config': {}, 'created_at': 1725293462.961334, 'config_call_dict': {}, 'relation_name': '"demo_user"."raw_orders"', 'raw_code': '', 'root_path': '/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata', 'depends_on': {'macros': []}}
[0m18:11:12.177908 [debug] [Thread-1  ]: Using teradata connection "seed.jaffle_shop_teradata.raw_orders"
[0m18:11:12.178432 [debug] [Thread-1  ]: On seed.jaffle_shop_teradata.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "seed.jaffle_shop_teradata.raw_orders"} */

    
    CREATE  TABLE "demo_user"."raw_orders"
    
    ("id" INTEGER,"user_id" INTEGER,"order_date" DATE,"status" LONG VARCHAR)
    ;

  
[0m18:11:12.178897 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:13.177596 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:13.180389 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:13.504244 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 1.324 seconds
[0m18:11:13.515984 [debug] [Thread-1  ]: Using teradata connection "seed.jaffle_shop_teradata.raw_orders"
[0m18:11:13.516645 [debug] [Thread-1  ]: On seed.jaffle_shop_teradata.raw_orders: insert into "demo_user"."raw_orders" ("id", "user_id", "order_date", "status") values
                (?,?,?,?)
        ...
[0m18:11:13.778822 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 1 in 0.261 seconds
[0m18:11:13.781086 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.jaffle_shop_teradata.raw_orders"
[0m18:11:13.784256 [debug] [Thread-1  ]: On seed.jaffle_shop_teradata.raw_orders: Close
[0m18:11:13.877020 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d93b273-607d-4555-938b-76cf17955c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb11d0d7f0>]}
[0m18:11:13.879249 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file demo_user.raw_orders ................................ [[32mINSERT 99[0m in 1.72s]
[0m18:11:13.880829 [debug] [Thread-1  ]: Finished running node seed.jaffle_shop_teradata.raw_orders
[0m18:11:13.881662 [debug] [Thread-1  ]: Began running node seed.jaffle_shop_teradata.raw_payments
[0m18:11:13.882772 [info ] [Thread-1  ]: 3 of 3 START seed file demo_user.raw_payments .................................. [RUN]
[0m18:11:13.883737 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.jaffle_shop_teradata.raw_orders, now seed.jaffle_shop_teradata.raw_payments)
[0m18:11:13.884433 [debug] [Thread-1  ]: Began compiling node seed.jaffle_shop_teradata.raw_payments
[0m18:11:13.885089 [debug] [Thread-1  ]: Began executing node seed.jaffle_shop_teradata.raw_payments
[0m18:11:13.891924 [debug] [Thread-1  ]: Setting query_band
[0m18:11:13.901625 [debug] [Thread-1  ]: model : {'schema': 'demo_user', 'name': 'raw_payments', 'resource_type': 'seed', 'package_name': 'jaffle_shop_teradata', 'path': 'raw_payments.csv', 'original_file_path': 'data/raw_payments.csv', 'unique_id': 'seed.jaffle_shop_teradata.raw_payments', 'fqn': ['jaffle_shop_teradata', 'raw_payments'], 'alias': 'raw_payments', 'checksum': {'name': 'sha256', 'checksum': '6de0626a8db9c1750eefd1b2e17fac4c2a4b9f778eb50532d8b377b90de395e6'}, 'config': {'enabled': True, 'tags': [], 'meta': {}, 'materialized': 'seed', 'persist_docs': {}, 'post-hook': [], 'pre-hook': [], 'quoting': {}, 'column_types': {}, 'on_schema_change': 'ignore', 'on_configuration_change': 'apply', 'grants': {}, 'packages': [], 'docs': {'show': True}, 'contract': {'enforced': False, 'alias_types': True}, 'delimiter': ','}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'unrendered_config': {}, 'created_at': 1725293462.9627771, 'config_call_dict': {}, 'relation_name': '"demo_user"."raw_payments"', 'raw_code': '', 'root_path': '/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata', 'depends_on': {'macros': []}}
[0m18:11:13.903783 [debug] [Thread-1  ]: Using teradata connection "seed.jaffle_shop_teradata.raw_payments"
[0m18:11:13.904336 [debug] [Thread-1  ]: On seed.jaffle_shop_teradata.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "seed.jaffle_shop_teradata.raw_payments"} */

    
    CREATE  TABLE "demo_user"."raw_payments"
    
    ("id" INTEGER,"order_id" INTEGER,"payment_method" LONG VARCHAR,"amount" INTEGER)
    ;

  
[0m18:11:13.904850 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:14.925965 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:14.928095 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:15.232108 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 1.326 seconds
[0m18:11:15.238498 [debug] [Thread-1  ]: Using teradata connection "seed.jaffle_shop_teradata.raw_payments"
[0m18:11:15.239558 [debug] [Thread-1  ]: On seed.jaffle_shop_teradata.raw_payments: insert into "demo_user"."raw_payments" ("id", "order_id", "payment_method", "amount") values
                (?,?,?,?)
        ...
[0m18:11:15.469159 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 1 in 0.228 seconds
[0m18:11:15.471899 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.jaffle_shop_teradata.raw_payments"
[0m18:11:15.505077 [debug] [Thread-1  ]: On seed.jaffle_shop_teradata.raw_payments: Close
[0m18:11:15.604001 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d93b273-607d-4555-938b-76cf17955c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb11f494c0>]}
[0m18:11:15.607725 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file demo_user.raw_payments .............................. [[32mINSERT 113[0m in 1.72s]
[0m18:11:15.609260 [debug] [Thread-1  ]: Finished running node seed.jaffle_shop_teradata.raw_payments
[0m18:11:15.610631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:15.610986 [debug] [MainThread]: Connection 'seed.jaffle_shop_teradata.raw_payments' was properly closed.
[0m18:11:15.611355 [info ] [MainThread]: 
[0m18:11:15.611723 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 12.01 seconds (12.01s).
[0m18:11:15.613048 [debug] [MainThread]: Command end result
[0m18:11:15.666421 [info ] [MainThread]: 
[0m18:11:15.666958 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:11:15.667265 [info ] [MainThread]: 
[0m18:11:15.667592 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:11:15.701359 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 16.60803, "process_user_time": 4.438019, "process_kernel_time": 0.654632, "process_mem_max_rss": "138010624", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:11:15.702011 [debug] [MainThread]: Command `dbt seed` succeeded at 18:11:15.701919 after 16.61 seconds
[0m18:11:15.702367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae02bd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad023a880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb10e174c0>]}
[0m18:11:15.702690 [debug] [MainThread]: Flushing usage events
[0m18:11:27.883435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdce903e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcea81deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcea81dbe0>]}


============================== 18:11:27.889821 | 70b41da3-68b4-462a-85ce-c491dbb1cb56 ==============================
[0m18:11:27.889821 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:11:27.890316 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/remi.turpaud/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:11:28.182772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70b41da3-68b4-462a-85ce-c491dbb1cb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdceae33df0>]}
[0m18:11:28.222108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70b41da3-68b4-462a-85ce-c491dbb1cb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdce8ec4670>]}
[0m18:11:28.229371 [info ] [MainThread]: Registered adapter: teradata=1.8.0
[0m18:11:28.262070 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:11:28.521969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:11:28.522384 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:11:28.528273 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop
- models.jaffle_shop.staging
[0m18:11:28.590508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70b41da3-68b4-462a-85ce-c491dbb1cb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd0125fa0>]}
[0m18:11:28.792198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70b41da3-68b4-462a-85ce-c491dbb1cb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd01236a0>]}
[0m18:11:28.792850 [info ] [MainThread]: Found 19 models, 1 snapshot, 3 seeds, 8 data tests, 1 source, 573 macros
[0m18:11:28.793210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70b41da3-68b4-462a-85ce-c491dbb1cb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd014f9a0>]}
[0m18:11:28.795342 [info ] [MainThread]: 
[0m18:11:28.795923 [debug] [MainThread]: Acquiring new teradata connection 'master'
[0m18:11:28.801492 [debug] [ThreadPool]: Acquiring new teradata connection 'list_schemas'
[0m18:11:28.813997 [debug] [ThreadPool]: Using teradata connection "list_schemas"
[0m18:11:28.814447 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_schemas"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
[0m18:11:28.814723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:29.837010 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:29.839126 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:30.140815 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 46 in 1.325 seconds
[0m18:11:30.148531 [debug] [ThreadPool]: On list_schemas: Close
[0m18:11:30.252032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_schemas, now list_None_demo_user)
[0m18:11:30.270168 [debug] [ThreadPool]: Using teradata connection "list_None_demo_user"
[0m18:11:30.270733 [debug] [ThreadPool]: On list_None_demo_user: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_None_demo_user"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
[0m18:11:30.271137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:31.311151 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:31.314183 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:31.650402 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 3 in 1.378 seconds
[0m18:11:31.660547 [debug] [ThreadPool]: On list_None_demo_user: Close
[0m18:11:31.748540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None_demo_user, now list_None_rt186001)
[0m18:11:31.758726 [debug] [ThreadPool]: Using teradata connection "list_None_rt186001"
[0m18:11:31.760335 [debug] [ThreadPool]: On list_None_rt186001: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_None_rt186001"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'rt186001' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
[0m18:11:31.761494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:32.786239 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:32.786681 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:33.058604 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 0 in 1.297 seconds
[0m18:11:33.064597 [debug] [ThreadPool]: On list_None_rt186001: Close
[0m18:11:33.163477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70b41da3-68b4-462a-85ce-c491dbb1cb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdce8eb5280>]}
[0m18:11:33.175827 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:11:33.176680 [info ] [MainThread]: 
[0m18:11:33.181577 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.key_customer
[0m18:11:33.182172 [info ] [Thread-1  ]: 1 of 19 START sql incremental model demo_user.key_customer ..................... [RUN]
[0m18:11:33.182598 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_None_rt186001, now model.jaffle_shop_teradata.key_customer)
[0m18:11:33.182923 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.key_customer
[0m18:11:33.192426 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.key_customer"
[0m18:11:33.195376 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.key_customer
[0m18:11:33.228277 [debug] [Thread-1  ]: Setting query_band
[0m18:11:33.262235 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.key_customer"
[0m18:11:33.262741 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.key_customer"} */

      CREATE  TABLE
      "demo_user"."key_customer"
      AS (
            



--Create the surrogate key table with default members if it doesn't exist
select
    -1 (integer) customer_key
    ,'UNKNOWN' (varchar(10000)) customer_nk
    ,'' (char(100)) domain_cd
    ,current_timestamp created_ts
from (sel 1 a) dummy
        ) WITH NO DATA
      
      ;
    
[0m18:11:33.263035 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:34.441220 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:34.446232 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:34.840407 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 1.577 seconds
[0m18:11:34.844209 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.key_customer"
[0m18:11:34.849483 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.key_customer"
[0m18:11:34.850857 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.key_customer"} */

   
  
    
    

    INSERT INTO "demo_user"."key_customer"
          



--Create the surrogate key table with default members if it doesn't exist
select
    -1 (integer) customer_key
    ,'UNKNOWN' (varchar(10000)) customer_nk
    ,'' (char(100)) domain_cd
    ,current_timestamp created_ts
from (sel 1 a) dummy
    ;
  

  

[0m18:11:35.084292 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 1 in 0.231 seconds
[0m18:11:35.115599 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: Close
[0m18:11:35.219060 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b41da3-68b4-462a-85ce-c491dbb1cb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc98020a60>]}
[0m18:11:35.222928 [info ] [Thread-1  ]: 1 of 19 OK created sql incremental model demo_user.key_customer ................ [[32mactivity: Insert, rows_affected: 1[0m in 2.03s]
[0m18:11:35.226909 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.key_customer
[0m18:11:35.228254 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_market_customers
[0m18:11:35.233336 [info ] [Thread-1  ]: 2 of 19 START sql view model demo_user.lim_market_customers .................... [RUN]
[0m18:11:35.234599 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.key_customer, now model.jaffle_shop_teradata.lim_market_customers)
[0m18:11:35.235632 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_market_customers
[0m18:11:35.246790 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_market_customers"
[0m18:11:35.249637 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_market_customers
[0m18:11:35.254276 [debug] [Thread-1  ]: Setting query_band
[0m18:11:35.320795 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m18:11:35.321334 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    create foreign table demo_user.raw_market_customers using (location('/GS/storage.googleapis.com/clearscape_analytics_demo_data/DEMO_Market/Customer/'));
  
[0m18:11:35.321666 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:36.331935 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:36.334814 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:45.863604 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 10.541 seconds
[0m18:11:45.892056 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.lim_market_customers"
[0m18:11:45.894683 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m18:11:45.895173 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

  

  
  REPLACE VIEW "demo_user"."lim_market_customers__dbt_tmp" AS
    /*
  Build a light integrated modeled layer from source image 
  for entity `market_customers`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
*/

select
spend,
nearby5,
nearby10,
new ST_GEOMETRY(ptLocWkt) location_pt
from "demo_user"."raw_market_customers" s


[0m18:11:46.301121 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 0.405 seconds
[0m18:11:46.322419 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m18:11:46.323157 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    DROP view /*+ IF EXISTS */ "demo_user"."lim_market_customers";
  
[0m18:11:46.389294 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1021] [Teradata Database] [Error 3807] Object 'demo_user.lim_market_customers' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m18:11:46.392994 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m18:11:46.394042 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    RENAME view "demo_user"."lim_market_customers__dbt_tmp" TO "demo_user"."lim_market_customers"
  
[0m18:11:46.671520 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.276 seconds
[0m18:11:46.704722 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m18:11:46.705951 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */
DROP view /*+ IF EXISTS */ "demo_user"."lim_market_customers__dbt_backup";
[0m18:11:46.771596 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1021] [Teradata Database] [Error 3807] Object 'demo_user.lim_market_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m18:11:46.776212 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: Close
[0m18:11:46.870845 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b41da3-68b4-462a-85ce-c491dbb1cb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc880276a0>]}
[0m18:11:46.872884 [info ] [Thread-1  ]: 2 of 19 OK created sql view model demo_user.lim_market_customers ............... [[32mactivity: Create View, rows_affected: 0[0m in 11.64s]
[0m18:11:46.875006 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_market_customers
[0m18:11:46.876211 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.stg_customers
[0m18:11:46.877721 [info ] [Thread-1  ]: 3 of 19 START sql view model demo_user.stg_customers ........................... [RUN]
[0m18:11:46.879037 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.lim_market_customers, now model.jaffle_shop_teradata.stg_customers)
[0m18:11:46.880094 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.stg_customers
[0m18:11:46.894876 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.stg_customers"
[0m18:11:46.898164 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.stg_customers
[0m18:11:46.904743 [debug] [Thread-1  ]: Setting query_band
[0m18:11:46.906283 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.stg_customers"
[0m18:11:46.907994 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_customers"
[0m18:11:46.908578 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_customers"} */

  

  
  REPLACE VIEW "demo_user"."stg_customers__dbt_tmp" AS
    locking row for access
select
    id as customer_id,
    first_name (varchar(1000)),
    last_name (varchar(1000)),
    email (varchar(1000)),
    current_timestamp last_update_ts
from "demo_user"."raw_customers" source


[0m18:11:46.908918 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:47.872118 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:47.874605 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:48.257801 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 1.348 seconds
[0m18:11:48.278404 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_customers"
[0m18:11:48.281028 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_customers"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_customers";
  
[0m18:11:48.347218 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1022] [Teradata Database] [Error 3807] Object 'demo_user.stg_customers' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m18:11:48.355413 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_customers"
[0m18:11:48.356738 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_customers"} */

    RENAME view "demo_user"."stg_customers__dbt_tmp" TO "demo_user"."stg_customers"
  
[0m18:11:48.631849 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.274 seconds
[0m18:11:48.648704 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_customers"
[0m18:11:48.649783 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_customers"} */
DROP view /*+ IF EXISTS */ "demo_user"."stg_customers__dbt_backup";
[0m18:11:48.736640 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1022] [Teradata Database] [Error 3807] Object 'demo_user.stg_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m18:11:48.744344 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: Close
[0m18:11:48.831468 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b41da3-68b4-462a-85ce-c491dbb1cb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdceafc60a0>]}
[0m18:11:48.835154 [info ] [Thread-1  ]: 3 of 19 OK created sql view model demo_user.stg_customers ...................... [[32mactivity: Create View, rows_affected: 0[0m in 1.95s]
[0m18:11:48.837294 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.stg_customers
[0m18:11:48.838692 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.stg_market_customers
[0m18:11:48.840407 [info ] [Thread-1  ]: 4 of 19 START sql view model demo_user.stg_market_customers .................... [RUN]
[0m18:11:48.842121 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.stg_customers, now model.jaffle_shop_teradata.stg_market_customers)
[0m18:11:48.843106 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.stg_market_customers
[0m18:11:48.857494 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.stg_market_customers"
[0m18:11:48.858869 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.stg_market_customers
[0m18:11:48.870928 [debug] [Thread-1  ]: Setting query_band
[0m18:11:48.875611 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m18:11:48.876316 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */

    create foreign table demo_user.raw_market_customers using (location('/GS/storage.googleapis.com/clearscape_analytics_demo_data/DEMO_Market/Customer/'));
  
[0m18:11:48.876664 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:49.959330 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:49.961153 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:50.071563 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1023] [Teradata Database] [Error 3803] Table 'raw_market_customers' already exists.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m18:11:50.089183 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: Close
[0m18:11:50.205977 [debug] [Thread-1  ]: Database Error in model stg_market_customers (models/raw/staging/stg_market_customers.sql)
  [Version 20.0.0.15] [Session 1023] [Teradata Database] [Error 3803] Table 'raw_market_customers' already exists.
   at gosqldriver/teradatasql.formatError ErrorUtil.go:91
   at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
   at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
   at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
   at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
   at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
   at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
   at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
   at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
   at database/sql.ctxDriverQuery ctxutil.go:48
   at database/sql.(*DB).queryDC.func1 sql.go:1776
   at database/sql.withLock sql.go:3530
   at database/sql.(*DB).queryDC sql.go:1771
   at database/sql.(*Conn).QueryContext sql.go:2027
   at main.createRows goside.go:783
   at main.goCreateRows goside.go:662
   at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
   at runtime.cgocallbackg1 cgocall.go:420
   at runtime.cgocallbackg cgocall.go:339
   at runtime.cgocallback asm_amd64.s:1079
   at runtime.goexit asm_amd64.s:1695
[0m18:11:50.207672 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b41da3-68b4-462a-85ce-c491dbb1cb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf855cf10>]}
[0m18:11:50.209579 [error] [Thread-1  ]: 4 of 19 ERROR creating sql view model demo_user.stg_market_customers ........... [[31mERROR[0m in 1.37s]
[0m18:11:50.216024 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.stg_market_customers
[0m18:11:50.221569 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.stg_orders
[0m18:11:50.223257 [info ] [Thread-1  ]: 5 of 19 START sql view model demo_user.stg_orders .............................. [RUN]
[0m18:11:50.224636 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.stg_market_customers, now model.jaffle_shop_teradata.stg_orders)
[0m18:11:50.227155 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.stg_orders
[0m18:11:50.235175 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.stg_orders"
[0m18:11:50.237489 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.stg_orders
[0m18:11:50.239823 [debug] [Thread-1  ]: Setting query_band
[0m18:11:50.242104 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.stg_orders"
[0m18:11:50.245009 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_orders"
[0m18:11:50.245740 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_orders"} */

  

  
  REPLACE VIEW "demo_user"."stg_orders__dbt_tmp" AS
    locking row for access
select
    source.*,
    current_timestamp last_update_ts
from "demo_user"."raw_orders" source


[0m18:11:50.246433 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:51.243262 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:51.246099 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:51.567699 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 1.320 seconds
[0m18:11:51.588756 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_orders"
[0m18:11:51.589465 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_orders"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_orders";
  
[0m18:11:51.654675 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1024] [Teradata Database] [Error 3807] Object 'demo_user.stg_orders' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m18:11:51.661499 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_orders"
[0m18:11:51.663572 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_orders"} */

    RENAME view "demo_user"."stg_orders__dbt_tmp" TO "demo_user"."stg_orders"
  
[0m18:11:51.897082 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.232 seconds
[0m18:11:51.914103 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_orders"
[0m18:11:51.915300 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_orders"} */
DROP view /*+ IF EXISTS */ "demo_user"."stg_orders__dbt_backup";
[0m18:11:51.979848 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1024] [Teradata Database] [Error 3807] Object 'demo_user.stg_orders__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m18:11:51.987167 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: Close
[0m18:11:52.070405 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b41da3-68b4-462a-85ce-c491dbb1cb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc98066dc0>]}
[0m18:11:52.074154 [info ] [Thread-1  ]: 5 of 19 OK created sql view model demo_user.stg_orders ......................... [[32mactivity: Create View, rows_affected: 0[0m in 1.85s]
[0m18:11:52.077806 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.stg_orders
[0m18:11:52.079691 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.stg_payments
[0m18:11:52.081882 [info ] [Thread-1  ]: 6 of 19 START sql view model demo_user.stg_payments ............................ [RUN]
[0m18:11:52.083454 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.stg_orders, now model.jaffle_shop_teradata.stg_payments)
[0m18:11:52.085360 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.stg_payments
[0m18:11:52.095962 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.stg_payments"
[0m18:11:52.097253 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.stg_payments
[0m18:11:52.101945 [debug] [Thread-1  ]: Setting query_band
[0m18:11:52.105249 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.stg_payments"
[0m18:11:52.106338 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_payments"
[0m18:11:52.106826 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_payments"} */

  

  
  REPLACE VIEW "demo_user"."stg_payments__dbt_tmp" AS
    locking row for access
select
source.*
,'2024-09-02 16:11:27.822949+00:00' (timestamp) last_update_ts
from  "demo_user"."raw_payments" source


[0m18:11:52.107276 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:53.085891 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:53.088061 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:53.409322 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 1.301 seconds
[0m18:11:53.429384 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_payments"
[0m18:11:53.430183 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_payments"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_payments";
  
[0m18:11:53.496400 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1025] [Teradata Database] [Error 3807] Object 'demo_user.stg_payments' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m18:11:53.508049 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_payments"
[0m18:11:53.510372 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_payments"} */

    RENAME view "demo_user"."stg_payments__dbt_tmp" TO "demo_user"."stg_payments"
  
[0m18:11:53.769202 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.257 seconds
[0m18:11:53.775365 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_payments"
[0m18:11:53.775867 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_payments"} */
DROP view /*+ IF EXISTS */ "demo_user"."stg_payments__dbt_backup";
[0m18:11:53.861353 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1025] [Teradata Database] [Error 3807] Object 'demo_user.stg_payments__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m18:11:53.870804 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: Close
[0m18:11:53.965312 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b41da3-68b4-462a-85ce-c491dbb1cb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdceadc72b0>]}
[0m18:11:53.969317 [info ] [Thread-1  ]: 6 of 19 OK created sql view model demo_user.stg_payments ....................... [[32mactivity: Create View, rows_affected: 0[0m in 1.88s]
[0m18:11:53.977967 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.stg_payments
[0m18:11:53.982983 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.customer
[0m18:11:53.985639 [info ] [Thread-1  ]: 7 of 19 START sql view model demo_user.customer ................................ [RUN]
[0m18:11:53.990719 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.stg_payments, now model.jaffle_shop_teradata.customer)
[0m18:11:53.994625 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.customer
[0m18:11:54.003185 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.customer"
[0m18:11:54.006211 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.customer
[0m18:11:54.010886 [debug] [Thread-1  ]: Setting query_band
[0m18:11:54.013864 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.customer"
[0m18:11:54.016200 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer"
[0m18:11:54.016811 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer"} */

  

  
  REPLACE VIEW "demo_user"."customer__dbt_tmp" AS
    

locking row for access
select
    customer_key,
    substr(customer_nk,1,3)||'***' email
from "demo_user"."key_customer"
where domain_cd = 'retail'


[0m18:11:54.017317 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:55.097453 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:55.098870 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:55.436745 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 1.417 seconds
[0m18:11:55.453681 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer"
[0m18:11:55.455215 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer"} */

    DROP view /*+ IF EXISTS */ "demo_user"."customer";
  
[0m18:11:55.521658 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1026] [Teradata Database] [Error 3807] Object 'demo_user.customer' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m18:11:55.528847 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer"
[0m18:11:55.530405 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer"} */

    RENAME view "demo_user"."customer__dbt_tmp" TO "demo_user"."customer"
  
[0m18:11:55.808455 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.276 seconds
[0m18:11:55.829851 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer"
[0m18:11:55.830697 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer"} */
DROP view /*+ IF EXISTS */ "demo_user"."customer__dbt_backup";
[0m18:11:55.899133 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1026] [Teradata Database] [Error 3807] Object 'demo_user.customer__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m18:11:55.910030 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: Close
[0m18:11:56.004477 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b41da3-68b4-462a-85ce-c491dbb1cb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc98088310>]}
[0m18:11:56.009425 [info ] [Thread-1  ]: 7 of 19 OK created sql view model demo_user.customer ........................... [[32mactivity: Create View, rows_affected: 0[0m in 2.02s]
[0m18:11:56.012739 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.customer
[0m18:11:56.015655 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.sim_customers
[0m18:11:56.022620 [info ] [Thread-1  ]: 8 of 19 START sql incremental model demo_user.sim_customers .................... [RUN]
[0m18:11:56.025713 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.customer, now model.jaffle_shop_teradata.sim_customers)
[0m18:11:56.032462 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.sim_customers
[0m18:11:56.065575 [debug] [Thread-1  ]: use_qvci set to : false
[0m18:11:56.066735 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m18:11:56.067649 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        WHEN ColumnsV.ColumnType = 'JN' THEN 'JSON'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType in (1, 2) THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'stg_customers' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
[0m18:11:56.068513 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:57.123709 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:57.126578 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:57.959667 [debug] [Thread-1  ]: SQL status: activity: Select, rows_affected: 5 in 1.889 seconds
[0m18:11:57.981841 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.sim_customers"
[0m18:11:57.984005 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.sim_customers
[0m18:11:57.986707 [debug] [Thread-1  ]: Setting query_band
[0m18:11:57.988090 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m18:11:57.988484 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */

      CREATE  TABLE
      "demo_user"."sim_customers"
      AS (
            

-- Generic source image build for `customers` entity


select    
    customer_id,    
    first_name,    
    last_name,    
    email
    
,period(last_update_ts, '9999-12-31 23:59:59.999999+00:00' (timestamp)) as valid_period
from "demo_user"."stg_customers" source
 
 
        ) WITH NO DATA
      
      ;
    
[0m18:11:58.453613 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.464 seconds
[0m18:11:58.456700 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.sim_customers"
[0m18:11:58.460148 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m18:11:58.461502 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */

   
  
    
    

    INSERT INTO "demo_user"."sim_customers"
          

-- Generic source image build for `customers` entity


select    
    customer_id,    
    first_name,    
    last_name,    
    email
    
,period(last_update_ts, '9999-12-31 23:59:59.999999+00:00' (timestamp)) as valid_period
from "demo_user"."stg_customers" source
 
 
    ;
  

  

[0m18:11:58.740121 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 100 in 0.277 seconds
[0m18:11:58.746042 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: Close
[0m18:11:58.839140 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b41da3-68b4-462a-85ce-c491dbb1cb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd026c5b0>]}
[0m18:11:58.839917 [info ] [Thread-1  ]: 8 of 19 OK created sql incremental model demo_user.sim_customers ............... [[32mactivity: Insert, rows_affected: 100[0m in 2.81s]
[0m18:11:58.840502 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.sim_customers
[0m18:11:58.840894 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.test
[0m18:11:58.841499 [info ] [Thread-1  ]: 9 of 19 START sql view model demo_user.test .................................... [RUN]
[0m18:11:58.842070 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.sim_customers, now model.jaffle_shop_teradata.test)
[0m18:11:58.842411 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.test
[0m18:11:58.861479 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.test"
[0m18:11:58.862572 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.test
[0m18:11:58.865010 [debug] [Thread-1  ]: Setting query_band
[0m18:11:58.866482 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.test"
[0m18:11:58.868189 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.test"
[0m18:11:58.868565 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.test: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.test"} */

  

  
  REPLACE VIEW "demo_user"."test__dbt_tmp" AS
    
    

    insert into "demo_user"."key_customer"
    select
        rank() over(partition by domain_cd order by customer_nk) (integer) customer_key 
        ,nk (varchar(10000)) customer_nk
        ,domain_cd (char(100)) domain_cd
        ,current_timestamp created_ts
    from 
    (
        select coalesce(trim(email), '')||'|'||coalesce(trim(first_name), '') nk
        , 'retail' domain_cd 
        from "demo_user"."stg_customers"
        group by 1,2
    ) source
    where not exists
    (sel 1 from  "demo_user"."key_customer" k where k.customer_nk=source.nk and k.domain_cd=source.domain_cd )




[0m18:11:58.868878 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:59.886222 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:59.888787 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:11:59.959287 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1028] [Teradata Database] [Error 3707] Syntax error, expected something like a 'SELECT' keyword or a 'LOCK' keyword or '(' or a 'TRANSACTIONTIME' keyword between the 'AS' keyword and the 'insert' keyword.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m18:11:59.962641 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.test: Close
[0m18:12:00.050792 [debug] [Thread-1  ]: Database Error in model test (models/test.sql)
  [Version 20.0.0.15] [Session 1028] [Teradata Database] [Error 3707] Syntax error, expected something like a 'SELECT' keyword or a 'LOCK' keyword or '(' or a 'TRANSACTIONTIME' keyword between the 'AS' keyword and the 'insert' keyword.
   at gosqldriver/teradatasql.formatError ErrorUtil.go:91
   at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
   at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
   at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
   at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
   at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
   at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
   at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
   at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
   at database/sql.ctxDriverQuery ctxutil.go:48
   at database/sql.(*DB).queryDC.func1 sql.go:1776
   at database/sql.withLock sql.go:3530
   at database/sql.(*DB).queryDC sql.go:1771
   at database/sql.(*Conn).QueryContext sql.go:2027
   at main.createRows goside.go:783
   at main.goCreateRows goside.go:662
   at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
   at runtime.cgocallbackg1 cgocall.go:420
   at runtime.cgocallbackg cgocall.go:339
   at runtime.cgocallback asm_amd64.s:1079
   at runtime.goexit asm_amd64.s:1695
  compiled Code at target/run/jaffle_shop_teradata/models/test.sql
[0m18:12:00.052734 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b41da3-68b4-462a-85ce-c491dbb1cb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc88027c70>]}
[0m18:12:00.055649 [error] [Thread-1  ]: 9 of 19 ERROR creating sql view model demo_user.test ........................... [[31mERROR[0m in 1.21s]
[0m18:12:00.059044 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.test
[0m18:12:00.060934 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.sim_orders
[0m18:12:00.063060 [info ] [Thread-1  ]: 10 of 19 START sql incremental model demo_user.sim_orders ...................... [RUN]
[0m18:12:00.064681 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.test, now model.jaffle_shop_teradata.sim_orders)
[0m18:12:00.065921 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.sim_orders
[0m18:12:00.082136 [debug] [Thread-1  ]: use_qvci set to : false
[0m18:12:00.082882 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m18:12:00.083440 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        WHEN ColumnsV.ColumnType = 'JN' THEN 'JSON'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType in (1, 2) THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'stg_orders' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
[0m18:12:00.083955 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:12:01.110016 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:12:01.111403 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:12:01.794038 [debug] [Thread-1  ]: SQL status: activity: Select, rows_affected: 5 in 1.709 seconds
[0m18:12:01.805276 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.sim_orders"
[0m18:12:01.808078 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.sim_orders
[0m18:12:01.813804 [debug] [Thread-1  ]: Setting query_band
[0m18:12:01.815076 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m18:12:01.815418 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */

      CREATE  TABLE
      "demo_user"."sim_orders"
      AS (
            

-- Generic source image build for `orders` entity


select    
    id,    
    user_id,    
    order_date,    
    status,    
    last_update_ts
from "demo_user"."stg_orders" source
 
 
        ) WITH NO DATA
      
      ;
    
[0m18:12:02.180024 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.361 seconds
[0m18:12:02.188202 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.sim_orders"
[0m18:12:02.190796 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m18:12:02.191303 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */

   
  
    
    

    INSERT INTO "demo_user"."sim_orders"
          

-- Generic source image build for `orders` entity


select    
    id,    
    user_id,    
    order_date,    
    status,    
    last_update_ts
from "demo_user"."stg_orders" source
 
 
    ;
  

  

[0m18:12:02.424098 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 99 in 0.232 seconds
[0m18:12:02.436247 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: Close
[0m18:12:02.522598 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b41da3-68b4-462a-85ce-c491dbb1cb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdceaf98f70>]}
[0m18:12:02.525631 [info ] [Thread-1  ]: 10 of 19 OK created sql incremental model demo_user.sim_orders ................. [[32mactivity: Insert, rows_affected: 99[0m in 2.46s]
[0m18:12:02.527254 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.sim_orders
[0m18:12:02.528904 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.sim_payments
[0m18:12:02.531641 [info ] [Thread-1  ]: 11 of 19 START sql incremental model demo_user.sim_payments .................... [RUN]
[0m18:12:02.533221 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.sim_orders, now model.jaffle_shop_teradata.sim_payments)
[0m18:12:02.534512 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.sim_payments
[0m18:12:02.546215 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.sim_payments"
[0m18:12:02.547271 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.sim_payments
[0m18:12:02.549508 [debug] [Thread-1  ]: Setting query_band
[0m18:12:02.550836 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_payments"
[0m18:12:02.551204 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_payments"} */

      CREATE  TABLE
      "demo_user"."sim_payments"
      AS (
            

-- Source image build for `payments` entity

select source.*
from "demo_user"."stg_payments" source
        ) WITH NO DATA
      
      ;
    
[0m18:12:02.551496 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:12:03.576664 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:12:03.580170 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:12:03.903165 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 1.351 seconds
[0m18:12:03.907916 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.sim_payments"
[0m18:12:03.913611 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_payments"
[0m18:12:03.919115 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_payments"} */

   
  
    
    

    INSERT INTO "demo_user"."sim_payments"
          

-- Source image build for `payments` entity

select source.*
from "demo_user"."stg_payments" source
    ;
  

  

[0m18:12:04.131202 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 113 in 0.211 seconds
[0m18:12:04.139576 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: Close
[0m18:12:04.225905 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b41da3-68b4-462a-85ce-c491dbb1cb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdceaf98f70>]}
[0m18:12:04.227764 [info ] [Thread-1  ]: 11 of 19 OK created sql incremental model demo_user.sim_payments ............... [[32mactivity: Insert, rows_affected: 113[0m in 1.69s]
[0m18:12:04.229381 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.sim_payments
[0m18:12:04.232829 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_customers
[0m18:12:04.234632 [info ] [Thread-1  ]: 12 of 19 START sql incremental model demo_user.lim_customers ................... [RUN]
[0m18:12:04.235927 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.sim_payments, now model.jaffle_shop_teradata.lim_customers)
[0m18:12:04.237078 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_customers
[0m18:12:04.264890 [debug] [Thread-1  ]: use_qvci set to : false
[0m18:12:04.265658 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m18:12:04.266209 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        WHEN ColumnsV.ColumnType = 'JN' THEN 'JSON'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType in (1, 2) THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'sim_customers' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
[0m18:12:04.267300 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:12:05.263718 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:12:05.266756 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:12:06.158056 [debug] [Thread-1  ]: SQL status: activity: Select, rows_affected: 5 in 1.890 seconds
[0m18:12:06.164860 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_customers"
[0m18:12:06.167505 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_customers
[0m18:12:06.176550 [debug] [Thread-1  ]: Setting query_band
[0m18:12:06.184999 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m18:12:06.185580 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

        insert into "demo_user"."key_customer"
    select
        rank() over(partition by domain_cd order by customer_nk) (integer) customer_key 
        ,nk (varchar(10000)) customer_nk
        ,domain_cd (char(100)) domain_cd
        ,current_timestamp created_ts
    from 
    (
        select coalesce(trim(email), '') nk
        , 'retail' domain_cd 
        from "demo_user"."sim_customers"
        group by 1,2
    ) source
    where not exists
    (sel 1 from  "demo_user"."key_customer" k where k.customer_nk=source.nk and k.domain_cd=source.domain_cd )
      
[0m18:12:06.881791 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 100 in 0.695 seconds
[0m18:12:06.892190 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m18:12:06.893748 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

        insert into "demo_user"."key_customer"
    select
        rank() over(partition by domain_cd order by customer_nk) (integer) customer_key 
        ,nk (varchar(10000)) customer_nk
        ,domain_cd (char(100)) domain_cd
        ,current_timestamp created_ts
    from 
    (
        select coalesce(trim(last_name), '') nk
        , 'families' domain_cd 
        from "demo_user"."sim_customers"
        group by 1,2
    ) source
    where not exists
    (sel 1 from  "demo_user"."key_customer" k where k.customer_nk=source.nk and k.domain_cd=source.domain_cd )
      
[0m18:12:07.680209 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 85 in 0.785 seconds
[0m18:12:07.685358 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m18:12:07.686828 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

      CREATE  TABLE
      "demo_user"."lim_customers"
      AS (
            /*
  Build a light integrated modeled layer from source image 
  for entity `customers`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
  - Surrogate key assigment
  - Naming conventions alignment
*/










with source as
(
  select
  s.*
  from "demo_user"."sim_customers" s
  where valid_period contains current_timestamp
)
select
    --Value columns
      customer_id,
      first_name,
      email,
      valid_period
    --Surrogate key columns
    ,coalesce(customer.customer_key,-1) customer_key
    ,coalesce(family.customer_key,-1) family_key
from source s
--Surrogate key joins
left join "demo_user"."key_customer" customer
  on customer.customer_nk=coalesce(trim(email), '')
  and customer.domain_cd='retail'

left join "demo_user"."key_customer" family
  on family.customer_nk=coalesce(trim(last_name), '')
  and family.domain_cd='families'



        ) WITH NO DATA
      
      ;
    
[0m18:12:08.049108 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.360 seconds
[0m18:12:08.068227 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.lim_customers"
[0m18:12:08.074148 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m18:12:08.074668 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

   
  
    
    

    INSERT INTO "demo_user"."lim_customers"
          /*
  Build a light integrated modeled layer from source image 
  for entity `customers`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
  - Surrogate key assigment
  - Naming conventions alignment
*/










with source as
(
  select
  s.*
  from "demo_user"."sim_customers" s
  where valid_period contains current_timestamp
)
select
    --Value columns
      customer_id,
      first_name,
      email,
      valid_period
    --Surrogate key columns
    ,coalesce(customer.customer_key,-1) customer_key
    ,coalesce(family.customer_key,-1) family_key
from source s
--Surrogate key joins
left join "demo_user"."key_customer" customer
  on customer.customer_nk=coalesce(trim(email), '')
  and customer.domain_cd='retail'

left join "demo_user"."key_customer" family
  on family.customer_nk=coalesce(trim(last_name), '')
  and family.domain_cd='families'



    ;
  

  

[0m18:12:08.588446 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 100 in 0.513 seconds
[0m18:12:08.596604 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: Close
[0m18:12:08.750786 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b41da3-68b4-462a-85ce-c491dbb1cb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcea815f40>]}
[0m18:12:08.756192 [info ] [Thread-1  ]: 12 of 19 OK created sql incremental model demo_user.lim_customers .............. [[32mactivity: Insert, rows_affected: 100[0m in 4.51s]
[0m18:12:08.758655 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_customers
[0m18:12:08.760343 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_orders
[0m18:12:08.761750 [info ] [Thread-1  ]: 13 of 19 START sql incremental model demo_user.lim_orders ...................... [RUN]
[0m18:12:08.763206 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.lim_customers, now model.jaffle_shop_teradata.lim_orders)
[0m18:12:08.764429 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_orders
[0m18:12:08.788134 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_orders"
[0m18:12:08.790763 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_orders
[0m18:12:08.794422 [debug] [Thread-1  ]: Setting query_band
[0m18:12:08.797610 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_orders"
[0m18:12:08.798180 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_orders"} */

        insert into "demo_user"."key_customer"
    select
        rank() over(partition by domain_cd order by customer_nk) (integer) customer_key 
        ,nk (varchar(10000)) customer_nk
        ,domain_cd (char(100)) domain_cd
        ,current_timestamp created_ts
    from 
    (
        select coalesce(trim(email), '') nk
        , 'retail' domain_cd 
        from "demo_user"."sim_customers"
        group by 1,2
    ) source
    where not exists
    (sel 1 from  "demo_user"."key_customer" k where k.customer_nk=source.nk and k.domain_cd=source.domain_cd )
      
[0m18:12:08.798613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:12:09.834712 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:12:09.837154 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:12:10.540472 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 0 in 1.741 seconds
[0m18:12:10.546194 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_orders"
[0m18:12:10.547951 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_orders"} */

      CREATE  TABLE
      "demo_user"."lim_orders"
      AS (
            /*
  Build a light integrated modeled layer from source image 
  for entity `orders`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
  - Surrogate key assigment
  - Naming conventions alignment
*/

with source as
(
  select
  s.*  
  ,coalesce(c.email,'UNKNOWN') email
  from "demo_user"."sim_orders" s
  left join "demo_user"."sim_customers" c
    on c.customer_id=s.customer_id
    and c.valid_period contains current_timestamp
)
select
    s.*
    --Surrogate key columns
    ,coalesce(customer.customer_key,-1) customer_key
from source s
--Surrogate key joins
left join "demo_user"."key_customer" customer
  on customer.customer_nk=coalesce(trim(email), '')
  and customer.domain_cd='retail'

        ) WITH NO DATA
      
      ;
    
[0m18:12:10.634852 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1032] [Teradata Database] [Error 3810] Column/Parameter 'demo_user.s.customer_id' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m18:12:10.636823 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: Close
[0m18:12:10.735755 [debug] [Thread-1  ]: Database Error in model lim_orders (models/discovery/light-integration/lim_orders.sql)
  [Version 20.0.0.15] [Session 1032] [Teradata Database] [Error 3810] Column/Parameter 'demo_user.s.customer_id' does not exist.
   at gosqldriver/teradatasql.formatError ErrorUtil.go:91
   at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
   at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
   at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
   at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
   at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
   at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
   at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
   at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
   at database/sql.ctxDriverQuery ctxutil.go:48
   at database/sql.(*DB).queryDC.func1 sql.go:1776
   at database/sql.withLock sql.go:3530
   at database/sql.(*DB).queryDC sql.go:1771
   at database/sql.(*Conn).QueryContext sql.go:2027
   at main.createRows goside.go:783
   at main.goCreateRows goside.go:662
   at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
   at runtime.cgocallbackg1 cgocall.go:420
   at runtime.cgocallbackg cgocall.go:339
   at runtime.cgocallback asm_amd64.s:1079
   at runtime.goexit asm_amd64.s:1695
[0m18:12:10.737610 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b41da3-68b4-462a-85ce-c491dbb1cb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc880a9250>]}
[0m18:12:10.739682 [error] [Thread-1  ]: 13 of 19 ERROR creating sql incremental model demo_user.lim_orders ............. [[31mERROR[0m in 1.97s]
[0m18:12:10.741592 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_orders
[0m18:12:10.742553 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_payments
[0m18:12:10.743143 [info ] [Thread-1  ]: 14 of 19 START sql view model demo_user.lim_payments ........................... [RUN]
[0m18:12:10.743632 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.lim_orders, now model.jaffle_shop_teradata.lim_payments)
[0m18:12:10.743974 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_payments
[0m18:12:10.750031 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_payments"
[0m18:12:10.751906 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_payments
[0m18:12:10.755702 [debug] [Thread-1  ]: Setting query_band
[0m18:12:10.761343 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.lim_payments"
[0m18:12:10.763385 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_payments"
[0m18:12:10.764274 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_payments"} */

  

  
  REPLACE VIEW "demo_user"."lim_payments__dbt_tmp" AS
    /*
  Build a light integrated modeled layer from source image 
  for entity `payments`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
  - Naming conventions alignment
*/

sel
  id as payment_id,
  order_id,
  payment_method,
  --`amount` is currently stored in cents, so we convert it to dollars
  amount / 100 as amount_usd
  from "demo_user"."sim_payments" s


[0m18:12:10.765126 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:12:11.797017 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:12:11.798450 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:12:12.116879 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 1.351 seconds
[0m18:12:12.128706 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_payments"
[0m18:12:12.129801 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_payments"} */

    DROP view /*+ IF EXISTS */ "demo_user"."lim_payments";
  
[0m18:12:12.195157 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1033] [Teradata Database] [Error 3807] Object 'demo_user.lim_payments' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m18:12:12.202762 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_payments"
[0m18:12:12.203919 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_payments"} */

    RENAME view "demo_user"."lim_payments__dbt_tmp" TO "demo_user"."lim_payments"
  
[0m18:12:12.438247 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.232 seconds
[0m18:12:12.453938 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_payments"
[0m18:12:12.455100 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_payments"} */
DROP view /*+ IF EXISTS */ "demo_user"."lim_payments__dbt_backup";
[0m18:12:12.520928 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1033] [Teradata Database] [Error 3807] Object 'demo_user.lim_payments__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m18:12:12.528535 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: Close
[0m18:12:12.621423 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b41da3-68b4-462a-85ce-c491dbb1cb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc98066dc0>]}
[0m18:12:12.625493 [info ] [Thread-1  ]: 14 of 19 OK created sql view model demo_user.lim_payments ...................... [[32mactivity: Create View, rows_affected: 0[0m in 1.88s]
[0m18:12:12.629281 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_payments
[0m18:12:12.631586 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.customer_lifetime_value
[0m18:12:12.633256 [info ] [Thread-1  ]: 15 of 19 SKIP relation demo_user.customer_lifetime_value ....................... [[33mSKIP[0m]
[0m18:12:12.635093 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.customer_lifetime_value
[0m18:12:12.638576 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.dim_payment_method
[0m18:12:12.642719 [info ] [Thread-1  ]: 16 of 19 START sql view model demo_user.dim_payment_method ..................... [RUN]
[0m18:12:12.644588 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.lim_payments, now model.jaffle_shop_teradata.dim_payment_method)
[0m18:12:12.645507 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.dim_payment_method
[0m18:12:12.654306 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.dim_payment_method"
[0m18:12:12.655508 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.dim_payment_method
[0m18:12:12.657827 [debug] [Thread-1  ]: Setting query_band
[0m18:12:12.659524 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.dim_payment_method"
[0m18:12:12.660671 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_payment_method"
[0m18:12:12.661043 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_payment_method"} */

  

  
  REPLACE VIEW "demo_user"."dim_payment_method__dbt_tmp" AS
    with payments as (

    select * from "demo_user"."lim_payments"

),

final as (

    select
        payment_method
        ,sum(amount_usd) as total_amount
        ,count(1) as frequency_count
    from payments
    group by 1

)

select * from final


[0m18:12:12.661378 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:12:13.654585 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:12:13.656970 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:12:13.934313 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 1.273 seconds
[0m18:12:13.945835 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_payment_method"
[0m18:12:13.947513 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_payment_method"} */

    DROP view /*+ IF EXISTS */ "demo_user"."dim_payment_method";
  
[0m18:12:14.014063 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1034] [Teradata Database] [Error 3807] Object 'demo_user.dim_payment_method' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m18:12:14.019293 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_payment_method"
[0m18:12:14.020336 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_payment_method"} */

    RENAME view "demo_user"."dim_payment_method__dbt_tmp" TO "demo_user"."dim_payment_method"
  
[0m18:12:14.255591 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.234 seconds
[0m18:12:14.277866 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_payment_method"
[0m18:12:14.279299 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_payment_method"} */
DROP view /*+ IF EXISTS */ "demo_user"."dim_payment_method__dbt_backup";
[0m18:12:14.343482 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1034] [Teradata Database] [Error 3807] Object 'demo_user.dim_payment_method__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m18:12:14.349958 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: Close
[0m18:12:14.446596 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b41da3-68b4-462a-85ce-c491dbb1cb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8806f700>]}
[0m18:12:14.449223 [info ] [Thread-1  ]: 16 of 19 OK created sql view model demo_user.dim_payment_method ................ [[32mactivity: Create View, rows_affected: 0[0m in 1.80s]
[0m18:12:14.451148 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.dim_payment_method
[0m18:12:14.453249 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.order_payments
[0m18:12:14.455752 [info ] [Thread-1  ]: 17 of 19 START sql view model demo_user.order_payments ......................... [RUN]
[0m18:12:14.457386 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.dim_payment_method, now model.jaffle_shop_teradata.order_payments)
[0m18:12:14.458655 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.order_payments
[0m18:12:14.472839 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.order_payments"
[0m18:12:14.475193 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.order_payments
[0m18:12:14.480351 [debug] [Thread-1  ]: Setting query_band
[0m18:12:14.482358 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.order_payments"
[0m18:12:14.483732 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.order_payments"
[0m18:12:14.484490 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.order_payments"} */

  

  
  REPLACE VIEW "demo_user"."order_payments__dbt_tmp" AS
    

with payments as (

    select * from "demo_user"."lim_payments"

),

final as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount_usd else 0 end) as credit_card_amount_usd,
        sum(case when payment_method = 'coupon' then amount_usd else 0 end) as coupon_amount_usd,
        sum(case when payment_method = 'bank_transfer' then amount_usd else 0 end) as bank_transfer_amount_usd,
        sum(case when payment_method = 'gift_card' then amount_usd else 0 end) as gift_card_amount_usd,
        sum(amount_usd) as total_amount_usd

    from payments

    group by 1

)

select * from final


[0m18:12:14.485189 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:12:15.476568 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:12:15.479181 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m18:12:15.839547 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 1.354 seconds
[0m18:12:15.855544 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.order_payments"
[0m18:12:15.856749 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.order_payments"} */

    DROP view /*+ IF EXISTS */ "demo_user"."order_payments";
  
[0m18:12:15.925238 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1035] [Teradata Database] [Error 3807] Object 'demo_user.order_payments' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m18:12:15.930112 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.order_payments"
[0m18:12:15.932416 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.order_payments"} */

    RENAME view "demo_user"."order_payments__dbt_tmp" TO "demo_user"."order_payments"
  
[0m18:12:16.190404 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.253 seconds
[0m18:12:16.216655 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.order_payments"
[0m18:12:16.218045 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.order_payments"} */
DROP view /*+ IF EXISTS */ "demo_user"."order_payments__dbt_backup";
[0m18:12:16.306274 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1035] [Teradata Database] [Error 3807] Object 'demo_user.order_payments__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m18:12:16.318098 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: Close
[0m18:12:16.409553 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b41da3-68b4-462a-85ce-c491dbb1cb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc880bb1c0>]}
[0m18:12:16.412028 [info ] [Thread-1  ]: 17 of 19 OK created sql view model demo_user.order_payments .................... [[32mactivity: Create View, rows_affected: 0[0m in 1.95s]
[0m18:12:16.415400 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.order_payments
[0m18:12:16.417241 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.dim_customers
[0m18:12:16.419467 [info ] [Thread-1  ]: 18 of 19 SKIP relation demo_user.dim_customers ................................. [[33mSKIP[0m]
[0m18:12:16.421716 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.dim_customers
[0m18:12:16.423617 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.fct_orders
[0m18:12:16.425327 [info ] [Thread-1  ]: 19 of 19 SKIP relation demo_user.fct_orders .................................... [[33mSKIP[0m]
[0m18:12:16.426690 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.fct_orders
[0m18:12:16.429525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:16.430359 [debug] [MainThread]: Connection 'model.jaffle_shop_teradata.order_payments' was properly closed.
[0m18:12:16.431348 [info ] [MainThread]: 
[0m18:12:16.432093 [info ] [MainThread]: Finished running 7 incremental models, 12 view models in 0 hours 0 minutes and 47.64 seconds (47.64s).
[0m18:12:16.439011 [debug] [MainThread]: Command end result
[0m18:12:16.511614 [info ] [MainThread]: 
[0m18:12:16.512202 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:12:16.512498 [info ] [MainThread]: 
[0m18:12:16.512907 [error] [MainThread]:   Database Error in model stg_market_customers (models/raw/staging/stg_market_customers.sql)
  [Version 20.0.0.15] [Session 1023] [Teradata Database] [Error 3803] Table 'raw_market_customers' already exists.
   at gosqldriver/teradatasql.formatError ErrorUtil.go:91
   at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
   at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
   at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
   at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
   at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
   at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
   at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
   at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
   at database/sql.ctxDriverQuery ctxutil.go:48
   at database/sql.(*DB).queryDC.func1 sql.go:1776
   at database/sql.withLock sql.go:3530
   at database/sql.(*DB).queryDC sql.go:1771
   at database/sql.(*Conn).QueryContext sql.go:2027
   at main.createRows goside.go:783
   at main.goCreateRows goside.go:662
   at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
   at runtime.cgocallbackg1 cgocall.go:420
   at runtime.cgocallbackg cgocall.go:339
   at runtime.cgocallback asm_amd64.s:1079
   at runtime.goexit asm_amd64.s:1695
[0m18:12:16.516691 [info ] [MainThread]: 
[0m18:12:16.517217 [error] [MainThread]:   Database Error in model test (models/test.sql)
  [Version 20.0.0.15] [Session 1028] [Teradata Database] [Error 3707] Syntax error, expected something like a 'SELECT' keyword or a 'LOCK' keyword or '(' or a 'TRANSACTIONTIME' keyword between the 'AS' keyword and the 'insert' keyword.
   at gosqldriver/teradatasql.formatError ErrorUtil.go:91
   at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
   at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
   at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
   at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
   at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
   at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
   at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
   at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
   at database/sql.ctxDriverQuery ctxutil.go:48
   at database/sql.(*DB).queryDC.func1 sql.go:1776
   at database/sql.withLock sql.go:3530
   at database/sql.(*DB).queryDC sql.go:1771
   at database/sql.(*Conn).QueryContext sql.go:2027
   at main.createRows goside.go:783
   at main.goCreateRows goside.go:662
   at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
   at runtime.cgocallbackg1 cgocall.go:420
   at runtime.cgocallbackg cgocall.go:339
   at runtime.cgocallback asm_amd64.s:1079
   at runtime.goexit asm_amd64.s:1695
  compiled Code at target/run/jaffle_shop_teradata/models/test.sql
[0m18:12:16.517841 [info ] [MainThread]: 
[0m18:12:16.518338 [error] [MainThread]:   Database Error in model lim_orders (models/discovery/light-integration/lim_orders.sql)
  [Version 20.0.0.15] [Session 1032] [Teradata Database] [Error 3810] Column/Parameter 'demo_user.s.customer_id' does not exist.
   at gosqldriver/teradatasql.formatError ErrorUtil.go:91
   at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
   at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
   at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
   at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
   at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
   at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
   at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
   at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
   at database/sql.ctxDriverQuery ctxutil.go:48
   at database/sql.(*DB).queryDC.func1 sql.go:1776
   at database/sql.withLock sql.go:3530
   at database/sql.(*DB).queryDC sql.go:1771
   at database/sql.(*Conn).QueryContext sql.go:2027
   at main.createRows goside.go:783
   at main.goCreateRows goside.go:662
   at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
   at runtime.cgocallbackg1 cgocall.go:420
   at runtime.cgocallbackg cgocall.go:339
   at runtime.cgocallback asm_amd64.s:1079
   at runtime.goexit asm_amd64.s:1695
[0m18:12:16.518919 [info ] [MainThread]: 
[0m18:12:16.519300 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=3 SKIP=3 TOTAL=19
[0m18:12:16.522399 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 48.748146, "process_user_time": 3.956655, "process_kernel_time": 0.621068, "process_mem_max_rss": "130985984", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:12:16.522988 [debug] [MainThread]: Command `dbt run` failed at 18:12:16.522888 after 48.75 seconds
[0m18:12:16.523390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdce903e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf83d0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd809f5b0>]}
[0m18:12:16.523750 [debug] [MainThread]: Flushing usage events
[0m11:07:35.482801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e0a38670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e1d47eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e1d473a0>]}


============================== 11:07:35.498308 | ffa5c8f8-1659-4d88-a264-58e75d725e87 ==============================
[0m11:07:35.498308 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:07:35.498929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata/logs', 'profiles_dir': '/Users/remi.turpaud/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:07:37.387233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffa5c8f8-1659-4d88-a264-58e75d725e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e0c47760>]}
[0m11:07:37.427468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffa5c8f8-1659-4d88-a264-58e75d725e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e13e5370>]}
[0m11:07:37.439506 [info ] [MainThread]: Registered adapter: teradata=1.8.0
[0m11:07:37.511100 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:07:38.361882 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:07:38.362847 [debug] [MainThread]: Partial parsing: added file: jaffle_shop_teradata://models/test.sql
[0m11:07:38.363430 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop_teradata://models/discovery/light-integration/lim_market_customers.sql
[0m11:07:38.531116 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop_teradata.lim_market_customers' (models/discovery/light-integration/lim_market_customers.sql) depends on a source named 'cloud_storage.ext_market_customers' which was not found
[0m11:07:38.554423 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.2276616, "process_user_time": 2.051956, "process_kernel_time": 0.528505, "process_mem_max_rss": "109285376", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:07:38.555430 [debug] [MainThread]: Command `cli run` failed at 11:07:38.555129 after 3.23 seconds
[0m11:07:38.555945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e0a38670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97101b5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97101b55b0>]}
[0m11:07:38.556389 [debug] [MainThread]: Flushing usage events
[0m11:08:44.221970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee189cf6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee19f0ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee19f0a130>]}


============================== 11:08:44.228513 | de0bf14d-1e44-499f-b56c-ddf46b9ca322 ==============================
[0m11:08:44.228513 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:08:44.229188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/remi.turpaud/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:08:44.531366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de0bf14d-1e44-499f-b56c-ddf46b9ca322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf8a65ac0>]}
[0m11:08:44.571119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de0bf14d-1e44-499f-b56c-ddf46b9ca322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede8228880>]}
[0m11:08:44.572680 [info ] [MainThread]: Registered adapter: teradata=1.8.0
[0m11:08:44.602742 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:08:44.827246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:08:44.827770 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:08:44.833887 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop
- models.jaffle_shop.staging
[0m11:08:44.894897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de0bf14d-1e44-499f-b56c-ddf46b9ca322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf8c00130>]}
[0m11:08:45.120898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de0bf14d-1e44-499f-b56c-ddf46b9ca322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf8c090d0>]}
[0m11:08:45.121614 [info ] [MainThread]: Found 19 models, 1 snapshot, 3 seeds, 8 data tests, 1 source, 573 macros
[0m11:08:45.122035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de0bf14d-1e44-499f-b56c-ddf46b9ca322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf8c0c5b0>]}
[0m11:08:45.123821 [info ] [MainThread]: 
[0m11:08:45.124549 [debug] [MainThread]: Acquiring new teradata connection 'master'
[0m11:08:45.125526 [debug] [ThreadPool]: Acquiring new teradata connection 'list_schemas'
[0m11:08:45.138892 [debug] [ThreadPool]: Using teradata connection "list_schemas"
[0m11:08:45.139401 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_schemas"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
[0m11:08:45.139933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:46.451319 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:08:46.454054 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:08:46.650779 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 46 in 1.507 seconds
[0m11:08:46.659108 [debug] [ThreadPool]: On list_schemas: Close
[0m11:08:46.759840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_schemas, now list_None_demo_user)
[0m11:08:46.770367 [debug] [ThreadPool]: Using teradata connection "list_None_demo_user"
[0m11:08:46.771110 [debug] [ThreadPool]: On list_None_demo_user: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_None_demo_user"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
[0m11:08:46.771726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:47.610246 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:08:47.611629 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:08:48.198304 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 17 in 1.426 seconds
[0m11:08:48.200817 [debug] [ThreadPool]: On list_None_demo_user: Close
[0m11:08:48.307868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None_demo_user, now list_None_rt186001)
[0m11:08:48.313248 [debug] [ThreadPool]: Using teradata connection "list_None_rt186001"
[0m11:08:48.313960 [debug] [ThreadPool]: On list_None_rt186001: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_None_rt186001"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'rt186001' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
[0m11:08:48.314678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:49.024194 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:08:49.024892 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:08:49.234942 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 0 in 0.920 seconds
[0m11:08:49.236815 [debug] [ThreadPool]: On list_None_rt186001: Close
[0m11:08:49.320018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de0bf14d-1e44-499f-b56c-ddf46b9ca322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf8b8d100>]}
[0m11:08:49.320980 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:08:49.321472 [info ] [MainThread]: 
[0m11:08:49.333331 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_market_customers
[0m11:08:49.334075 [info ] [Thread-1  ]: 1 of 1 START sql view model demo_user.lim_market_customers ..................... [RUN]
[0m11:08:49.334822 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_None_rt186001, now model.jaffle_shop_teradata.lim_market_customers)
[0m11:08:49.335282 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_market_customers
[0m11:08:49.346610 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_market_customers"
[0m11:08:49.355786 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_market_customers
[0m11:08:49.363407 [debug] [Thread-1  ]: Setting query_band
[0m11:08:49.389987 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:08:49.390422 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    drop table demo_user.raw_market_customers;
  
[0m11:08:49.390754 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:08:50.054902 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:08:50.056427 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:08:50.526631 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 24 in 1.134 seconds
[0m11:08:50.532499 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:08:50.533568 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    create foreign table demo_user.raw_market_customers using (location('/GS/storage.googleapis.com/clearscape_analytics_demo_data/DEMO_Market/Customer/'));
  
[0m11:08:58.256336 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 7.722 seconds
[0m11:08:58.266071 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.lim_market_customers"
[0m11:08:58.276650 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:08:58.277242 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

  

  
  REPLACE VIEW "demo_user"."lim_market_customers__dbt_tmp" AS
    /*
  Build a light integrated modeled layer from source image 
  for entity `market_customers`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
*/

select
spend,
nearby5,
nearby10,
new ST_GEOMETRY(ptLocWkt) location_pt
from "demo_user"."raw_market_customers" s


[0m11:08:58.574040 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 0.296 seconds
[0m11:08:58.587854 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:08:58.588641 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    DROP view /*+ IF EXISTS */ "demo_user"."lim_market_customers__dbt_backup";
  
[0m11:08:58.632584 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1044] [Teradata Database] [Error 3807] Object 'demo_user.lim_market_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:08:58.635257 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:08:58.636047 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    RENAME view "demo_user"."lim_market_customers" TO "demo_user"."lim_market_customers__dbt_backup"
  
[0m11:08:58.874850 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.237 seconds
[0m11:08:58.885500 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:08:58.886576 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    DROP view /*+ IF EXISTS */ "demo_user"."lim_market_customers";
  
[0m11:08:58.931544 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1044] [Teradata Database] [Error 3807] Object 'demo_user.lim_market_customers' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:08:58.936041 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:08:58.937304 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    RENAME view "demo_user"."lim_market_customers__dbt_tmp" TO "demo_user"."lim_market_customers"
  
[0m11:08:59.151143 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.213 seconds
[0m11:08:59.229668 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:08:59.230206 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */
DROP view /*+ IF EXISTS */ "demo_user"."lim_market_customers__dbt_backup";
[0m11:08:59.461989 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 10 in 0.231 seconds
[0m11:08:59.465347 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: Close
[0m11:08:59.559118 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de0bf14d-1e44-499f-b56c-ddf46b9ca322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee18c24e50>]}
[0m11:08:59.559851 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo_user.lim_market_customers ................ [[32mactivity: Create View, rows_affected: 0[0m in 10.22s]
[0m11:08:59.560401 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_market_customers
[0m11:08:59.561750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:08:59.562286 [debug] [MainThread]: Connection 'model.jaffle_shop_teradata.lim_market_customers' was properly closed.
[0m11:08:59.562744 [info ] [MainThread]: 
[0m11:08:59.563113 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 14.44 seconds (14.44s).
[0m11:08:59.563737 [debug] [MainThread]: Command end result
[0m11:08:59.615130 [info ] [MainThread]: 
[0m11:08:59.617654 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:08:59.620264 [info ] [MainThread]: 
[0m11:08:59.622499 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:08:59.627487 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.49091, "process_user_time": 2.025082, "process_kernel_time": 0.338719, "process_mem_max_rss": "122777600", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:08:59.628143 [debug] [MainThread]: Command `cli run` succeeded at 11:08:59.628061 after 15.49 seconds
[0m11:08:59.628518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee189cf6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee19e11640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee19e11c10>]}
[0m11:08:59.628871 [debug] [MainThread]: Flushing usage events
[0m11:24:29.281658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae825e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf9911160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf9911430>]}


============================== 11:24:29.291021 | 2beb4589-7cd7-4d72-a1d6-de6e9299f4c3 ==============================
[0m11:24:29.291021 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:24:29.291604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/remi.turpaud/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:24:30.161311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf9987430>]}
[0m11:24:30.197794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad8c7dc10>]}
[0m11:24:30.208493 [info ] [MainThread]: Registered adapter: teradata=1.8.0
[0m11:24:30.286263 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:24:31.199959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:24:31.201189 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:24:31.213356 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.staging
- models.jaffle_shop
[0m11:24:31.282424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafa106fa0>]}
[0m11:24:31.509742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf9f31460>]}
[0m11:24:31.510503 [info ] [MainThread]: Found 19 models, 1 snapshot, 3 seeds, 8 data tests, 1 source, 573 macros
[0m11:24:31.510853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafa0adeb0>]}
[0m11:24:31.512867 [info ] [MainThread]: 
[0m11:24:31.513374 [debug] [MainThread]: Acquiring new teradata connection 'master'
[0m11:24:31.519132 [debug] [ThreadPool]: Acquiring new teradata connection 'list_schemas'
[0m11:24:31.530527 [debug] [ThreadPool]: Using teradata connection "list_schemas"
[0m11:24:31.530856 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_schemas"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
[0m11:24:31.531117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:32.700057 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:24:32.702038 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:24:32.854753 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 46 in 1.322 seconds
[0m11:24:32.862590 [debug] [ThreadPool]: On list_schemas: Close
[0m11:24:32.968644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_schemas, now list_None_demo_user)
[0m11:24:32.980429 [debug] [ThreadPool]: Using teradata connection "list_None_demo_user"
[0m11:24:32.981067 [debug] [ThreadPool]: On list_None_demo_user: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_None_demo_user"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
[0m11:24:32.981576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:24:33.737661 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:24:33.740116 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:24:33.954112 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 17 in 0.971 seconds
[0m11:24:33.960595 [debug] [ThreadPool]: On list_None_demo_user: Close
[0m11:24:34.027493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None_demo_user, now list_None_rt186001)
[0m11:24:34.040279 [debug] [ThreadPool]: Using teradata connection "list_None_rt186001"
[0m11:24:34.041022 [debug] [ThreadPool]: On list_None_rt186001: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_None_rt186001"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'rt186001' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
[0m11:24:34.041621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:24:34.726011 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:24:34.728589 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:24:34.921875 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 0 in 0.879 seconds
[0m11:24:34.926629 [debug] [ThreadPool]: On list_None_rt186001: Close
[0m11:24:34.995890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafa1462b0>]}
[0m11:24:34.998144 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:24:34.999098 [info ] [MainThread]: 
[0m11:24:35.019760 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.key_customer
[0m11:24:35.021220 [info ] [Thread-1  ]: 1 of 19 START sql incremental model demo_user.key_customer ..................... [RUN]
[0m11:24:35.022214 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_None_rt186001, now model.jaffle_shop_teradata.key_customer)
[0m11:24:35.022937 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.key_customer
[0m11:24:35.041235 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.key_customer"
[0m11:24:35.053758 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.key_customer
[0m11:24:35.081378 [debug] [Thread-1  ]: Setting query_band
[0m11:24:35.101614 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.key_customer"
[0m11:24:35.101954 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.key_customer"} */
DROP table /*+ IF EXISTS */ "demo_user"."key_customer__dbt_backup";
[0m11:24:35.102245 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:24:35.807576 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:24:35.809732 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:24:35.854310 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1051] [Teradata Database] [Error 3807] Object 'demo_user.key_customer__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:24:35.867558 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.key_customer"
[0m11:24:35.868265 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.key_customer"} */

    DROP table /*+ IF EXISTS */ "demo_user"."key_customer__dbt_backup";
  
[0m11:24:35.911947 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1051] [Teradata Database] [Error 3807] Object 'demo_user.key_customer__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:24:35.914348 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.key_customer"
[0m11:24:35.915088 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.key_customer"} */

    RENAME table "demo_user"."key_customer" TO "demo_user"."key_customer__dbt_backup"
  
[0m11:24:36.148903 [debug] [Thread-1  ]: SQL status: activity: Rename Table, rows_affected: 2 in 0.232 seconds
[0m11:24:36.172591 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.key_customer"
[0m11:24:36.173249 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.key_customer"} */

      CREATE  TABLE
      "demo_user"."key_customer"
      AS (
            



--Create the surrogate key table with default members if it doesn't exist
select
    -1 (integer) customer_key
    ,'UNKNOWN' (varchar(10000)) customer_nk
    ,'' (char(100)) domain_cd
    ,current_timestamp created_ts
from (sel 1 a) dummy
        ) WITH NO DATA
      
      ;
    
[0m11:24:36.490839 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.316 seconds
[0m11:24:36.495165 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.key_customer"
[0m11:24:36.508532 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.key_customer"
[0m11:24:36.510717 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.key_customer"} */

   
  
    
    

    INSERT INTO "demo_user"."key_customer"
          



--Create the surrogate key table with default members if it doesn't exist
select
    -1 (integer) customer_key
    ,'UNKNOWN' (varchar(10000)) customer_nk
    ,'' (char(100)) domain_cd
    ,current_timestamp created_ts
from (sel 1 a) dummy
    ;
  

  

[0m11:24:36.639636 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 1 in 0.127 seconds
[0m11:24:36.728840 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.key_customer"
[0m11:24:36.729298 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.key_customer"} */
DROP table /*+ IF EXISTS */ "demo_user"."key_customer__dbt_backup";
[0m11:24:37.071505 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 17 in 0.341 seconds
[0m11:24:37.079573 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: Close
[0m11:24:37.152676 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae82b3df0>]}
[0m11:24:37.154407 [info ] [Thread-1  ]: 1 of 19 OK created sql incremental model demo_user.key_customer ................ [[32mactivity: Insert, rows_affected: 1[0m in 2.13s]
[0m11:24:37.155885 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.key_customer
[0m11:24:37.156859 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_market_customers
[0m11:24:37.157968 [info ] [Thread-1  ]: 2 of 19 START sql view model demo_user.lim_market_customers .................... [RUN]
[0m11:24:37.159111 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.key_customer, now model.jaffle_shop_teradata.lim_market_customers)
[0m11:24:37.159831 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_market_customers
[0m11:24:37.167745 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_market_customers"
[0m11:24:37.180935 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_market_customers
[0m11:24:37.187200 [debug] [Thread-1  ]: Setting query_band
[0m11:24:37.213244 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:24:37.213772 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    drop table demo_user.raw_market_customers;
  
[0m11:24:37.214126 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:24:37.881032 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:24:37.883234 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:24:38.222886 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 24 in 1.007 seconds
[0m11:24:38.228216 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:24:38.229345 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    create foreign table demo_user.raw_market_customers using (location('/GS/storage.googleapis.com/clearscape_analytics_demo_data/DEMO_Market/Customer/'));
  
[0m11:24:44.615910 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 6.385 seconds
[0m11:24:44.632821 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.lim_market_customers"
[0m11:24:44.647216 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:24:44.647890 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

  

  
  REPLACE VIEW "demo_user"."lim_market_customers__dbt_tmp" AS
    /*
  Build a light integrated modeled layer from source image 
  for entity `market_customers`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
*/

select
spend,
nearby5,
nearby10,
new ST_GEOMETRY(ptLocWkt) location_pt
from "demo_user"."raw_market_customers" s


[0m11:24:44.943339 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 0.295 seconds
[0m11:24:44.947425 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:24:44.947869 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    DROP view /*+ IF EXISTS */ "demo_user"."lim_market_customers__dbt_backup";
  
[0m11:24:44.991177 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1052] [Teradata Database] [Error 3807] Object 'demo_user.lim_market_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:24:44.993144 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:24:44.993780 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    RENAME view "demo_user"."lim_market_customers" TO "demo_user"."lim_market_customers__dbt_backup"
  
[0m11:24:45.190180 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.195 seconds
[0m11:24:45.196200 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:24:45.196683 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    DROP view /*+ IF EXISTS */ "demo_user"."lim_market_customers";
  
[0m11:24:45.241434 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1052] [Teradata Database] [Error 3807] Object 'demo_user.lim_market_customers' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:24:45.245511 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:24:45.246426 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    RENAME view "demo_user"."lim_market_customers__dbt_tmp" TO "demo_user"."lim_market_customers"
  
[0m11:24:45.419140 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.171 seconds
[0m11:24:45.435611 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:24:45.436361 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */
DROP view /*+ IF EXISTS */ "demo_user"."lim_market_customers__dbt_backup";
[0m11:24:45.671177 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 10 in 0.233 seconds
[0m11:24:45.675596 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: Close
[0m11:24:45.759526 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafa1e1c70>]}
[0m11:24:45.762775 [info ] [Thread-1  ]: 2 of 19 OK created sql view model demo_user.lim_market_customers ............... [[32mactivity: Create View, rows_affected: 0[0m in 8.60s]
[0m11:24:45.764340 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_market_customers
[0m11:24:45.765354 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.stg_customers
[0m11:24:45.766735 [info ] [Thread-1  ]: 3 of 19 START sql view model demo_user.stg_customers ........................... [RUN]
[0m11:24:45.767929 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.lim_market_customers, now model.jaffle_shop_teradata.stg_customers)
[0m11:24:45.768681 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.stg_customers
[0m11:24:45.775959 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.stg_customers"
[0m11:24:45.789741 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.stg_customers
[0m11:24:45.794190 [debug] [Thread-1  ]: Setting query_band
[0m11:24:45.797141 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.stg_customers"
[0m11:24:45.817886 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_customers"
[0m11:24:45.818570 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_customers"} */

  

  
  REPLACE VIEW "demo_user"."stg_customers__dbt_tmp" AS
    locking row for access
select
    id as customer_id,
    first_name (varchar(1000)),
    last_name (varchar(1000)),
    email (varchar(1000)),
    current_timestamp last_update_ts
from "demo_user"."raw_customers" source


[0m11:24:45.819163 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:24:46.485888 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:24:46.488055 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:24:46.806590 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 0.986 seconds
[0m11:24:46.819029 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_customers"
[0m11:24:46.819939 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_customers"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_customers__dbt_backup";
  
[0m11:24:46.866165 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1053] [Teradata Database] [Error 3807] Object 'demo_user.stg_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:24:46.870042 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_customers"
[0m11:24:46.871061 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_customers"} */

    RENAME view "demo_user"."stg_customers" TO "demo_user"."stg_customers__dbt_backup"
  
[0m11:24:47.064089 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.192 seconds
[0m11:24:47.072396 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_customers"
[0m11:24:47.073208 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_customers"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_customers";
  
[0m11:24:47.119159 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1053] [Teradata Database] [Error 3807] Object 'demo_user.stg_customers' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:24:47.121869 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_customers"
[0m11:24:47.122716 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_customers"} */

    RENAME view "demo_user"."stg_customers__dbt_tmp" TO "demo_user"."stg_customers"
  
[0m11:24:47.318938 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.193 seconds
[0m11:24:47.329206 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_customers"
[0m11:24:47.330001 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_customers"} */
DROP view /*+ IF EXISTS */ "demo_user"."stg_customers__dbt_backup";
[0m11:24:47.565897 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 11 in 0.234 seconds
[0m11:24:47.570431 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: Close
[0m11:24:47.641920 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafa286f70>]}
[0m11:24:47.644194 [info ] [Thread-1  ]: 3 of 19 OK created sql view model demo_user.stg_customers ...................... [[32mactivity: Create View, rows_affected: 0[0m in 1.87s]
[0m11:24:47.645623 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.stg_customers
[0m11:24:47.646687 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.stg_market_customers
[0m11:24:47.648142 [info ] [Thread-1  ]: 4 of 19 START sql view model demo_user.stg_market_customers .................... [RUN]
[0m11:24:47.649141 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.stg_customers, now model.jaffle_shop_teradata.stg_market_customers)
[0m11:24:47.649823 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.stg_market_customers
[0m11:24:47.659197 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.stg_market_customers"
[0m11:24:47.674074 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.stg_market_customers
[0m11:24:47.678104 [debug] [Thread-1  ]: Setting query_band
[0m11:24:47.682136 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m11:24:47.682757 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */

    drop table demo_user.raw_market_customers;
  
[0m11:24:47.683246 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:24:48.355176 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:24:48.357689 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:24:48.679654 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 24 in 0.995 seconds
[0m11:24:48.685387 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m11:24:48.686577 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */

    create foreign table demo_user.raw_market_customers using (location('/GS/storage.googleapis.com/clearscape_analytics_demo_data/DEMO_Market/Customer/'));
  
[0m11:24:54.809900 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 6.121 seconds
[0m11:24:54.817805 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.stg_market_customers"
[0m11:24:54.820623 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m11:24:54.821555 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */

  

  
  REPLACE VIEW "demo_user"."stg_market_customers__dbt_tmp" AS
    



with source as (
    select * from "demo_user"."raw_market_customers"

),

renamed as 
(
    select
    source.*
    from source

)

select * from renamed


[0m11:24:55.138718 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 0.315 seconds
[0m11:24:55.148898 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m11:24:55.149716 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_market_customers";
  
[0m11:24:55.196144 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1054] [Teradata Database] [Error 3807] Object 'demo_user.stg_market_customers' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:24:55.199795 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m11:24:55.200705 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */

    RENAME view "demo_user"."stg_market_customers__dbt_tmp" TO "demo_user"."stg_market_customers"
  
[0m11:24:55.414976 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.213 seconds
[0m11:24:55.424860 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m11:24:55.425625 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */
DROP view /*+ IF EXISTS */ "demo_user"."stg_market_customers__dbt_backup";
[0m11:24:55.470487 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1054] [Teradata Database] [Error 3807] Object 'demo_user.stg_market_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:24:55.474957 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: Close
[0m11:24:55.541366 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafa352a90>]}
[0m11:24:55.543900 [info ] [Thread-1  ]: 4 of 19 OK created sql view model demo_user.stg_market_customers ............... [[32mactivity: Create View, rows_affected: 0[0m in 7.89s]
[0m11:24:55.545341 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.stg_market_customers
[0m11:24:55.546385 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.stg_orders
[0m11:24:55.547678 [info ] [Thread-1  ]: 5 of 19 START sql view model demo_user.stg_orders .............................. [RUN]
[0m11:24:55.548793 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.stg_market_customers, now model.jaffle_shop_teradata.stg_orders)
[0m11:24:55.549528 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.stg_orders
[0m11:24:55.556771 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.stg_orders"
[0m11:24:55.576528 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.stg_orders
[0m11:24:55.583445 [debug] [Thread-1  ]: Setting query_band
[0m11:24:55.586484 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.stg_orders"
[0m11:24:55.606366 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_orders"
[0m11:24:55.607322 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_orders"} */

  

  
  REPLACE VIEW "demo_user"."stg_orders__dbt_tmp" AS
    locking row for access
select
    source.*,
    current_timestamp last_update_ts
from "demo_user"."raw_orders" source


[0m11:24:55.607935 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:24:56.259777 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:24:56.262949 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:24:56.598941 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 0.991 seconds
[0m11:24:56.610244 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_orders"
[0m11:24:56.611066 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_orders"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_orders__dbt_backup";
  
[0m11:24:56.656269 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1055] [Teradata Database] [Error 3807] Object 'demo_user.stg_orders__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:24:56.660334 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_orders"
[0m11:24:56.661067 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_orders"} */

    RENAME view "demo_user"."stg_orders" TO "demo_user"."stg_orders__dbt_backup"
  
[0m11:24:56.920610 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.258 seconds
[0m11:24:56.928605 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_orders"
[0m11:24:56.929373 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_orders"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_orders";
  
[0m11:24:56.974472 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1055] [Teradata Database] [Error 3807] Object 'demo_user.stg_orders' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:24:56.980241 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_orders"
[0m11:24:56.981152 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_orders"} */

    RENAME view "demo_user"."stg_orders__dbt_tmp" TO "demo_user"."stg_orders"
  
[0m11:24:57.171588 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.189 seconds
[0m11:24:57.183201 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_orders"
[0m11:24:57.184182 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_orders"} */
DROP view /*+ IF EXISTS */ "demo_user"."stg_orders__dbt_backup";
[0m11:24:57.396094 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 11 in 0.210 seconds
[0m11:24:57.401084 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: Close
[0m11:24:57.476536 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafa352a90>]}
[0m11:24:57.478327 [info ] [Thread-1  ]: 5 of 19 OK created sql view model demo_user.stg_orders ......................... [[32mactivity: Create View, rows_affected: 0[0m in 1.93s]
[0m11:24:57.479699 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.stg_orders
[0m11:24:57.480706 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.stg_payments
[0m11:24:57.482078 [info ] [Thread-1  ]: 6 of 19 START sql view model demo_user.stg_payments ............................ [RUN]
[0m11:24:57.483005 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.stg_orders, now model.jaffle_shop_teradata.stg_payments)
[0m11:24:57.483666 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.stg_payments
[0m11:24:57.491255 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.stg_payments"
[0m11:24:57.504319 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.stg_payments
[0m11:24:57.508367 [debug] [Thread-1  ]: Setting query_band
[0m11:24:57.511411 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.stg_payments"
[0m11:24:57.523118 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_payments"
[0m11:24:57.523848 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_payments"} */

  

  
  REPLACE VIEW "demo_user"."stg_payments__dbt_tmp" AS
    locking row for access
select
source.*
,'2024-09-03 09:24:29.194727+00:00' (timestamp) last_update_ts
from  "demo_user"."raw_payments" source


[0m11:24:57.524431 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:24:58.208153 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:24:58.210951 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:24:58.505904 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 0.980 seconds
[0m11:24:58.518333 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_payments"
[0m11:24:58.519145 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_payments"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_payments__dbt_backup";
  
[0m11:24:58.562459 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1056] [Teradata Database] [Error 3807] Object 'demo_user.stg_payments__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:24:58.565393 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_payments"
[0m11:24:58.566253 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_payments"} */

    RENAME view "demo_user"."stg_payments" TO "demo_user"."stg_payments__dbt_backup"
  
[0m11:24:58.734365 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.167 seconds
[0m11:24:58.744530 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_payments"
[0m11:24:58.745368 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_payments"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_payments";
  
[0m11:24:58.790537 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1056] [Teradata Database] [Error 3807] Object 'demo_user.stg_payments' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:24:58.795850 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_payments"
[0m11:24:58.796762 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_payments"} */

    RENAME view "demo_user"."stg_payments__dbt_tmp" TO "demo_user"."stg_payments"
  
[0m11:24:58.989086 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.190 seconds
[0m11:24:59.000416 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_payments"
[0m11:24:59.001298 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_payments"} */
DROP view /*+ IF EXISTS */ "demo_user"."stg_payments__dbt_backup";
[0m11:24:59.213507 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 11 in 0.210 seconds
[0m11:24:59.218746 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: Close
[0m11:24:59.284128 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafa008850>]}
[0m11:24:59.286467 [info ] [Thread-1  ]: 6 of 19 OK created sql view model demo_user.stg_payments ....................... [[32mactivity: Create View, rows_affected: 0[0m in 1.80s]
[0m11:24:59.287937 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.stg_payments
[0m11:24:59.288916 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.customer
[0m11:24:59.290316 [info ] [Thread-1  ]: 7 of 19 START sql view model demo_user.customer ................................ [RUN]
[0m11:24:59.291395 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.stg_payments, now model.jaffle_shop_teradata.customer)
[0m11:24:59.292073 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.customer
[0m11:24:59.298285 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.customer"
[0m11:24:59.311511 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.customer
[0m11:24:59.315990 [debug] [Thread-1  ]: Setting query_band
[0m11:24:59.319078 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.customer"
[0m11:24:59.338186 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer"
[0m11:24:59.338863 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer"} */

  

  
  REPLACE VIEW "demo_user"."customer__dbt_tmp" AS
    

locking row for access
select
    customer_key,
    substr(customer_nk,1,3)||'***' email
from "demo_user"."key_customer"
where domain_cd = 'retail'


[0m11:24:59.339451 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:25:00.061672 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:00.063684 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:00.298537 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 0.958 seconds
[0m11:25:00.309469 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer"
[0m11:25:00.310355 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer"} */

    DROP view /*+ IF EXISTS */ "demo_user"."customer__dbt_backup";
  
[0m11:25:00.355608 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1057] [Teradata Database] [Error 3807] Object 'demo_user.customer__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:25:00.360459 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer"
[0m11:25:00.361476 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer"} */

    RENAME view "demo_user"."customer" TO "demo_user"."customer__dbt_backup"
  
[0m11:25:00.537213 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.174 seconds
[0m11:25:00.549694 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer"
[0m11:25:00.550565 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer"} */

    DROP view /*+ IF EXISTS */ "demo_user"."customer";
  
[0m11:25:00.595787 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1057] [Teradata Database] [Error 3807] Object 'demo_user.customer' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:25:00.600377 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer"
[0m11:25:00.601509 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer"} */

    RENAME view "demo_user"."customer__dbt_tmp" TO "demo_user"."customer"
  
[0m11:25:00.878889 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.276 seconds
[0m11:25:00.890773 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer"
[0m11:25:00.891684 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer"} */
DROP view /*+ IF EXISTS */ "demo_user"."customer__dbt_backup";
[0m11:25:01.083352 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 8 in 0.190 seconds
[0m11:25:01.088458 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: Close
[0m11:25:01.158919 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafa380b80>]}
[0m11:25:01.161498 [info ] [Thread-1  ]: 7 of 19 OK created sql view model demo_user.customer ........................... [[32mactivity: Create View, rows_affected: 0[0m in 1.87s]
[0m11:25:01.163022 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.customer
[0m11:25:01.164036 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.sim_customers
[0m11:25:01.165314 [info ] [Thread-1  ]: 8 of 19 START sql incremental model demo_user.sim_customers .................... [RUN]
[0m11:25:01.166467 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.customer, now model.jaffle_shop_teradata.sim_customers)
[0m11:25:01.167199 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.sim_customers
[0m11:25:01.199492 [debug] [Thread-1  ]: use_qvci set to : false
[0m11:25:01.200258 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m11:25:01.200924 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        WHEN ColumnsV.ColumnType = 'JN' THEN 'JSON'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType in (1, 2) THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'stg_customers' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
[0m11:25:01.201586 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:25:02.056335 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:02.059020 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:02.655751 [debug] [Thread-1  ]: SQL status: activity: Select, rows_affected: 5 in 1.453 seconds
[0m11:25:02.672211 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.sim_customers"
[0m11:25:02.697309 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.sim_customers
[0m11:25:02.702344 [debug] [Thread-1  ]: Setting query_band
[0m11:25:02.710249 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m11:25:02.710816 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */
DROP table /*+ IF EXISTS */ "demo_user"."sim_customers__dbt_backup";
[0m11:25:02.753908 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1058] [Teradata Database] [Error 3807] Object 'demo_user.sim_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:25:02.760523 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m11:25:02.761200 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */

    DROP table /*+ IF EXISTS */ "demo_user"."sim_customers__dbt_backup";
  
[0m11:25:02.803619 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1058] [Teradata Database] [Error 3807] Object 'demo_user.sim_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:25:02.805405 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m11:25:02.805834 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */

    RENAME table "demo_user"."sim_customers" TO "demo_user"."sim_customers__dbt_backup"
  
[0m11:25:03.038425 [debug] [Thread-1  ]: SQL status: activity: Rename Table, rows_affected: 3 in 0.231 seconds
[0m11:25:03.046376 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m11:25:03.047542 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */

      CREATE  TABLE
      "demo_user"."sim_customers"
      AS (
            

-- Generic source image build for `customers` entity


select    
    customer_id,    
    first_name,    
    last_name,    
    email
    
,period(last_update_ts, '9999-12-31 23:59:59.999999+00:00' (timestamp)) as valid_period
from "demo_user"."stg_customers" source
 
 
        ) WITH NO DATA
      
      ;
    
[0m11:25:03.365760 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.316 seconds
[0m11:25:03.370530 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.sim_customers"
[0m11:25:03.376772 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m11:25:03.377463 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */

   
  
    
    

    INSERT INTO "demo_user"."sim_customers"
          

-- Generic source image build for `customers` entity


select    
    customer_id,    
    first_name,    
    last_name,    
    email
    
,period(last_update_ts, '9999-12-31 23:59:59.999999+00:00' (timestamp)) as valid_period
from "demo_user"."stg_customers" source
 
 
    ;
  

  

[0m11:25:03.548158 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 100 in 0.170 seconds
[0m11:25:03.558409 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m11:25:03.559297 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */
DROP table /*+ IF EXISTS */ "demo_user"."sim_customers__dbt_backup";
[0m11:25:03.835227 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 19 in 0.274 seconds
[0m11:25:03.841011 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: Close
[0m11:25:03.910849 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafa380b80>]}
[0m11:25:03.912929 [info ] [Thread-1  ]: 8 of 19 OK created sql incremental model demo_user.sim_customers ............... [[32mactivity: Insert, rows_affected: 100[0m in 2.74s]
[0m11:25:03.914362 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.sim_customers
[0m11:25:03.915352 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.test
[0m11:25:03.916839 [info ] [Thread-1  ]: 9 of 19 START sql view model demo_user.test .................................... [RUN]
[0m11:25:03.917882 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.sim_customers, now model.jaffle_shop_teradata.test)
[0m11:25:03.918622 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.test
[0m11:25:03.933637 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.test"
[0m11:25:03.944600 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.test
[0m11:25:03.948155 [debug] [Thread-1  ]: Setting query_band
[0m11:25:03.951589 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.test"
[0m11:25:03.972762 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.test"
[0m11:25:03.973468 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.test: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.test"} */

  

  
  REPLACE VIEW "demo_user"."test__dbt_tmp" AS
    
    

    insert into "demo_user"."key_customer"
    select
        rank() over(partition by domain_cd order by customer_nk) (integer) customer_key 
        ,nk (varchar(10000)) customer_nk
        ,domain_cd (char(100)) domain_cd
        ,current_timestamp created_ts
    from 
    (
        select coalesce(trim(email), '')||'|'||coalesce(trim(first_name), '') nk
        , 'retail' domain_cd 
        from "demo_user"."stg_customers"
        group by 1,2
    ) source
    where not exists
    (sel 1 from  "demo_user"."key_customer" k where k.customer_nk=source.nk and k.domain_cd=source.domain_cd )




[0m11:25:03.974023 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:25:04.662086 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:04.663816 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:04.709774 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1059] [Teradata Database] [Error 3707] Syntax error, expected something like a 'SELECT' keyword or a 'LOCK' keyword or '(' or a 'TRANSACTIONTIME' keyword between the 'AS' keyword and the 'insert' keyword.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:25:04.712474 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.test: Close
[0m11:25:04.844977 [debug] [Thread-1  ]: Database Error in model test (models/test.sql)
  [Version 20.0.0.15] [Session 1059] [Teradata Database] [Error 3707] Syntax error, expected something like a 'SELECT' keyword or a 'LOCK' keyword or '(' or a 'TRANSACTIONTIME' keyword between the 'AS' keyword and the 'insert' keyword.
   at gosqldriver/teradatasql.formatError ErrorUtil.go:91
   at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
   at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
   at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
   at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
   at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
   at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
   at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
   at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
   at database/sql.ctxDriverQuery ctxutil.go:48
   at database/sql.(*DB).queryDC.func1 sql.go:1776
   at database/sql.withLock sql.go:3530
   at database/sql.(*DB).queryDC sql.go:1771
   at database/sql.(*Conn).QueryContext sql.go:2027
   at main.createRows goside.go:783
   at main.goCreateRows goside.go:662
   at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
   at runtime.cgocallbackg1 cgocall.go:420
   at runtime.cgocallbackg cgocall.go:339
   at runtime.cgocallback asm_amd64.s:1079
   at runtime.goexit asm_amd64.s:1695
  compiled Code at target/run/jaffle_shop_teradata/models/test.sql
[0m11:25:04.847218 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae89e31f0>]}
[0m11:25:04.848298 [error] [Thread-1  ]: 9 of 19 ERROR creating sql view model demo_user.test ........................... [[31mERROR[0m in 0.93s]
[0m11:25:04.849456 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.test
[0m11:25:04.850176 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.sim_orders
[0m11:25:04.851091 [info ] [Thread-1  ]: 10 of 19 START sql incremental model demo_user.sim_orders ...................... [RUN]
[0m11:25:04.851802 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.test, now model.jaffle_shop_teradata.sim_orders)
[0m11:25:04.852323 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.sim_orders
[0m11:25:04.865336 [debug] [Thread-1  ]: use_qvci set to : false
[0m11:25:04.866270 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m11:25:04.867054 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        WHEN ColumnsV.ColumnType = 'JN' THEN 'JSON'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType in (1, 2) THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'stg_orders' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
[0m11:25:04.867728 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:25:05.633889 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:05.636421 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:06.062630 [debug] [Thread-1  ]: SQL status: activity: Select, rows_affected: 5 in 1.194 seconds
[0m11:25:06.070272 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.sim_orders"
[0m11:25:06.093182 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.sim_orders
[0m11:25:06.099590 [debug] [Thread-1  ]: Setting query_band
[0m11:25:06.106445 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m11:25:06.107092 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */
DROP table /*+ IF EXISTS */ "demo_user"."sim_orders__dbt_backup";
[0m11:25:06.151539 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1060] [Teradata Database] [Error 3807] Object 'demo_user.sim_orders__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:25:06.158998 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m11:25:06.159760 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */

    DROP table /*+ IF EXISTS */ "demo_user"."sim_orders__dbt_backup";
  
[0m11:25:06.202937 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1060] [Teradata Database] [Error 3807] Object 'demo_user.sim_orders__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:25:06.205548 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m11:25:06.206259 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */

    RENAME table "demo_user"."sim_orders" TO "demo_user"."sim_orders__dbt_backup"
  
[0m11:25:06.411897 [debug] [Thread-1  ]: SQL status: activity: Rename Table, rows_affected: 2 in 0.204 seconds
[0m11:25:06.414843 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m11:25:06.415745 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */

      CREATE  TABLE
      "demo_user"."sim_orders"
      AS (
            

-- Generic source image build for `orders` entity


select    
    id,    
    user_id,    
    order_date,    
    status,    
    last_update_ts
from "demo_user"."stg_orders" source
 
 
        ) WITH NO DATA
      
      ;
    
[0m11:25:06.696376 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.279 seconds
[0m11:25:06.699741 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.sim_orders"
[0m11:25:06.720856 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m11:25:06.722533 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */

   
  
    
    

    INSERT INTO "demo_user"."sim_orders"
          

-- Generic source image build for `orders` entity


select    
    id,    
    user_id,    
    order_date,    
    status,    
    last_update_ts
from "demo_user"."stg_orders" source
 
 
    ;
  

  

[0m11:25:06.878112 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 99 in 0.154 seconds
[0m11:25:06.888095 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m11:25:06.888905 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */
DROP table /*+ IF EXISTS */ "demo_user"."sim_orders__dbt_backup";
[0m11:25:07.204688 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 18 in 0.314 seconds
[0m11:25:07.210141 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: Close
[0m11:25:07.283506 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafa073820>]}
[0m11:25:07.285773 [info ] [Thread-1  ]: 10 of 19 OK created sql incremental model demo_user.sim_orders ................. [[32mactivity: Insert, rows_affected: 99[0m in 2.43s]
[0m11:25:07.287221 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.sim_orders
[0m11:25:07.288235 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.sim_payments
[0m11:25:07.289552 [info ] [Thread-1  ]: 11 of 19 START sql incremental model demo_user.sim_payments .................... [RUN]
[0m11:25:07.290832 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.sim_orders, now model.jaffle_shop_teradata.sim_payments)
[0m11:25:07.291542 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.sim_payments
[0m11:25:07.301568 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.sim_payments"
[0m11:25:07.324304 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.sim_payments
[0m11:25:07.330429 [debug] [Thread-1  ]: Setting query_band
[0m11:25:07.335718 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_payments"
[0m11:25:07.336215 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_payments"} */
DROP table /*+ IF EXISTS */ "demo_user"."sim_payments__dbt_backup";
[0m11:25:07.336645 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:25:08.003441 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:08.005582 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:08.049987 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1061] [Teradata Database] [Error 3807] Object 'demo_user.sim_payments__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:25:08.059046 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_payments"
[0m11:25:08.060306 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_payments"} */

    DROP table /*+ IF EXISTS */ "demo_user"."sim_payments__dbt_backup";
  
[0m11:25:08.103885 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1061] [Teradata Database] [Error 3807] Object 'demo_user.sim_payments__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:25:08.106805 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_payments"
[0m11:25:08.107648 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_payments"} */

    RENAME table "demo_user"."sim_payments" TO "demo_user"."sim_payments__dbt_backup"
  
[0m11:25:08.406704 [debug] [Thread-1  ]: SQL status: activity: Rename Table, rows_affected: 2 in 0.297 seconds
[0m11:25:08.412392 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_payments"
[0m11:25:08.413621 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_payments"} */

      CREATE  TABLE
      "demo_user"."sim_payments"
      AS (
            

-- Source image build for `payments` entity

select source.*
from "demo_user"."stg_payments" source
        ) WITH NO DATA
      
      ;
    
[0m11:25:08.712772 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.297 seconds
[0m11:25:08.718800 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.sim_payments"
[0m11:25:08.733543 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_payments"
[0m11:25:08.734683 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_payments"} */

   
  
    
    

    INSERT INTO "demo_user"."sim_payments"
          

-- Source image build for `payments` entity

select source.*
from "demo_user"."stg_payments" source
    ;
  

  

[0m11:25:08.886379 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 113 in 0.150 seconds
[0m11:25:08.896995 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_payments"
[0m11:25:08.897863 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_payments"} */
DROP table /*+ IF EXISTS */ "demo_user"."sim_payments__dbt_backup";
[0m11:25:09.199227 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 18 in 0.300 seconds
[0m11:25:09.205239 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: Close
[0m11:25:09.316610 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafa3c70d0>]}
[0m11:25:09.319622 [info ] [Thread-1  ]: 11 of 19 OK created sql incremental model demo_user.sim_payments ............... [[32mactivity: Insert, rows_affected: 113[0m in 2.03s]
[0m11:25:09.321133 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.sim_payments
[0m11:25:09.322150 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_customers
[0m11:25:09.323556 [info ] [Thread-1  ]: 12 of 19 START sql incremental model demo_user.lim_customers ................... [RUN]
[0m11:25:09.324634 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.sim_payments, now model.jaffle_shop_teradata.lim_customers)
[0m11:25:09.325346 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_customers
[0m11:25:09.354552 [debug] [Thread-1  ]: use_qvci set to : false
[0m11:25:09.355391 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:25:09.356095 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        WHEN ColumnsV.ColumnType = 'JN' THEN 'JSON'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType in (1, 2) THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'sim_customers' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
[0m11:25:09.356773 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:25:10.088300 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:10.090664 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:10.493182 [debug] [Thread-1  ]: SQL status: activity: Select, rows_affected: 5 in 1.135 seconds
[0m11:25:10.500933 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_customers"
[0m11:25:10.516568 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_customers
[0m11:25:10.522309 [debug] [Thread-1  ]: Setting query_band
[0m11:25:10.527670 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:25:10.528399 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

        insert into "demo_user"."key_customer"
    select
        rank() over(partition by domain_cd order by customer_nk) (integer) customer_key 
        ,nk (varchar(10000)) customer_nk
        ,domain_cd (char(100)) domain_cd
        ,current_timestamp created_ts
    from 
    (
        select coalesce(trim(email), '') nk
        , 'retail' domain_cd 
        from "demo_user"."sim_customers"
        group by 1,2
    ) source
    where not exists
    (sel 1 from  "demo_user"."key_customer" k where k.customer_nk=source.nk and k.domain_cd=source.domain_cd )
      
[0m11:25:10.849831 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 100 in 0.319 seconds
[0m11:25:10.858694 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:25:10.859598 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

        insert into "demo_user"."key_customer"
    select
        rank() over(partition by domain_cd order by customer_nk) (integer) customer_key 
        ,nk (varchar(10000)) customer_nk
        ,domain_cd (char(100)) domain_cd
        ,current_timestamp created_ts
    from 
    (
        select coalesce(trim(last_name), '') nk
        , 'families' domain_cd 
        from "demo_user"."sim_customers"
        group by 1,2
    ) source
    where not exists
    (sel 1 from  "demo_user"."key_customer" k where k.customer_nk=source.nk and k.domain_cd=source.domain_cd )
      
[0m11:25:11.281383 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 85 in 0.420 seconds
[0m11:25:11.291850 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:25:11.292714 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */
DROP table /*+ IF EXISTS */ "demo_user"."lim_customers__dbt_backup";
[0m11:25:11.337061 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1062] [Teradata Database] [Error 3807] Object 'demo_user.lim_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:25:11.347008 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:25:11.347940 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

    DROP table /*+ IF EXISTS */ "demo_user"."lim_customers__dbt_backup";
  
[0m11:25:11.393270 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1062] [Teradata Database] [Error 3807] Object 'demo_user.lim_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:25:11.398790 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:25:11.399640 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

    RENAME table "demo_user"."lim_customers" TO "demo_user"."lim_customers__dbt_backup"
  
[0m11:25:11.633826 [debug] [Thread-1  ]: SQL status: activity: Rename Table, rows_affected: 3 in 0.232 seconds
[0m11:25:11.638811 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:25:11.639806 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

      CREATE  TABLE
      "demo_user"."lim_customers"
      AS (
            /*
  Build a light integrated modeled layer from source image 
  for entity `customers`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
  - Surrogate key assigment
  - Naming conventions alignment
*/










with source as
(
  select
  s.*
  from "demo_user"."sim_customers" s
  where valid_period contains current_timestamp
)
select
    --Value columns
      customer_id,
      first_name,
      email,
      valid_period
    --Surrogate key columns
    ,coalesce(customer.customer_key,-1) customer_key
    ,coalesce(family.customer_key,-1) family_key
from source s
--Surrogate key joins
left join "demo_user"."key_customer" customer
  on customer.customer_nk=coalesce(trim(email), '')
  and customer.domain_cd='retail'

left join "demo_user"."key_customer" family
  on family.customer_nk=coalesce(trim(last_name), '')
  and family.domain_cd='families'



        ) WITH NO DATA
      
      ;
    
[0m11:25:12.147255 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.505 seconds
[0m11:25:12.151425 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.lim_customers"
[0m11:25:12.165230 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:25:12.166221 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

   
  
    
    

    INSERT INTO "demo_user"."lim_customers"
          /*
  Build a light integrated modeled layer from source image 
  for entity `customers`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
  - Surrogate key assigment
  - Naming conventions alignment
*/










with source as
(
  select
  s.*
  from "demo_user"."sim_customers" s
  where valid_period contains current_timestamp
)
select
    --Value columns
      customer_id,
      first_name,
      email,
      valid_period
    --Surrogate key columns
    ,coalesce(customer.customer_key,-1) customer_key
    ,coalesce(family.customer_key,-1) family_key
from source s
--Surrogate key joins
left join "demo_user"."key_customer" customer
  on customer.customer_nk=coalesce(trim(email), '')
  and customer.domain_cd='retail'

left join "demo_user"."key_customer" family
  on family.customer_nk=coalesce(trim(last_name), '')
  and family.domain_cd='families'



    ;
  

  

[0m11:25:12.504367 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 100 in 0.336 seconds
[0m11:25:12.515196 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:25:12.516104 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */
DROP table /*+ IF EXISTS */ "demo_user"."lim_customers__dbt_backup";
[0m11:25:12.917975 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 20 in 0.400 seconds
[0m11:25:12.923597 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: Close
[0m11:25:12.990558 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafa365eb0>]}
[0m11:25:12.994252 [info ] [Thread-1  ]: 12 of 19 OK created sql incremental model demo_user.lim_customers .............. [[32mactivity: Insert, rows_affected: 100[0m in 3.67s]
[0m11:25:12.995976 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_customers
[0m11:25:12.997044 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_orders
[0m11:25:12.998290 [info ] [Thread-1  ]: 13 of 19 START sql incremental model demo_user.lim_orders ...................... [RUN]
[0m11:25:12.999392 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.lim_customers, now model.jaffle_shop_teradata.lim_orders)
[0m11:25:13.000094 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_orders
[0m11:25:13.015431 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_orders"
[0m11:25:13.027063 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_orders
[0m11:25:13.032658 [debug] [Thread-1  ]: Setting query_band
[0m11:25:13.036254 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_orders"
[0m11:25:13.036779 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_orders"} */

        insert into "demo_user"."key_customer"
    select
        rank() over(partition by domain_cd order by customer_nk) (integer) customer_key 
        ,nk (varchar(10000)) customer_nk
        ,domain_cd (char(100)) domain_cd
        ,current_timestamp created_ts
    from 
    (
        select coalesce(trim(email), '') nk
        , 'retail' domain_cd 
        from "demo_user"."sim_customers"
        group by 1,2
    ) source
    where not exists
    (sel 1 from  "demo_user"."key_customer" k where k.customer_nk=source.nk and k.domain_cd=source.domain_cd )
      
[0m11:25:13.037246 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:25:13.725992 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:13.729121 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:14.237633 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 0 in 1.199 seconds
[0m11:25:14.242831 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_orders"
[0m11:25:14.243973 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_orders"} */

      CREATE  TABLE
      "demo_user"."lim_orders"
      AS (
            /*
  Build a light integrated modeled layer from source image 
  for entity `orders`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
  - Surrogate key assigment
  - Naming conventions alignment
*/

with source as
(
  select
  s.*  
  ,coalesce(c.email,'UNKNOWN') email
  from "demo_user"."sim_orders" s
  left join "demo_user"."sim_customers" c
    on c.customer_id=s.user_id
    and c.valid_period contains current_timestamp
)
select
    s.*
    --Surrogate key columns
    ,coalesce(customer.customer_key,-1) customer_key
from source s
--Surrogate key joins
left join "demo_user"."key_customer" customer
  on customer.customer_nk=coalesce(trim(email), '')
  and customer.domain_cd='retail'

        ) WITH NO DATA
      
      ;
    
[0m11:25:14.602399 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.357 seconds
[0m11:25:14.607883 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.lim_orders"
[0m11:25:14.611120 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_orders"
[0m11:25:14.612129 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_orders"} */

   
  
    
    

    INSERT INTO "demo_user"."lim_orders"
          /*
  Build a light integrated modeled layer from source image 
  for entity `orders`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
  - Surrogate key assigment
  - Naming conventions alignment
*/

with source as
(
  select
  s.*  
  ,coalesce(c.email,'UNKNOWN') email
  from "demo_user"."sim_orders" s
  left join "demo_user"."sim_customers" c
    on c.customer_id=s.user_id
    and c.valid_period contains current_timestamp
)
select
    s.*
    --Surrogate key columns
    ,coalesce(customer.customer_key,-1) customer_key
from source s
--Surrogate key joins
left join "demo_user"."key_customer" customer
  on customer.customer_nk=coalesce(trim(email), '')
  and customer.domain_cd='retail'

    ;
  

  

[0m11:25:14.848558 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 99 in 0.235 seconds
[0m11:25:14.855642 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: Close
[0m11:25:14.930658 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafa365eb0>]}
[0m11:25:14.935024 [info ] [Thread-1  ]: 13 of 19 OK created sql incremental model demo_user.lim_orders ................. [[32mactivity: Insert, rows_affected: 99[0m in 1.93s]
[0m11:25:14.936889 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_orders
[0m11:25:14.938028 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_payments
[0m11:25:14.939411 [info ] [Thread-1  ]: 14 of 19 START sql view model demo_user.lim_payments ........................... [RUN]
[0m11:25:14.940567 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.lim_orders, now model.jaffle_shop_teradata.lim_payments)
[0m11:25:14.941297 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_payments
[0m11:25:14.949110 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_payments"
[0m11:25:14.959832 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_payments
[0m11:25:14.964728 [debug] [Thread-1  ]: Setting query_band
[0m11:25:14.967650 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.lim_payments"
[0m11:25:14.984741 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_payments"
[0m11:25:14.985718 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_payments"} */

  

  
  REPLACE VIEW "demo_user"."lim_payments__dbt_tmp" AS
    /*
  Build a light integrated modeled layer from source image 
  for entity `payments`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
  - Naming conventions alignment
*/

sel
  id as payment_id,
  order_id,
  payment_method,
  --`amount` is currently stored in cents, so we convert it to dollars
  amount / 100 as amount_usd
  from "demo_user"."sim_payments" s


[0m11:25:14.986303 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:25:15.679593 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:15.681113 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:15.996120 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 1.009 seconds
[0m11:25:16.012266 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_payments"
[0m11:25:16.013565 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_payments"} */

    DROP view /*+ IF EXISTS */ "demo_user"."lim_payments__dbt_backup";
  
[0m11:25:16.058004 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1064] [Teradata Database] [Error 3807] Object 'demo_user.lim_payments__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:25:16.063014 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_payments"
[0m11:25:16.067213 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_payments"} */

    RENAME view "demo_user"."lim_payments" TO "demo_user"."lim_payments__dbt_backup"
  
[0m11:25:16.260401 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.192 seconds
[0m11:25:16.274634 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_payments"
[0m11:25:16.276846 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_payments"} */

    DROP view /*+ IF EXISTS */ "demo_user"."lim_payments";
  
[0m11:25:16.322559 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1064] [Teradata Database] [Error 3807] Object 'demo_user.lim_payments' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:25:16.326106 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_payments"
[0m11:25:16.327871 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_payments"} */

    RENAME view "demo_user"."lim_payments__dbt_tmp" TO "demo_user"."lim_payments"
  
[0m11:25:16.623755 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.294 seconds
[0m11:25:16.644539 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_payments"
[0m11:25:16.646380 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_payments"} */
DROP view /*+ IF EXISTS */ "demo_user"."lim_payments__dbt_backup";
[0m11:25:16.901139 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 10 in 0.253 seconds
[0m11:25:16.907913 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: Close
[0m11:25:16.975312 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafa3c70d0>]}
[0m11:25:16.980252 [info ] [Thread-1  ]: 14 of 19 OK created sql view model demo_user.lim_payments ...................... [[32mactivity: Create View, rows_affected: 0[0m in 2.03s]
[0m11:25:16.982539 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_payments
[0m11:25:16.985328 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.customer_lifetime_value
[0m11:25:16.987288 [info ] [Thread-1  ]: 15 of 19 START sql incremental model demo_user.customer_lifetime_value ......... [RUN]
[0m11:25:16.988956 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.lim_payments, now model.jaffle_shop_teradata.customer_lifetime_value)
[0m11:25:16.989936 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.customer_lifetime_value
[0m11:25:17.004296 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.customer_lifetime_value"
[0m11:25:17.006827 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.customer_lifetime_value
[0m11:25:17.012604 [debug] [Thread-1  ]: Setting query_band
[0m11:25:17.015864 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer_lifetime_value"
[0m11:25:17.016645 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer_lifetime_value"} */

      CREATE  TABLE
      "demo_user"."customer_lifetime_value"
      AS (
            



select
    orders.customer_key,
    --Full load: compute the historical customer value history    
    sum(sum(amount_usd)) over(partition by orders.customer_key order by order_date ROWS UNBOUNDED PRECEDING) total_amount_usd,
    period(
        order_date, 
        coalesce(lead(order_date) over(partition by orders.customer_key order by order_date) , ('9999-12-31' (date)))
        ) valid_period

from "demo_user"."lim_payments" payments
left join  "demo_user"."lim_orders" orders on payments.order_id = orders.order_id


group by orders.customer_key, order_date

        ) WITH NO DATA
      
      ;
    
[0m11:25:17.017362 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:25:17.726059 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:17.726943 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:17.792470 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1065] [Teradata Database] [Error 3810] Column/Parameter 'demo_user.orders.order_id' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:25:17.796288 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer_lifetime_value: Close
[0m11:25:17.881535 [debug] [Thread-1  ]: Database Error in model customer_lifetime_value (models/core/customer_lifetime_value.sql)
  [Version 20.0.0.15] [Session 1065] [Teradata Database] [Error 3810] Column/Parameter 'demo_user.orders.order_id' does not exist.
   at gosqldriver/teradatasql.formatError ErrorUtil.go:91
   at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
   at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
   at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
   at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
   at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
   at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
   at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
   at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
   at database/sql.ctxDriverQuery ctxutil.go:48
   at database/sql.(*DB).queryDC.func1 sql.go:1776
   at database/sql.withLock sql.go:3530
   at database/sql.(*DB).queryDC sql.go:1771
   at database/sql.(*Conn).QueryContext sql.go:2027
   at main.createRows goside.go:783
   at main.goCreateRows goside.go:662
   at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
   at runtime.cgocallbackg1 cgocall.go:420
   at runtime.cgocallbackg cgocall.go:339
   at runtime.cgocallback asm_amd64.s:1079
   at runtime.goexit asm_amd64.s:1695
[0m11:25:17.886356 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafa365eb0>]}
[0m11:25:17.887204 [error] [Thread-1  ]: 15 of 19 ERROR creating sql incremental model demo_user.customer_lifetime_value  [[31mERROR[0m in 0.90s]
[0m11:25:17.887905 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.customer_lifetime_value
[0m11:25:17.888377 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.dim_payment_method
[0m11:25:17.889130 [info ] [Thread-1  ]: 16 of 19 START sql view model demo_user.dim_payment_method ..................... [RUN]
[0m11:25:17.889641 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.customer_lifetime_value, now model.jaffle_shop_teradata.dim_payment_method)
[0m11:25:17.890015 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.dim_payment_method
[0m11:25:17.893896 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.dim_payment_method"
[0m11:25:17.902017 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.dim_payment_method
[0m11:25:17.904753 [debug] [Thread-1  ]: Setting query_band
[0m11:25:17.906926 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.dim_payment_method"
[0m11:25:17.918976 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_payment_method"
[0m11:25:17.919705 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_payment_method"} */

  

  
  REPLACE VIEW "demo_user"."dim_payment_method__dbt_tmp" AS
    with payments as (

    select * from "demo_user"."lim_payments"

),

final as (

    select
        payment_method
        ,sum(amount_usd) as total_amount
        ,count(1) as frequency_count
    from payments
    group by 1

)

select * from final


[0m11:25:17.920370 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:25:18.710218 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:18.717109 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:18.952044 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 1.031 seconds
[0m11:25:18.970149 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_payment_method"
[0m11:25:18.971399 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_payment_method"} */

    DROP view /*+ IF EXISTS */ "demo_user"."dim_payment_method__dbt_backup";
  
[0m11:25:19.017721 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1066] [Teradata Database] [Error 3807] Object 'demo_user.dim_payment_method__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:25:19.025075 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_payment_method"
[0m11:25:19.026421 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_payment_method"} */

    RENAME view "demo_user"."dim_payment_method" TO "demo_user"."dim_payment_method__dbt_backup"
  
[0m11:25:19.221348 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.193 seconds
[0m11:25:19.240023 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_payment_method"
[0m11:25:19.240770 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_payment_method"} */

    DROP view /*+ IF EXISTS */ "demo_user"."dim_payment_method";
  
[0m11:25:19.288526 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1066] [Teradata Database] [Error 3807] Object 'demo_user.dim_payment_method' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:25:19.295340 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_payment_method"
[0m11:25:19.296835 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_payment_method"} */

    RENAME view "demo_user"."dim_payment_method__dbt_tmp" TO "demo_user"."dim_payment_method"
  
[0m11:25:19.491560 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.193 seconds
[0m11:25:19.509549 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_payment_method"
[0m11:25:19.510915 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_payment_method"} */
DROP view /*+ IF EXISTS */ "demo_user"."dim_payment_method__dbt_backup";
[0m11:25:19.724646 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 9 in 0.212 seconds
[0m11:25:19.734161 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: Close
[0m11:25:19.797924 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafa365eb0>]}
[0m11:25:19.803382 [info ] [Thread-1  ]: 16 of 19 OK created sql view model demo_user.dim_payment_method ................ [[32mactivity: Create View, rows_affected: 0[0m in 1.91s]
[0m11:25:19.807620 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.dim_payment_method
[0m11:25:19.809844 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.order_payments
[0m11:25:19.811849 [info ] [Thread-1  ]: 17 of 19 START sql view model demo_user.order_payments ......................... [RUN]
[0m11:25:19.813550 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.dim_payment_method, now model.jaffle_shop_teradata.order_payments)
[0m11:25:19.814662 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.order_payments
[0m11:25:19.827998 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.order_payments"
[0m11:25:19.840976 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.order_payments
[0m11:25:19.846651 [debug] [Thread-1  ]: Setting query_band
[0m11:25:19.850413 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.order_payments"
[0m11:25:19.863429 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.order_payments"
[0m11:25:19.864389 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.order_payments"} */

  

  
  REPLACE VIEW "demo_user"."order_payments__dbt_tmp" AS
    

with payments as (

    select * from "demo_user"."lim_payments"

),

final as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount_usd else 0 end) as credit_card_amount_usd,
        sum(case when payment_method = 'coupon' then amount_usd else 0 end) as coupon_amount_usd,
        sum(case when payment_method = 'bank_transfer' then amount_usd else 0 end) as bank_transfer_amount_usd,
        sum(case when payment_method = 'gift_card' then amount_usd else 0 end) as gift_card_amount_usd,
        sum(amount_usd) as total_amount_usd

    from payments

    group by 1

)

select * from final


[0m11:25:19.865308 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:25:20.567285 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:20.571703 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:20.934907 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 1.068 seconds
[0m11:25:20.956143 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.order_payments"
[0m11:25:20.957637 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.order_payments"} */

    DROP view /*+ IF EXISTS */ "demo_user"."order_payments__dbt_backup";
  
[0m11:25:21.002843 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1067] [Teradata Database] [Error 3807] Object 'demo_user.order_payments__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:25:21.010461 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.order_payments"
[0m11:25:21.012350 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.order_payments"} */

    RENAME view "demo_user"."order_payments" TO "demo_user"."order_payments__dbt_backup"
  
[0m11:25:21.227575 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.211 seconds
[0m11:25:21.246883 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.order_payments"
[0m11:25:21.247857 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.order_payments"} */

    DROP view /*+ IF EXISTS */ "demo_user"."order_payments";
  
[0m11:25:21.295901 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1067] [Teradata Database] [Error 3807] Object 'demo_user.order_payments' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:25:21.303823 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.order_payments"
[0m11:25:21.305435 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.order_payments"} */

    RENAME view "demo_user"."order_payments__dbt_tmp" TO "demo_user"."order_payments"
  
[0m11:25:21.518510 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.212 seconds
[0m11:25:21.532314 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.order_payments"
[0m11:25:21.533587 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.order_payments"} */
DROP view /*+ IF EXISTS */ "demo_user"."order_payments__dbt_backup";
[0m11:25:21.770019 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 12 in 0.235 seconds
[0m11:25:21.778565 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: Close
[0m11:25:21.849058 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafa352a90>]}
[0m11:25:21.852675 [info ] [Thread-1  ]: 17 of 19 OK created sql view model demo_user.order_payments .................... [[32mactivity: Create View, rows_affected: 0[0m in 2.04s]
[0m11:25:21.854940 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.order_payments
[0m11:25:21.857014 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.dim_customers
[0m11:25:21.858912 [info ] [Thread-1  ]: 18 of 19 SKIP relation demo_user.dim_customers ................................. [[33mSKIP[0m]
[0m11:25:21.860316 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.dim_customers
[0m11:25:21.861586 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.fct_orders
[0m11:25:21.863433 [info ] [Thread-1  ]: 19 of 19 START sql view model demo_user.fct_orders ............................. [RUN]
[0m11:25:21.865095 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.order_payments, now model.jaffle_shop_teradata.fct_orders)
[0m11:25:21.865803 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.fct_orders
[0m11:25:21.873626 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.fct_orders"
[0m11:25:21.875998 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.fct_orders
[0m11:25:21.880011 [debug] [Thread-1  ]: Setting query_band
[0m11:25:21.882902 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.fct_orders"
[0m11:25:21.884447 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.fct_orders"
[0m11:25:21.884974 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.fct_orders"} */

  

  
  REPLACE VIEW "demo_user"."fct_orders__dbt_tmp" AS
    

with orders as (

    select * from "demo_user"."lim_orders"

),

order_payments as (

    select * from "demo_user"."order_payments"

),

final as (

    select
        orders.customer_key,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount_usd,

        order_payments.coupon_amount_usd,

        order_payments.bank_transfer_amount_usd,

        order_payments.gift_card_amount_usd,

        order_payments.total_amount_usd as amount

    from orders

    left join order_payments on orders.order_id = order_payments.order_id

)

select * from final


[0m11:25:21.885447 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:25:22.562225 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:22.565799 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:25:22.614344 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1068] [Teradata Database] [Error 3810] Column/Parameter 'orders.order_id' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:25:22.618150 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.fct_orders: Close
[0m11:25:22.693129 [debug] [Thread-1  ]: Database Error in model fct_orders (models/consumption/fct_orders.sql)
  [Version 20.0.0.15] [Session 1068] [Teradata Database] [Error 3810] Column/Parameter 'orders.order_id' does not exist.
   at gosqldriver/teradatasql.formatError ErrorUtil.go:91
   at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
   at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
   at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
   at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
   at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
   at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
   at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
   at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
   at database/sql.ctxDriverQuery ctxutil.go:48
   at database/sql.(*DB).queryDC.func1 sql.go:1776
   at database/sql.withLock sql.go:3530
   at database/sql.(*DB).queryDC sql.go:1771
   at database/sql.(*Conn).QueryContext sql.go:2027
   at main.createRows goside.go:783
   at main.goCreateRows goside.go:662
   at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
   at runtime.cgocallbackg1 cgocall.go:420
   at runtime.cgocallbackg cgocall.go:339
   at runtime.cgocallback asm_amd64.s:1079
   at runtime.goexit asm_amd64.s:1695
  compiled Code at target/run/jaffle_shop_teradata/models/consumption/fct_orders.sql
[0m11:25:22.697642 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2beb4589-7cd7-4d72-a1d6-de6e9299f4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafa008dc0>]}
[0m11:25:22.702982 [error] [Thread-1  ]: 19 of 19 ERROR creating sql view model demo_user.fct_orders .................... [[31mERROR[0m in 0.83s]
[0m11:25:22.706913 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.fct_orders
[0m11:25:22.709886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:25:22.710697 [debug] [MainThread]: Connection 'model.jaffle_shop_teradata.fct_orders' was properly closed.
[0m11:25:22.711747 [info ] [MainThread]: 
[0m11:25:22.712541 [info ] [MainThread]: Finished running 7 incremental models, 12 view models in 0 hours 0 minutes and 51.20 seconds (51.20s).
[0m11:25:22.718856 [debug] [MainThread]: Command end result
[0m11:25:22.825648 [info ] [MainThread]: 
[0m11:25:22.826187 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:25:22.826454 [info ] [MainThread]: 
[0m11:25:22.826849 [error] [MainThread]:   Database Error in model test (models/test.sql)
  [Version 20.0.0.15] [Session 1059] [Teradata Database] [Error 3707] Syntax error, expected something like a 'SELECT' keyword or a 'LOCK' keyword or '(' or a 'TRANSACTIONTIME' keyword between the 'AS' keyword and the 'insert' keyword.
   at gosqldriver/teradatasql.formatError ErrorUtil.go:91
   at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
   at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
   at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
   at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
   at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
   at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
   at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
   at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
   at database/sql.ctxDriverQuery ctxutil.go:48
   at database/sql.(*DB).queryDC.func1 sql.go:1776
   at database/sql.withLock sql.go:3530
   at database/sql.(*DB).queryDC sql.go:1771
   at database/sql.(*Conn).QueryContext sql.go:2027
   at main.createRows goside.go:783
   at main.goCreateRows goside.go:662
   at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
   at runtime.cgocallbackg1 cgocall.go:420
   at runtime.cgocallbackg cgocall.go:339
   at runtime.cgocallback asm_amd64.s:1079
   at runtime.goexit asm_amd64.s:1695
  compiled Code at target/run/jaffle_shop_teradata/models/test.sql
[0m11:25:22.827246 [info ] [MainThread]: 
[0m11:25:22.827640 [error] [MainThread]:   Database Error in model customer_lifetime_value (models/core/customer_lifetime_value.sql)
  [Version 20.0.0.15] [Session 1065] [Teradata Database] [Error 3810] Column/Parameter 'demo_user.orders.order_id' does not exist.
   at gosqldriver/teradatasql.formatError ErrorUtil.go:91
   at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
   at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
   at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
   at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
   at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
   at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
   at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
   at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
   at database/sql.ctxDriverQuery ctxutil.go:48
   at database/sql.(*DB).queryDC.func1 sql.go:1776
   at database/sql.withLock sql.go:3530
   at database/sql.(*DB).queryDC sql.go:1771
   at database/sql.(*Conn).QueryContext sql.go:2027
   at main.createRows goside.go:783
   at main.goCreateRows goside.go:662
   at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
   at runtime.cgocallbackg1 cgocall.go:420
   at runtime.cgocallbackg cgocall.go:339
   at runtime.cgocallback asm_amd64.s:1079
   at runtime.goexit asm_amd64.s:1695
[0m11:25:22.827952 [info ] [MainThread]: 
[0m11:25:22.828297 [error] [MainThread]:   Database Error in model fct_orders (models/consumption/fct_orders.sql)
  [Version 20.0.0.15] [Session 1068] [Teradata Database] [Error 3810] Column/Parameter 'orders.order_id' does not exist.
   at gosqldriver/teradatasql.formatError ErrorUtil.go:91
   at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
   at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
   at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
   at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
   at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
   at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
   at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
   at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
   at database/sql.ctxDriverQuery ctxutil.go:48
   at database/sql.(*DB).queryDC.func1 sql.go:1776
   at database/sql.withLock sql.go:3530
   at database/sql.(*DB).queryDC sql.go:1771
   at database/sql.(*Conn).QueryContext sql.go:2027
   at main.createRows goside.go:783
   at main.goCreateRows goside.go:662
   at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
   at runtime.cgocallbackg1 cgocall.go:420
   at runtime.cgocallbackg cgocall.go:339
   at runtime.cgocallback asm_amd64.s:1079
   at runtime.goexit asm_amd64.s:1695
  compiled Code at target/run/jaffle_shop_teradata/models/consumption/fct_orders.sql
[0m11:25:22.828625 [info ] [MainThread]: 
[0m11:25:22.828888 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=3 SKIP=1 TOTAL=19
[0m11:25:22.837204 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 53.71932, "process_user_time": 5.905638, "process_kernel_time": 1.19498, "process_mem_max_rss": "129605632", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:25:22.837702 [debug] [MainThread]: Command `dbt run` failed at 11:25:22.837624 after 53.72 seconds
[0m11:25:22.838048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae825e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf8ab5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafa479880>]}
[0m11:25:22.838366 [debug] [MainThread]: Flushing usage events
[0m11:29:47.041462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad11742e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad2cf5eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad2cf5be0>]}


============================== 11:29:47.047195 | b5666e7b-765d-4326-990c-d68857408f2d ==============================
[0m11:29:47.047195 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:29:47.047715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/remi.turpaud/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:29:47.334627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad0ffddc0>]}
[0m11:29:47.372919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad286d280>]}
[0m11:29:47.375113 [info ] [MainThread]: Registered adapter: teradata=1.8.0
[0m11:29:47.404979 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:29:47.639917 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:29:47.640371 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:29:47.646338 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.staging
- models.jaffle_shop
[0m11:29:47.704380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9009d130>]}
[0m11:29:47.853489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad3593190>]}
[0m11:29:47.854072 [info ] [MainThread]: Found 18 models, 1 snapshot, 3 seeds, 8 data tests, 1 source, 573 macros
[0m11:29:47.854401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad31d71f0>]}
[0m11:29:47.856393 [info ] [MainThread]: 
[0m11:29:47.856921 [debug] [MainThread]: Acquiring new teradata connection 'master'
[0m11:29:47.862513 [debug] [ThreadPool]: Acquiring new teradata connection 'list_schemas'
[0m11:29:47.873425 [debug] [ThreadPool]: Using teradata connection "list_schemas"
[0m11:29:47.873725 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_schemas"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
[0m11:29:47.873975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:48.723855 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:29:48.726566 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:29:48.878447 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 46 in 1.002 seconds
[0m11:29:48.886841 [debug] [ThreadPool]: On list_schemas: Close
[0m11:29:48.959983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_schemas, now list_None_demo_user)
[0m11:29:48.970325 [debug] [ThreadPool]: Using teradata connection "list_None_demo_user"
[0m11:29:48.970895 [debug] [ThreadPool]: On list_None_demo_user: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_None_demo_user"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
[0m11:29:48.971408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:29:49.691036 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:29:49.693703 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:29:49.887073 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 19 in 0.914 seconds
[0m11:29:49.893244 [debug] [ThreadPool]: On list_None_demo_user: Close
[0m11:29:49.970665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None_demo_user, now list_None_rt186001)
[0m11:29:49.982678 [debug] [ThreadPool]: Using teradata connection "list_None_rt186001"
[0m11:29:49.983440 [debug] [ThreadPool]: On list_None_rt186001: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_None_rt186001"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'rt186001' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
[0m11:29:49.984052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:29:51.019028 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:29:51.020491 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:29:51.212239 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 0 in 1.228 seconds
[0m11:29:51.217186 [debug] [ThreadPool]: On list_None_rt186001: Close
[0m11:29:51.282657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad1512670>]}
[0m11:29:51.284273 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:29:51.285076 [info ] [MainThread]: 
[0m11:29:51.294244 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.key_customer
[0m11:29:51.295328 [info ] [Thread-1  ]: 1 of 18 START sql incremental model demo_user.key_customer ..................... [RUN]
[0m11:29:51.296197 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_None_rt186001, now model.jaffle_shop_teradata.key_customer)
[0m11:29:51.296886 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.key_customer
[0m11:29:51.314061 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.key_customer"
[0m11:29:51.317866 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.key_customer
[0m11:29:51.344204 [debug] [Thread-1  ]: Setting query_band
[0m11:29:51.363824 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.key_customer"
[0m11:29:51.364161 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.key_customer"} */
DROP table /*+ IF EXISTS */ "demo_user"."key_customer__dbt_backup";
[0m11:29:51.364448 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:29:52.055498 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:29:52.058213 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:29:52.126663 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1074] [Teradata Database] [Error 3807] Object 'demo_user.key_customer__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:29:52.137111 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.key_customer"
[0m11:29:52.137677 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.key_customer"} */

    DROP table /*+ IF EXISTS */ "demo_user"."key_customer__dbt_backup";
  
[0m11:29:52.181049 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1074] [Teradata Database] [Error 3807] Object 'demo_user.key_customer__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:29:52.185722 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.key_customer"
[0m11:29:52.186868 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.key_customer"} */

    RENAME table "demo_user"."key_customer" TO "demo_user"."key_customer__dbt_backup"
  
[0m11:29:52.505759 [debug] [Thread-1  ]: SQL status: activity: Rename Table, rows_affected: 2 in 0.317 seconds
[0m11:29:52.531016 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.key_customer"
[0m11:29:52.531812 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.key_customer"} */

      CREATE  TABLE
      "demo_user"."key_customer"
      AS (
            



--Create the surrogate key table with default members if it doesn't exist
select
    -1 (integer) customer_key
    ,'UNKNOWN' (varchar(10000)) customer_nk
    ,'' (char(100)) domain_cd
    ,current_timestamp created_ts
from (sel 1 a) dummy
        ) WITH NO DATA
      
      ;
    
[0m11:29:52.910505 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.377 seconds
[0m11:29:52.912635 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.key_customer"
[0m11:29:52.933374 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.key_customer"
[0m11:29:52.935293 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.key_customer"} */

   
  
    
    

    INSERT INTO "demo_user"."key_customer"
          



--Create the surrogate key table with default members if it doesn't exist
select
    -1 (integer) customer_key
    ,'UNKNOWN' (varchar(10000)) customer_nk
    ,'' (char(100)) domain_cd
    ,current_timestamp created_ts
from (sel 1 a) dummy
    ;
  

  

[0m11:29:53.089447 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 1 in 0.152 seconds
[0m11:29:53.120314 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.key_customer"
[0m11:29:53.120913 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.key_customer"} */
DROP table /*+ IF EXISTS */ "demo_user"."key_customer__dbt_backup";
[0m11:29:53.439765 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 17 in 0.317 seconds
[0m11:29:53.447281 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: Close
[0m11:29:53.516399 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae048bfa0>]}
[0m11:29:53.518190 [info ] [Thread-1  ]: 1 of 18 OK created sql incremental model demo_user.key_customer ................ [[32mactivity: Insert, rows_affected: 1[0m in 2.22s]
[0m11:29:53.519679 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.key_customer
[0m11:29:53.520649 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_market_customers
[0m11:29:53.521921 [info ] [Thread-1  ]: 2 of 18 START sql view model demo_user.lim_market_customers .................... [RUN]
[0m11:29:53.522824 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.key_customer, now model.jaffle_shop_teradata.lim_market_customers)
[0m11:29:53.523501 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_market_customers
[0m11:29:53.588104 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_market_customers"
[0m11:29:53.592512 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_market_customers
[0m11:29:53.595728 [debug] [Thread-1  ]: Setting query_band
[0m11:29:53.612939 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:29:53.613268 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    drop table demo_user.raw_market_customers;
  
[0m11:29:53.613536 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:29:54.329392 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:29:54.333328 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:29:54.672475 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 24 in 1.058 seconds
[0m11:29:54.677803 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:29:54.678844 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    create foreign table demo_user.raw_market_customers using (location('/GS/storage.googleapis.com/clearscape_analytics_demo_data/DEMO_Market/Customer/'));
  
[0m11:30:01.266541 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 6.587 seconds
[0m11:30:01.274971 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.lim_market_customers"
[0m11:30:01.284217 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:30:01.284719 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

  

  
  REPLACE VIEW "demo_user"."lim_market_customers__dbt_tmp" AS
    /*
  Build a light integrated modeled layer from source image 
  for entity `market_customers`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
*/

select
spend,
nearby5,
nearby10,
new ST_GEOMETRY(ptLocWkt) location_pt
from "demo_user"."raw_market_customers" s


[0m11:30:01.581520 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 0.296 seconds
[0m11:30:01.590382 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:30:01.591147 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    DROP view /*+ IF EXISTS */ "demo_user"."lim_market_customers__dbt_backup";
  
[0m11:30:01.636114 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1075] [Teradata Database] [Error 3807] Object 'demo_user.lim_market_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:01.640529 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:30:01.641622 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    RENAME view "demo_user"."lim_market_customers" TO "demo_user"."lim_market_customers__dbt_backup"
  
[0m11:30:01.943121 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.300 seconds
[0m11:30:01.951164 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:30:01.951864 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    DROP view /*+ IF EXISTS */ "demo_user"."lim_market_customers";
  
[0m11:30:01.998184 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1075] [Teradata Database] [Error 3807] Object 'demo_user.lim_market_customers' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:02.001703 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:30:02.002675 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    RENAME view "demo_user"."lim_market_customers__dbt_tmp" TO "demo_user"."lim_market_customers"
  
[0m11:30:02.363350 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.359 seconds
[0m11:30:02.381794 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:30:02.382658 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */
DROP view /*+ IF EXISTS */ "demo_user"."lim_market_customers__dbt_backup";
[0m11:30:02.721707 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 10 in 0.338 seconds
[0m11:30:02.727804 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: Close
[0m11:30:02.852470 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad360ba60>]}
[0m11:30:02.855679 [info ] [Thread-1  ]: 2 of 18 OK created sql view model demo_user.lim_market_customers ............... [[32mactivity: Create View, rows_affected: 0[0m in 9.33s]
[0m11:30:02.857520 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_market_customers
[0m11:30:02.858688 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.stg_customers
[0m11:30:02.860018 [info ] [Thread-1  ]: 3 of 18 START sql view model demo_user.stg_customers ........................... [RUN]
[0m11:30:02.861020 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.lim_market_customers, now model.jaffle_shop_teradata.stg_customers)
[0m11:30:02.861729 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.stg_customers
[0m11:30:02.869589 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.stg_customers"
[0m11:30:02.886811 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.stg_customers
[0m11:30:02.891405 [debug] [Thread-1  ]: Setting query_band
[0m11:30:02.894668 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.stg_customers"
[0m11:30:02.913379 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_customers"
[0m11:30:02.914157 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_customers"} */

  

  
  REPLACE VIEW "demo_user"."stg_customers__dbt_tmp" AS
    locking row for access
select
    id as customer_id,
    first_name (varchar(1000)),
    last_name (varchar(1000)),
    email (varchar(1000)),
    current_timestamp last_update_ts
from "demo_user"."raw_customers" source


[0m11:30:02.914682 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:30:03.687038 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:03.689683 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:03.984420 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 1.069 seconds
[0m11:30:03.998347 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_customers"
[0m11:30:03.999643 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_customers"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_customers__dbt_backup";
  
[0m11:30:04.067318 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1076] [Teradata Database] [Error 3807] Object 'demo_user.stg_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:04.075124 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_customers"
[0m11:30:04.076953 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_customers"} */

    RENAME view "demo_user"."stg_customers" TO "demo_user"."stg_customers__dbt_backup"
  
[0m11:30:04.266412 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.188 seconds
[0m11:30:04.281192 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_customers"
[0m11:30:04.282932 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_customers"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_customers";
  
[0m11:30:04.327427 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1076] [Teradata Database] [Error 3807] Object 'demo_user.stg_customers' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:04.334171 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_customers"
[0m11:30:04.335920 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_customers"} */

    RENAME view "demo_user"."stg_customers__dbt_tmp" TO "demo_user"."stg_customers"
  
[0m11:30:04.527617 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.190 seconds
[0m11:30:04.544804 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_customers"
[0m11:30:04.546258 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_customers"} */
DROP view /*+ IF EXISTS */ "demo_user"."stg_customers__dbt_backup";
[0m11:30:04.760114 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 11 in 0.212 seconds
[0m11:30:04.767030 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: Close
[0m11:30:04.842404 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad2cb1a00>]}
[0m11:30:04.844899 [info ] [Thread-1  ]: 3 of 18 OK created sql view model demo_user.stg_customers ...................... [[32mactivity: Create View, rows_affected: 0[0m in 1.98s]
[0m11:30:04.848473 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.stg_customers
[0m11:30:04.850370 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.stg_market_customers
[0m11:30:04.852846 [info ] [Thread-1  ]: 4 of 18 START sql view model demo_user.stg_market_customers .................... [RUN]
[0m11:30:04.858389 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.stg_customers, now model.jaffle_shop_teradata.stg_market_customers)
[0m11:30:04.859649 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.stg_market_customers
[0m11:30:04.867956 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.stg_market_customers"
[0m11:30:04.897057 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.stg_market_customers
[0m11:30:04.903975 [debug] [Thread-1  ]: Setting query_band
[0m11:30:04.910210 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m11:30:04.910796 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */

    drop table demo_user.raw_market_customers;
  
[0m11:30:04.911299 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:30:05.625451 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:05.628732 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:05.949810 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 24 in 1.038 seconds
[0m11:30:05.956598 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m11:30:05.957910 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */

    create foreign table demo_user.raw_market_customers using (location('/GS/storage.googleapis.com/clearscape_analytics_demo_data/DEMO_Market/Customer/'));
  
[0m11:30:11.466154 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 5.506 seconds
[0m11:30:11.476988 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.stg_market_customers"
[0m11:30:11.488922 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m11:30:11.491373 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */

  

  
  REPLACE VIEW "demo_user"."stg_market_customers__dbt_tmp" AS
    



with source as (
    select * from "demo_user"."raw_market_customers"

),

renamed as 
(
    select
    source.*
    from source

)

select * from renamed


[0m11:30:12.019647 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 0.526 seconds
[0m11:30:12.039696 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m11:30:12.041028 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_market_customers__dbt_backup";
  
[0m11:30:12.086256 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1077] [Teradata Database] [Error 3807] Object 'demo_user.stg_market_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:12.090392 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m11:30:12.091454 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */

    RENAME view "demo_user"."stg_market_customers" TO "demo_user"."stg_market_customers__dbt_backup"
  
[0m11:30:12.346383 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.253 seconds
[0m11:30:12.367498 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m11:30:12.368902 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_market_customers";
  
[0m11:30:12.413183 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1077] [Teradata Database] [Error 3807] Object 'demo_user.stg_market_customers' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:12.416843 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m11:30:12.418468 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */

    RENAME view "demo_user"."stg_market_customers__dbt_tmp" TO "demo_user"."stg_market_customers"
  
[0m11:30:12.608567 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.188 seconds
[0m11:30:12.628057 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m11:30:12.629748 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */
DROP view /*+ IF EXISTS */ "demo_user"."stg_market_customers__dbt_backup";
[0m11:30:12.927770 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 12 in 0.296 seconds
[0m11:30:12.937584 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: Close
[0m11:30:13.009895 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad2cb1cd0>]}
[0m11:30:13.013862 [info ] [Thread-1  ]: 4 of 18 OK created sql view model demo_user.stg_market_customers ............... [[32mactivity: Create View, rows_affected: 0[0m in 8.15s]
[0m11:30:13.016944 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.stg_market_customers
[0m11:30:13.018796 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.stg_orders
[0m11:30:13.020834 [info ] [Thread-1  ]: 5 of 18 START sql view model demo_user.stg_orders .............................. [RUN]
[0m11:30:13.022238 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.stg_market_customers, now model.jaffle_shop_teradata.stg_orders)
[0m11:30:13.023413 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.stg_orders
[0m11:30:13.034193 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.stg_orders"
[0m11:30:13.049910 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.stg_orders
[0m11:30:13.059185 [debug] [Thread-1  ]: Setting query_band
[0m11:30:13.063336 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.stg_orders"
[0m11:30:13.069897 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_orders"
[0m11:30:13.070657 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_orders"} */

  

  
  REPLACE VIEW "demo_user"."stg_orders__dbt_tmp" AS
    locking row for access
select
    source.*,
    current_timestamp last_update_ts
from "demo_user"."raw_orders" source


[0m11:30:13.071330 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:30:13.792025 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:13.795279 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:14.074145 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 1.002 seconds
[0m11:30:14.093996 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_orders"
[0m11:30:14.095025 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_orders"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_orders__dbt_backup";
  
[0m11:30:14.162628 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1078] [Teradata Database] [Error 3807] Object 'demo_user.stg_orders__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:14.170875 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_orders"
[0m11:30:14.173706 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_orders"} */

    RENAME view "demo_user"."stg_orders" TO "demo_user"."stg_orders__dbt_backup"
  
[0m11:30:14.367469 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.191 seconds
[0m11:30:14.382127 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_orders"
[0m11:30:14.383678 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_orders"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_orders";
  
[0m11:30:14.428336 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1078] [Teradata Database] [Error 3807] Object 'demo_user.stg_orders' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:14.432680 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_orders"
[0m11:30:14.434027 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_orders"} */

    RENAME view "demo_user"."stg_orders__dbt_tmp" TO "demo_user"."stg_orders"
  
[0m11:30:14.649046 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.212 seconds
[0m11:30:14.668909 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_orders"
[0m11:30:14.670122 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_orders"} */
DROP view /*+ IF EXISTS */ "demo_user"."stg_orders__dbt_backup";
[0m11:30:14.884088 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 11 in 0.212 seconds
[0m11:30:14.890679 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: Close
[0m11:30:14.965021 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad366a610>]}
[0m11:30:14.968038 [info ] [Thread-1  ]: 5 of 18 OK created sql view model demo_user.stg_orders ......................... [[32mactivity: Create View, rows_affected: 0[0m in 1.94s]
[0m11:30:14.969938 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.stg_orders
[0m11:30:14.971701 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.stg_payments
[0m11:30:14.973916 [info ] [Thread-1  ]: 6 of 18 START sql view model demo_user.stg_payments ............................ [RUN]
[0m11:30:14.976989 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.stg_orders, now model.jaffle_shop_teradata.stg_payments)
[0m11:30:14.980363 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.stg_payments
[0m11:30:14.995836 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.stg_payments"
[0m11:30:15.010297 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.stg_payments
[0m11:30:15.016438 [debug] [Thread-1  ]: Setting query_band
[0m11:30:15.023293 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.stg_payments"
[0m11:30:15.036865 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_payments"
[0m11:30:15.037610 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_payments"} */

  

  
  REPLACE VIEW "demo_user"."stg_payments__dbt_tmp" AS
    locking row for access
select
source.*
,'2024-09-03 09:29:47.000541+00:00' (timestamp) last_update_ts
from  "demo_user"."raw_payments" source


[0m11:30:15.038279 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:30:15.749982 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:15.752678 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:16.072687 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 1.034 seconds
[0m11:30:16.086396 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_payments"
[0m11:30:16.087997 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_payments"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_payments__dbt_backup";
  
[0m11:30:16.154059 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1079] [Teradata Database] [Error 3807] Object 'demo_user.stg_payments__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:16.160083 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_payments"
[0m11:30:16.161171 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_payments"} */

    RENAME view "demo_user"."stg_payments" TO "demo_user"."stg_payments__dbt_backup"
  
[0m11:30:16.367734 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.205 seconds
[0m11:30:16.382381 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_payments"
[0m11:30:16.383643 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_payments"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_payments";
  
[0m11:30:16.428159 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1079] [Teradata Database] [Error 3807] Object 'demo_user.stg_payments' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:16.434241 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_payments"
[0m11:30:16.436202 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_payments"} */

    RENAME view "demo_user"."stg_payments__dbt_tmp" TO "demo_user"."stg_payments"
  
[0m11:30:16.693474 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.254 seconds
[0m11:30:16.706698 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_payments"
[0m11:30:16.710328 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_payments"} */
DROP view /*+ IF EXISTS */ "demo_user"."stg_payments__dbt_backup";
[0m11:30:16.967407 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 11 in 0.255 seconds
[0m11:30:16.977456 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: Close
[0m11:30:17.043628 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad366a610>]}
[0m11:30:17.046716 [info ] [Thread-1  ]: 6 of 18 OK created sql view model demo_user.stg_payments ....................... [[32mactivity: Create View, rows_affected: 0[0m in 2.07s]
[0m11:30:17.048809 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.stg_payments
[0m11:30:17.050021 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.customer
[0m11:30:17.052335 [info ] [Thread-1  ]: 7 of 18 START sql view model demo_user.customer ................................ [RUN]
[0m11:30:17.053726 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.stg_payments, now model.jaffle_shop_teradata.customer)
[0m11:30:17.054806 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.customer
[0m11:30:17.067284 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.customer"
[0m11:30:17.072979 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.customer
[0m11:30:17.075449 [debug] [Thread-1  ]: Setting query_band
[0m11:30:17.077353 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.customer"
[0m11:30:17.080461 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer"
[0m11:30:17.080859 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer"} */

  

  
  REPLACE VIEW "demo_user"."customer__dbt_tmp" AS
    

locking row for access
select
    customer_key,
    substr(customer_nk,1,3)||'***' email
from "demo_user"."key_customer"
where domain_cd = 'retail'


[0m11:30:17.081156 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:30:17.740024 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:17.741535 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:18.017206 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 0.926 seconds
[0m11:30:18.023608 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer"
[0m11:30:18.024042 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer"} */

    DROP view /*+ IF EXISTS */ "demo_user"."customer__dbt_backup";
  
[0m11:30:18.068122 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1080] [Teradata Database] [Error 3807] Object 'demo_user.customer__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:18.074145 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer"
[0m11:30:18.075469 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer"} */

    RENAME view "demo_user"."customer" TO "demo_user"."customer__dbt_backup"
  
[0m11:30:18.287932 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.210 seconds
[0m11:30:18.300341 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer"
[0m11:30:18.301687 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer"} */

    DROP view /*+ IF EXISTS */ "demo_user"."customer";
  
[0m11:30:18.347968 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1080] [Teradata Database] [Error 3807] Object 'demo_user.customer' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:18.351875 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer"
[0m11:30:18.352891 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer"} */

    RENAME view "demo_user"."customer__dbt_tmp" TO "demo_user"."customer"
  
[0m11:30:18.525464 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.171 seconds
[0m11:30:18.539671 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer"
[0m11:30:18.542424 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer"} */
DROP view /*+ IF EXISTS */ "demo_user"."customer__dbt_backup";
[0m11:30:18.754573 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 8 in 0.211 seconds
[0m11:30:18.760708 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: Close
[0m11:30:18.836744 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a80025310>]}
[0m11:30:18.839733 [info ] [Thread-1  ]: 7 of 18 OK created sql view model demo_user.customer ........................... [[32mactivity: Create View, rows_affected: 0[0m in 1.78s]
[0m11:30:18.841357 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.customer
[0m11:30:18.842962 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.sim_customers
[0m11:30:18.845416 [info ] [Thread-1  ]: 8 of 18 START sql incremental model demo_user.sim_customers .................... [RUN]
[0m11:30:18.847504 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.customer, now model.jaffle_shop_teradata.sim_customers)
[0m11:30:18.848460 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.sim_customers
[0m11:30:18.873269 [debug] [Thread-1  ]: use_qvci set to : false
[0m11:30:18.873893 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m11:30:18.874387 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        WHEN ColumnsV.ColumnType = 'JN' THEN 'JSON'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType in (1, 2) THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'stg_customers' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
[0m11:30:18.874884 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:30:19.527719 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:19.529796 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:19.952147 [debug] [Thread-1  ]: SQL status: activity: Select, rows_affected: 5 in 1.077 seconds
[0m11:30:19.979387 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.sim_customers"
[0m11:30:19.987589 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.sim_customers
[0m11:30:19.993645 [debug] [Thread-1  ]: Setting query_band
[0m11:30:20.001368 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m11:30:20.002125 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */
DROP table /*+ IF EXISTS */ "demo_user"."sim_customers__dbt_backup";
[0m11:30:20.045626 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1081] [Teradata Database] [Error 3807] Object 'demo_user.sim_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:20.053934 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m11:30:20.054846 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */

    DROP table /*+ IF EXISTS */ "demo_user"."sim_customers__dbt_backup";
  
[0m11:30:20.100085 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1081] [Teradata Database] [Error 3807] Object 'demo_user.sim_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:20.106306 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m11:30:20.107481 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */

    RENAME table "demo_user"."sim_customers" TO "demo_user"."sim_customers__dbt_backup"
  
[0m11:30:20.351384 [debug] [Thread-1  ]: SQL status: activity: Rename Table, rows_affected: 3 in 0.240 seconds
[0m11:30:20.360943 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m11:30:20.362967 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */

      CREATE  TABLE
      "demo_user"."sim_customers"
      AS (
            

-- Generic source image build for `customers` entity


select    
    customer_id,    
    first_name,    
    last_name,    
    email
    
,period(last_update_ts, '9999-12-31 23:59:59.999999+00:00' (timestamp)) as valid_period
from "demo_user"."stg_customers" source
 
 
        ) WITH NO DATA
      
      ;
    
[0m11:30:20.666233 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.302 seconds
[0m11:30:20.671046 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.sim_customers"
[0m11:30:20.677579 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m11:30:20.679012 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */

   
  
    
    

    INSERT INTO "demo_user"."sim_customers"
          

-- Generic source image build for `customers` entity


select    
    customer_id,    
    first_name,    
    last_name,    
    email
    
,period(last_update_ts, '9999-12-31 23:59:59.999999+00:00' (timestamp)) as valid_period
from "demo_user"."stg_customers" source
 
 
    ;
  

  

[0m11:30:20.850955 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 100 in 0.171 seconds
[0m11:30:20.873346 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m11:30:20.875496 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */
DROP table /*+ IF EXISTS */ "demo_user"."sim_customers__dbt_backup";
[0m11:30:21.161784 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 19 in 0.284 seconds
[0m11:30:21.168981 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: Close
[0m11:30:21.236985 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae04a3ac0>]}
[0m11:30:21.241409 [info ] [Thread-1  ]: 8 of 18 OK created sql incremental model demo_user.sim_customers ............... [[32mactivity: Insert, rows_affected: 100[0m in 2.39s]
[0m11:30:21.244588 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.sim_customers
[0m11:30:21.246361 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.sim_orders
[0m11:30:21.248689 [info ] [Thread-1  ]: 9 of 18 START sql incremental model demo_user.sim_orders ....................... [RUN]
[0m11:30:21.250162 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.sim_customers, now model.jaffle_shop_teradata.sim_orders)
[0m11:30:21.251271 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.sim_orders
[0m11:30:21.276565 [debug] [Thread-1  ]: use_qvci set to : false
[0m11:30:21.278321 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m11:30:21.279547 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        WHEN ColumnsV.ColumnType = 'JN' THEN 'JSON'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType in (1, 2) THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'stg_orders' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
[0m11:30:21.280707 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:30:22.025615 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:22.027813 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:22.523052 [debug] [Thread-1  ]: SQL status: activity: Select, rows_affected: 5 in 1.241 seconds
[0m11:30:22.534638 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.sim_orders"
[0m11:30:22.550678 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.sim_orders
[0m11:30:22.572651 [debug] [Thread-1  ]: Setting query_band
[0m11:30:22.578962 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m11:30:22.579427 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */
DROP table /*+ IF EXISTS */ "demo_user"."sim_orders__dbt_backup";
[0m11:30:22.622880 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1082] [Teradata Database] [Error 3807] Object 'demo_user.sim_orders__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:22.633344 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m11:30:22.633878 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */

    DROP table /*+ IF EXISTS */ "demo_user"."sim_orders__dbt_backup";
  
[0m11:30:22.676927 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1082] [Teradata Database] [Error 3807] Object 'demo_user.sim_orders__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:22.681621 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m11:30:22.683359 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */

    RENAME table "demo_user"."sim_orders" TO "demo_user"."sim_orders__dbt_backup"
  
[0m11:30:22.951388 [debug] [Thread-1  ]: SQL status: activity: Rename Table, rows_affected: 2 in 0.265 seconds
[0m11:30:22.955559 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m11:30:22.956608 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */

      CREATE  TABLE
      "demo_user"."sim_orders"
      AS (
            

-- Generic source image build for `orders` entity


select    
    id,    
    user_id,    
    order_date,    
    status,    
    last_update_ts
from "demo_user"."stg_orders" source
 
 
        ) WITH NO DATA
      
      ;
    
[0m11:30:23.272194 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.314 seconds
[0m11:30:23.278756 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.sim_orders"
[0m11:30:23.289830 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m11:30:23.293221 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */

   
  
    
    

    INSERT INTO "demo_user"."sim_orders"
          

-- Generic source image build for `orders` entity


select    
    id,    
    user_id,    
    order_date,    
    status,    
    last_update_ts
from "demo_user"."stg_orders" source
 
 
    ;
  

  

[0m11:30:23.447057 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 99 in 0.151 seconds
[0m11:30:23.466433 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m11:30:23.468309 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */
DROP table /*+ IF EXISTS */ "demo_user"."sim_orders__dbt_backup";
[0m11:30:23.786487 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 18 in 0.316 seconds
[0m11:30:23.794210 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: Close
[0m11:30:23.863720 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae04a3ac0>]}
[0m11:30:23.865025 [info ] [Thread-1  ]: 9 of 18 OK created sql incremental model demo_user.sim_orders .................. [[32mactivity: Insert, rows_affected: 99[0m in 2.61s]
[0m11:30:23.865924 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.sim_orders
[0m11:30:23.866540 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.sim_payments
[0m11:30:23.867903 [info ] [Thread-1  ]: 10 of 18 START sql incremental model demo_user.sim_payments .................... [RUN]
[0m11:30:23.869059 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.sim_orders, now model.jaffle_shop_teradata.sim_payments)
[0m11:30:23.869709 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.sim_payments
[0m11:30:23.879725 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.sim_payments"
[0m11:30:23.896561 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.sim_payments
[0m11:30:23.914192 [debug] [Thread-1  ]: Setting query_band
[0m11:30:23.924225 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_payments"
[0m11:30:23.925219 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_payments"} */
DROP table /*+ IF EXISTS */ "demo_user"."sim_payments__dbt_backup";
[0m11:30:23.925757 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:30:24.641797 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:24.642408 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:24.685238 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1083] [Teradata Database] [Error 3807] Object 'demo_user.sim_payments__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:24.688824 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_payments"
[0m11:30:24.689188 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_payments"} */

    DROP table /*+ IF EXISTS */ "demo_user"."sim_payments__dbt_backup";
  
[0m11:30:24.732070 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1083] [Teradata Database] [Error 3807] Object 'demo_user.sim_payments__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:24.733403 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_payments"
[0m11:30:24.733763 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_payments"} */

    RENAME table "demo_user"."sim_payments" TO "demo_user"."sim_payments__dbt_backup"
  
[0m11:30:24.962952 [debug] [Thread-1  ]: SQL status: activity: Rename Table, rows_affected: 2 in 0.228 seconds
[0m11:30:24.966582 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_payments"
[0m11:30:24.967934 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_payments"} */

      CREATE  TABLE
      "demo_user"."sim_payments"
      AS (
            

-- Source image build for `payments` entity

select source.*
from "demo_user"."stg_payments" source
        ) WITH NO DATA
      
      ;
    
[0m11:30:25.271807 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.302 seconds
[0m11:30:25.275890 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.sim_payments"
[0m11:30:25.281909 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_payments"
[0m11:30:25.282560 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_payments"} */

   
  
    
    

    INSERT INTO "demo_user"."sim_payments"
          

-- Source image build for `payments` entity

select source.*
from "demo_user"."stg_payments" source
    ;
  

  

[0m11:30:25.431948 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 113 in 0.148 seconds
[0m11:30:25.442001 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_payments"
[0m11:30:25.442778 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_payments"} */
DROP table /*+ IF EXISTS */ "demo_user"."sim_payments__dbt_backup";
[0m11:30:25.740004 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 18 in 0.295 seconds
[0m11:30:25.746220 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: Close
[0m11:30:25.811628 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad36cb520>]}
[0m11:30:25.814653 [info ] [Thread-1  ]: 10 of 18 OK created sql incremental model demo_user.sim_payments ............... [[32mactivity: Insert, rows_affected: 113[0m in 1.94s]
[0m11:30:25.816188 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.sim_payments
[0m11:30:25.817199 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_customers
[0m11:30:25.818595 [info ] [Thread-1  ]: 11 of 18 START sql incremental model demo_user.lim_customers ................... [RUN]
[0m11:30:25.819637 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.sim_payments, now model.jaffle_shop_teradata.lim_customers)
[0m11:30:25.820429 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_customers
[0m11:30:25.848432 [debug] [Thread-1  ]: use_qvci set to : false
[0m11:30:25.849234 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:30:25.849939 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        WHEN ColumnsV.ColumnType = 'JN' THEN 'JSON'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType in (1, 2) THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'sim_customers' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
[0m11:30:25.850622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:30:26.513372 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:26.517096 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:27.350756 [debug] [Thread-1  ]: SQL status: activity: Select, rows_affected: 5 in 1.500 seconds
[0m11:30:27.368768 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_customers"
[0m11:30:27.372406 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_customers
[0m11:30:27.379265 [debug] [Thread-1  ]: Setting query_band
[0m11:30:27.387020 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:30:27.387630 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

        insert into "demo_user"."key_customer"
    select
        rank() over(partition by domain_cd order by customer_nk) (integer) customer_key 
        ,nk (varchar(10000)) customer_nk
        ,domain_cd (char(100)) domain_cd
        ,current_timestamp created_ts
    from 
    (
        select coalesce(trim(email), '') nk
        , 'retail' domain_cd 
        from "demo_user"."sim_customers"
        group by 1,2
    ) source
    where not exists
    (sel 1 from  "demo_user"."key_customer" k where k.customer_nk=source.nk and k.domain_cd=source.domain_cd )
      
[0m11:30:27.703943 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 100 in 0.316 seconds
[0m11:30:27.709929 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:30:27.711026 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

        insert into "demo_user"."key_customer"
    select
        rank() over(partition by domain_cd order by customer_nk) (integer) customer_key 
        ,nk (varchar(10000)) customer_nk
        ,domain_cd (char(100)) domain_cd
        ,current_timestamp created_ts
    from 
    (
        select coalesce(trim(last_name), '') nk
        , 'families' domain_cd 
        from "demo_user"."sim_customers"
        group by 1,2
    ) source
    where not exists
    (sel 1 from  "demo_user"."key_customer" k where k.customer_nk=source.nk and k.domain_cd=source.domain_cd )
      
[0m11:30:28.070272 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 85 in 0.358 seconds
[0m11:30:28.084083 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:30:28.085487 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */
DROP table /*+ IF EXISTS */ "demo_user"."lim_customers__dbt_backup";
[0m11:30:28.128897 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1084] [Teradata Database] [Error 3807] Object 'demo_user.lim_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:28.139872 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:30:28.141025 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

    DROP table /*+ IF EXISTS */ "demo_user"."lim_customers__dbt_backup";
  
[0m11:30:28.185999 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1084] [Teradata Database] [Error 3807] Object 'demo_user.lim_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:28.190913 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:30:28.197527 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

    RENAME table "demo_user"."lim_customers" TO "demo_user"."lim_customers__dbt_backup"
  
[0m11:30:28.432901 [debug] [Thread-1  ]: SQL status: activity: Rename Table, rows_affected: 3 in 0.233 seconds
[0m11:30:28.439374 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:30:28.441344 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

      CREATE  TABLE
      "demo_user"."lim_customers"
      AS (
            /*
  Build a light integrated modeled layer from source image 
  for entity `customers`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
  - Surrogate key assigment
  - Naming conventions alignment
*/










with source as
(
  select
  s.*
  from "demo_user"."sim_customers" s
  where valid_period contains current_timestamp
)
select
    --Value columns
      customer_id,
      first_name,
      email,
      valid_period
    --Surrogate key columns
    ,coalesce(customer.customer_key,-1) customer_key
    ,coalesce(family.customer_key,-1) family_key
from source s
--Surrogate key joins
left join "demo_user"."key_customer" customer
  on customer.customer_nk=coalesce(trim(email), '')
  and customer.domain_cd='retail'

left join "demo_user"."key_customer" family
  on family.customer_nk=coalesce(trim(last_name), '')
  and family.domain_cd='families'



        ) WITH NO DATA
      
      ;
    
[0m11:30:28.744167 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.300 seconds
[0m11:30:28.752735 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.lim_customers"
[0m11:30:28.762848 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:30:28.764277 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

   
  
    
    

    INSERT INTO "demo_user"."lim_customers"
          /*
  Build a light integrated modeled layer from source image 
  for entity `customers`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
  - Surrogate key assigment
  - Naming conventions alignment
*/










with source as
(
  select
  s.*
  from "demo_user"."sim_customers" s
  where valid_period contains current_timestamp
)
select
    --Value columns
      customer_id,
      first_name,
      email,
      valid_period
    --Surrogate key columns
    ,coalesce(customer.customer_key,-1) customer_key
    ,coalesce(family.customer_key,-1) family_key
from source s
--Surrogate key joins
left join "demo_user"."key_customer" customer
  on customer.customer_nk=coalesce(trim(email), '')
  and customer.domain_cd='retail'

left join "demo_user"."key_customer" family
  on family.customer_nk=coalesce(trim(last_name), '')
  and family.domain_cd='families'



    ;
  

  

[0m11:30:28.984389 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 100 in 0.219 seconds
[0m11:30:28.999081 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:30:29.000488 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */
DROP table /*+ IF EXISTS */ "demo_user"."lim_customers__dbt_backup";
[0m11:30:29.364365 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 20 in 0.362 seconds
[0m11:30:29.370643 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: Close
[0m11:30:29.445609 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae04f90d0>]}
[0m11:30:29.449772 [info ] [Thread-1  ]: 11 of 18 OK created sql incremental model demo_user.lim_customers .............. [[32mactivity: Insert, rows_affected: 100[0m in 3.63s]
[0m11:30:29.452980 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_customers
[0m11:30:29.454507 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_orders
[0m11:30:29.456163 [info ] [Thread-1  ]: 12 of 18 START sql incremental model demo_user.lim_orders ...................... [RUN]
[0m11:30:29.457917 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.lim_customers, now model.jaffle_shop_teradata.lim_orders)
[0m11:30:29.459467 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_orders
[0m11:30:29.473846 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_orders"
[0m11:30:29.476623 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_orders
[0m11:30:29.479269 [debug] [Thread-1  ]: Setting query_band
[0m11:30:29.481463 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_orders"
[0m11:30:29.481792 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_orders"} */

        insert into "demo_user"."key_customer"
    select
        rank() over(partition by domain_cd order by customer_nk) (integer) customer_key 
        ,nk (varchar(10000)) customer_nk
        ,domain_cd (char(100)) domain_cd
        ,current_timestamp created_ts
    from 
    (
        select coalesce(trim(email), '') nk
        , 'retail' domain_cd 
        from "demo_user"."sim_customers"
        group by 1,2
    ) source
    where not exists
    (sel 1 from  "demo_user"."key_customer" k where k.customer_nk=source.nk and k.domain_cd=source.domain_cd )
      
[0m11:30:29.482083 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:30:30.139706 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:30.142571 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:30.445042 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 0 in 0.963 seconds
[0m11:30:30.465115 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_orders"
[0m11:30:30.466747 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_orders"} */
DROP table /*+ IF EXISTS */ "demo_user"."lim_orders__dbt_backup";
[0m11:30:30.512373 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1085] [Teradata Database] [Error 3807] Object 'demo_user.lim_orders__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:30.528322 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_orders"
[0m11:30:30.530452 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_orders"} */

    DROP table /*+ IF EXISTS */ "demo_user"."lim_orders__dbt_backup";
  
[0m11:30:30.578548 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1085] [Teradata Database] [Error 3807] Object 'demo_user.lim_orders__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:30.587244 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_orders"
[0m11:30:30.588663 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_orders"} */

    RENAME table "demo_user"."lim_orders" TO "demo_user"."lim_orders__dbt_backup"
  
[0m11:30:30.814815 [debug] [Thread-1  ]: SQL status: activity: Rename Table, rows_affected: 2 in 0.223 seconds
[0m11:30:30.823317 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_orders"
[0m11:30:30.825322 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_orders"} */

      CREATE  TABLE
      "demo_user"."lim_orders"
      AS (
            /*
  Build a light integrated modeled layer from source image 
  for entity `orders`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
  - Surrogate key assigment
  - Naming conventions alignment
*/

with source as
(
  select
  s.*  
  ,coalesce(c.email,'UNKNOWN') email
  from "demo_user"."sim_orders" s
  left join "demo_user"."sim_customers" c
    on c.customer_id=s.user_id
    and c.valid_period contains current_timestamp
)
select
    s.*
    --Surrogate key columns
    ,coalesce(customer.customer_key,-1) customer_key
from source s
--Surrogate key joins
left join "demo_user"."key_customer" customer
  on customer.customer_nk=coalesce(trim(email), '')
  and customer.domain_cd='retail'

        ) WITH NO DATA
      
      ;
    
[0m11:30:31.251803 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.425 seconds
[0m11:30:31.257422 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.lim_orders"
[0m11:30:31.269377 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_orders"
[0m11:30:31.271675 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_orders"} */

   
  
    
    

    INSERT INTO "demo_user"."lim_orders"
          /*
  Build a light integrated modeled layer from source image 
  for entity `orders`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
  - Surrogate key assigment
  - Naming conventions alignment
*/

with source as
(
  select
  s.*  
  ,coalesce(c.email,'UNKNOWN') email
  from "demo_user"."sim_orders" s
  left join "demo_user"."sim_customers" c
    on c.customer_id=s.user_id
    and c.valid_period contains current_timestamp
)
select
    s.*
    --Surrogate key columns
    ,coalesce(customer.customer_key,-1) customer_key
from source s
--Surrogate key joins
left join "demo_user"."key_customer" customer
  on customer.customer_nk=coalesce(trim(email), '')
  and customer.domain_cd='retail'

    ;
  

  

[0m11:30:31.528316 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 99 in 0.254 seconds
[0m11:30:31.548649 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_orders"
[0m11:30:31.549901 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_orders"} */
DROP table /*+ IF EXISTS */ "demo_user"."lim_orders__dbt_backup";
[0m11:30:31.889743 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 20 in 0.338 seconds
[0m11:30:31.898043 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: Close
[0m11:30:31.967227 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae0407c70>]}
[0m11:30:31.971688 [info ] [Thread-1  ]: 12 of 18 OK created sql incremental model demo_user.lim_orders ................. [[32mactivity: Insert, rows_affected: 99[0m in 2.51s]
[0m11:30:31.975741 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_orders
[0m11:30:31.979914 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_payments
[0m11:30:31.983306 [info ] [Thread-1  ]: 13 of 18 START sql view model demo_user.lim_payments ........................... [RUN]
[0m11:30:31.984981 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.lim_orders, now model.jaffle_shop_teradata.lim_payments)
[0m11:30:31.986270 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_payments
[0m11:30:31.998551 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_payments"
[0m11:30:32.006314 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_payments
[0m11:30:32.012227 [debug] [Thread-1  ]: Setting query_band
[0m11:30:32.016137 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.lim_payments"
[0m11:30:32.019796 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_payments"
[0m11:30:32.020460 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_payments"} */

  

  
  REPLACE VIEW "demo_user"."lim_payments__dbt_tmp" AS
    /*
  Build a light integrated modeled layer from source image 
  for entity `payments`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
  - Naming conventions alignment
*/

sel
  id as payment_id,
  order_id,
  payment_method,
  --`amount` is currently stored in cents, so we convert it to dollars
  amount / 100 as amount_usd
  from "demo_user"."sim_payments" s


[0m11:30:32.021068 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:30:32.736803 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:32.740431 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:33.040444 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 1.018 seconds
[0m11:30:33.061526 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_payments"
[0m11:30:33.063986 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_payments"} */

    DROP view /*+ IF EXISTS */ "demo_user"."lim_payments__dbt_backup";
  
[0m11:30:33.109292 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1086] [Teradata Database] [Error 3807] Object 'demo_user.lim_payments__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:33.112910 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_payments"
[0m11:30:33.114058 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_payments"} */

    RENAME view "demo_user"."lim_payments" TO "demo_user"."lim_payments__dbt_backup"
  
[0m11:30:33.308289 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.192 seconds
[0m11:30:33.332266 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_payments"
[0m11:30:33.336775 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_payments"} */

    DROP view /*+ IF EXISTS */ "demo_user"."lim_payments";
  
[0m11:30:33.383021 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1086] [Teradata Database] [Error 3807] Object 'demo_user.lim_payments' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:33.388401 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_payments"
[0m11:30:33.391776 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_payments"} */

    RENAME view "demo_user"."lim_payments__dbt_tmp" TO "demo_user"."lim_payments"
  
[0m11:30:33.611079 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.216 seconds
[0m11:30:33.626341 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_payments"
[0m11:30:33.627242 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_payments"} */
DROP view /*+ IF EXISTS */ "demo_user"."lim_payments__dbt_backup";
[0m11:30:33.841620 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 10 in 0.213 seconds
[0m11:30:33.850128 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: Close
[0m11:30:33.913297 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a900e96a0>]}
[0m11:30:33.916574 [info ] [Thread-1  ]: 13 of 18 OK created sql view model demo_user.lim_payments ...................... [[32mactivity: Create View, rows_affected: 0[0m in 1.93s]
[0m11:30:33.919898 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_payments
[0m11:30:33.923525 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.customer_lifetime_value
[0m11:30:33.925709 [info ] [Thread-1  ]: 14 of 18 START sql incremental model demo_user.customer_lifetime_value ......... [RUN]
[0m11:30:33.927885 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.lim_payments, now model.jaffle_shop_teradata.customer_lifetime_value)
[0m11:30:33.929426 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.customer_lifetime_value
[0m11:30:33.946584 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.customer_lifetime_value"
[0m11:30:33.960237 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.customer_lifetime_value
[0m11:30:33.963584 [debug] [Thread-1  ]: Setting query_band
[0m11:30:33.965478 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer_lifetime_value"
[0m11:30:33.965903 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer_lifetime_value"} */

      CREATE  TABLE
      "demo_user"."customer_lifetime_value"
      AS (
            



select
    orders.customer_key,
    --Full load: compute the historical customer value history    
    sum(sum(amount_usd)) over(partition by orders.customer_key order by order_date ROWS UNBOUNDED PRECEDING) total_amount_usd,
    period(
        order_date, 
        coalesce(lead(order_date) over(partition by orders.customer_key order by order_date) , ('9999-12-31' (date)))
        ) valid_period

from "demo_user"."lim_payments" payments
left join  "demo_user"."lim_orders" orders on payments.order_id = orders.id


group by orders.customer_key, order_date

        ) WITH NO DATA
      
      ;
    
[0m11:30:33.966306 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:30:34.693362 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:34.696491 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:35.021105 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 1.054 seconds
[0m11:30:35.029293 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.customer_lifetime_value"
[0m11:30:35.036437 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer_lifetime_value"
[0m11:30:35.038623 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer_lifetime_value"} */

   
  
    
    

    INSERT INTO "demo_user"."customer_lifetime_value"
          



select
    orders.customer_key,
    --Full load: compute the historical customer value history    
    sum(sum(amount_usd)) over(partition by orders.customer_key order by order_date ROWS UNBOUNDED PRECEDING) total_amount_usd,
    period(
        order_date, 
        coalesce(lead(order_date) over(partition by orders.customer_key order by order_date) , ('9999-12-31' (date)))
        ) valid_period

from "demo_user"."lim_payments" payments
left join  "demo_user"."lim_orders" orders on payments.order_id = orders.id


group by orders.customer_key, order_date

    ;
  

  

[0m11:30:35.338414 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 99 in 0.298 seconds
[0m11:30:35.344288 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer_lifetime_value: Close
[0m11:30:35.416363 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae04ed4c0>]}
[0m11:30:35.420139 [info ] [Thread-1  ]: 14 of 18 OK created sql incremental model demo_user.customer_lifetime_value .... [[32mactivity: Insert, rows_affected: 99[0m in 1.49s]
[0m11:30:35.426096 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.customer_lifetime_value
[0m11:30:35.427893 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.dim_payment_method
[0m11:30:35.429843 [info ] [Thread-1  ]: 15 of 18 START sql view model demo_user.dim_payment_method ..................... [RUN]
[0m11:30:35.431630 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.customer_lifetime_value, now model.jaffle_shop_teradata.dim_payment_method)
[0m11:30:35.433046 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.dim_payment_method
[0m11:30:35.442591 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.dim_payment_method"
[0m11:30:35.467110 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.dim_payment_method
[0m11:30:35.472960 [debug] [Thread-1  ]: Setting query_band
[0m11:30:35.479928 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.dim_payment_method"
[0m11:30:35.490760 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_payment_method"
[0m11:30:35.491692 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_payment_method"} */

  

  
  REPLACE VIEW "demo_user"."dim_payment_method__dbt_tmp" AS
    with payments as (

    select * from "demo_user"."lim_payments"

),

final as (

    select
        payment_method
        ,sum(amount_usd) as total_amount
        ,count(1) as frequency_count
    from payments
    group by 1

)

select * from final


[0m11:30:35.492472 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:30:36.158722 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:36.162403 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:36.440294 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 0.947 seconds
[0m11:30:36.461088 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_payment_method"
[0m11:30:36.462302 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_payment_method"} */

    DROP view /*+ IF EXISTS */ "demo_user"."dim_payment_method__dbt_backup";
  
[0m11:30:36.507205 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1088] [Teradata Database] [Error 3807] Object 'demo_user.dim_payment_method__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:36.515275 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_payment_method"
[0m11:30:36.516895 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_payment_method"} */

    RENAME view "demo_user"."dim_payment_method" TO "demo_user"."dim_payment_method__dbt_backup"
  
[0m11:30:36.730919 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.212 seconds
[0m11:30:36.747413 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_payment_method"
[0m11:30:36.748910 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_payment_method"} */

    DROP view /*+ IF EXISTS */ "demo_user"."dim_payment_method";
  
[0m11:30:36.795007 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1088] [Teradata Database] [Error 3807] Object 'demo_user.dim_payment_method' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:36.802144 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_payment_method"
[0m11:30:36.803839 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_payment_method"} */

    RENAME view "demo_user"."dim_payment_method__dbt_tmp" TO "demo_user"."dim_payment_method"
  
[0m11:30:37.017110 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.211 seconds
[0m11:30:37.037894 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_payment_method"
[0m11:30:37.039323 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_payment_method"} */
DROP view /*+ IF EXISTS */ "demo_user"."dim_payment_method__dbt_backup";
[0m11:30:37.251535 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 9 in 0.211 seconds
[0m11:30:37.255817 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: Close
[0m11:30:37.324337 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9803bd00>]}
[0m11:30:37.327404 [info ] [Thread-1  ]: 15 of 18 OK created sql view model demo_user.dim_payment_method ................ [[32mactivity: Create View, rows_affected: 0[0m in 1.89s]
[0m11:30:37.331179 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.dim_payment_method
[0m11:30:37.333329 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.order_payments
[0m11:30:37.335259 [info ] [Thread-1  ]: 16 of 18 START sql view model demo_user.order_payments ......................... [RUN]
[0m11:30:37.337236 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.dim_payment_method, now model.jaffle_shop_teradata.order_payments)
[0m11:30:37.339177 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.order_payments
[0m11:30:37.348826 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.order_payments"
[0m11:30:37.350522 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.order_payments
[0m11:30:37.353750 [debug] [Thread-1  ]: Setting query_band
[0m11:30:37.356106 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.order_payments"
[0m11:30:37.358857 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.order_payments"
[0m11:30:37.359399 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.order_payments"} */

  

  
  REPLACE VIEW "demo_user"."order_payments__dbt_tmp" AS
    

with payments as (

    select * from "demo_user"."lim_payments"

),

final as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount_usd else 0 end) as credit_card_amount_usd,
        sum(case when payment_method = 'coupon' then amount_usd else 0 end) as coupon_amount_usd,
        sum(case when payment_method = 'bank_transfer' then amount_usd else 0 end) as bank_transfer_amount_usd,
        sum(case when payment_method = 'gift_card' then amount_usd else 0 end) as gift_card_amount_usd,
        sum(amount_usd) as total_amount_usd

    from payments

    group by 1

)

select * from final


[0m11:30:37.359863 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:30:38.049300 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:38.052573 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:38.415281 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 1.054 seconds
[0m11:30:38.436540 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.order_payments"
[0m11:30:38.437195 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.order_payments"} */

    DROP view /*+ IF EXISTS */ "demo_user"."order_payments__dbt_backup";
  
[0m11:30:38.481057 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1089] [Teradata Database] [Error 3807] Object 'demo_user.order_payments__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:38.485181 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.order_payments"
[0m11:30:38.486249 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.order_payments"} */

    RENAME view "demo_user"."order_payments" TO "demo_user"."order_payments__dbt_backup"
  
[0m11:30:38.698155 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.210 seconds
[0m11:30:38.719030 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.order_payments"
[0m11:30:38.720319 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.order_payments"} */

    DROP view /*+ IF EXISTS */ "demo_user"."order_payments";
  
[0m11:30:38.768710 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1089] [Teradata Database] [Error 3807] Object 'demo_user.order_payments' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:38.777823 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.order_payments"
[0m11:30:38.780092 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.order_payments"} */

    RENAME view "demo_user"."order_payments__dbt_tmp" TO "demo_user"."order_payments"
  
[0m11:30:38.992667 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.211 seconds
[0m11:30:39.014980 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.order_payments"
[0m11:30:39.016213 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.order_payments"} */
DROP view /*+ IF EXISTS */ "demo_user"."order_payments__dbt_backup";
[0m11:30:39.233169 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 12 in 0.216 seconds
[0m11:30:39.248317 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: Close
[0m11:30:39.351551 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9005bdc0>]}
[0m11:30:39.353433 [info ] [Thread-1  ]: 16 of 18 OK created sql view model demo_user.order_payments .................... [[32mactivity: Create View, rows_affected: 0[0m in 2.01s]
[0m11:30:39.355684 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.order_payments
[0m11:30:39.357516 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.dim_customers
[0m11:30:39.359072 [info ] [Thread-1  ]: 17 of 18 START sql view model demo_user.dim_customers .......................... [RUN]
[0m11:30:39.360480 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.order_payments, now model.jaffle_shop_teradata.dim_customers)
[0m11:30:39.361534 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.dim_customers
[0m11:30:39.375200 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.dim_customers"
[0m11:30:39.381632 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.dim_customers
[0m11:30:39.384269 [debug] [Thread-1  ]: Setting query_band
[0m11:30:39.386084 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.dim_customers"
[0m11:30:39.386866 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_customers"
[0m11:30:39.387291 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_customers"} */

  

  
  REPLACE VIEW "demo_user"."dim_customers__dbt_tmp" AS
    with customers as (
    
    select * from "demo_user"."key_customer"
    where domain_cd in ('retail', 'business')

),

customer_orders as (
    
    select
        customer_key,
        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from "demo_user"."lim_orders"
    group by 1

),

customer_lifetime_value as (
     
    select * from "demo_user"."customer_lifetime_value"
    where customer_lifetime_value.valid_period contains current_date

),

final as (

    select
        customers.customer_key,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_lifetime_value.total_amount_usd as customer_lifetime_value

    from customers

    left join customer_orders on customers.customer_key = customer_orders.customer_key
    left join customer_lifetime_value on customers.customer_key = customer_lifetime_value.customer_key

)

select * from final


[0m11:30:39.387664 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:30:40.090026 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:40.092961 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:40.141623 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1090] [Teradata Database] [Error 5628] Column order_id not found in demo_user.lim_orders.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:40.144193 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_customers: Close
[0m11:30:40.235759 [debug] [Thread-1  ]: Database Error in model dim_customers (models/consumption/dim_customers.sql)
  [Version 20.0.0.15] [Session 1090] [Teradata Database] [Error 5628] Column order_id not found in demo_user.lim_orders.
   at gosqldriver/teradatasql.formatError ErrorUtil.go:91
   at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
   at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
   at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
   at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
   at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
   at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
   at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
   at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
   at database/sql.ctxDriverQuery ctxutil.go:48
   at database/sql.(*DB).queryDC.func1 sql.go:1776
   at database/sql.withLock sql.go:3530
   at database/sql.(*DB).queryDC sql.go:1771
   at database/sql.(*Conn).QueryContext sql.go:2027
   at main.createRows goside.go:783
   at main.goCreateRows goside.go:662
   at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
   at runtime.cgocallbackg1 cgocall.go:420
   at runtime.cgocallbackg cgocall.go:339
   at runtime.cgocallback asm_amd64.s:1079
   at runtime.goexit asm_amd64.s:1695
  compiled Code at target/run/jaffle_shop_teradata/models/consumption/dim_customers.sql
[0m11:30:40.239943 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae04ebb80>]}
[0m11:30:40.241844 [error] [Thread-1  ]: 17 of 18 ERROR creating sql view model demo_user.dim_customers ................. [[31mERROR[0m in 0.88s]
[0m11:30:40.243668 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.dim_customers
[0m11:30:40.245570 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.fct_orders
[0m11:30:40.247077 [info ] [Thread-1  ]: 18 of 18 START sql view model demo_user.fct_orders ............................. [RUN]
[0m11:30:40.248523 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.dim_customers, now model.jaffle_shop_teradata.fct_orders)
[0m11:30:40.249481 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.fct_orders
[0m11:30:40.255135 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.fct_orders"
[0m11:30:40.265176 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.fct_orders
[0m11:30:40.269940 [debug] [Thread-1  ]: Setting query_band
[0m11:30:40.272018 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.fct_orders"
[0m11:30:40.281245 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.fct_orders"
[0m11:30:40.281811 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.fct_orders"} */

  

  
  REPLACE VIEW "demo_user"."fct_orders__dbt_tmp" AS
    

with orders as (

    select * from "demo_user"."lim_orders"

),

order_payments as (

    select * from "demo_user"."order_payments"

),

final as (

    select
        orders.customer_key,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount_usd,

        order_payments.coupon_amount_usd,

        order_payments.bank_transfer_amount_usd,

        order_payments.gift_card_amount_usd,

        order_payments.total_amount_usd as amount

    from orders

    left join order_payments on orders.id = order_payments.order_id

)

select * from final


[0m11:30:40.282234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:30:40.951810 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:40.955026 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:30:41.317605 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 1.034 seconds
[0m11:30:41.336132 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.fct_orders"
[0m11:30:41.337746 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.fct_orders"} */

    DROP view /*+ IF EXISTS */ "demo_user"."fct_orders";
  
[0m11:30:41.396806 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1091] [Teradata Database] [Error 3807] Object 'demo_user.fct_orders' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:41.399733 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.fct_orders"
[0m11:30:41.400166 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.fct_orders"} */

    RENAME view "demo_user"."fct_orders__dbt_tmp" TO "demo_user"."fct_orders"
  
[0m11:30:41.591199 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.190 seconds
[0m11:30:41.612116 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.fct_orders"
[0m11:30:41.613579 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.fct_orders"} */
DROP view /*+ IF EXISTS */ "demo_user"."fct_orders__dbt_backup";
[0m11:30:41.660030 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1091] [Teradata Database] [Error 3807] Object 'demo_user.fct_orders__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:30:41.666842 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.fct_orders: Close
[0m11:30:41.746198 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5666e7b-765d-4326-990c-d68857408f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad36cb520>]}
[0m11:30:41.750007 [info ] [Thread-1  ]: 18 of 18 OK created sql view model demo_user.fct_orders ........................ [[32mactivity: Create View, rows_affected: 0[0m in 1.50s]
[0m11:30:41.752688 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.fct_orders
[0m11:30:41.759282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:30:41.761368 [debug] [MainThread]: Connection 'model.jaffle_shop_teradata.fct_orders' was properly closed.
[0m11:30:41.763239 [info ] [MainThread]: 
[0m11:30:41.764379 [info ] [MainThread]: Finished running 7 incremental models, 11 view models in 0 hours 0 minutes and 53.91 seconds (53.91s).
[0m11:30:41.772036 [debug] [MainThread]: Command end result
[0m11:30:41.880898 [info ] [MainThread]: 
[0m11:30:41.881351 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:30:41.881600 [info ] [MainThread]: 
[0m11:30:41.881967 [error] [MainThread]:   Database Error in model dim_customers (models/consumption/dim_customers.sql)
  [Version 20.0.0.15] [Session 1090] [Teradata Database] [Error 5628] Column order_id not found in demo_user.lim_orders.
   at gosqldriver/teradatasql.formatError ErrorUtil.go:91
   at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
   at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
   at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
   at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
   at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
   at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
   at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
   at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
   at database/sql.ctxDriverQuery ctxutil.go:48
   at database/sql.(*DB).queryDC.func1 sql.go:1776
   at database/sql.withLock sql.go:3530
   at database/sql.(*DB).queryDC sql.go:1771
   at database/sql.(*Conn).QueryContext sql.go:2027
   at main.createRows goside.go:783
   at main.goCreateRows goside.go:662
   at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
   at runtime.cgocallbackg1 cgocall.go:420
   at runtime.cgocallbackg cgocall.go:339
   at runtime.cgocallback asm_amd64.s:1079
   at runtime.goexit asm_amd64.s:1695
  compiled Code at target/run/jaffle_shop_teradata/models/consumption/dim_customers.sql
[0m11:30:41.882380 [info ] [MainThread]: 
[0m11:30:41.882695 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=1 SKIP=0 TOTAL=18
[0m11:30:41.886808 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 54.94039, "process_user_time": 5.036185, "process_kernel_time": 0.765258, "process_mem_max_rss": "130433024", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:30:41.887216 [debug] [MainThread]: Command `dbt run` failed at 11:30:41.887141 after 54.94 seconds
[0m11:30:41.887540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad11742e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a80084550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a80084be0>]}
[0m11:30:41.887843 [debug] [MainThread]: Flushing usage events
[0m11:36:20.645102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f038e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa511f2ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa511f2cbe0>]}


============================== 11:36:20.653376 | 00936665-6b0a-4da0-be9d-7e7c10fb10ec ==============================
[0m11:36:20.653376 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:36:20.653931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/remi.turpaud/.dbt', 'log_path': '/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:36:21.424894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51217d040>]}
[0m11:36:21.462505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa511dbb970>]}
[0m11:36:21.465994 [info ] [MainThread]: Registered adapter: teradata=1.8.0
[0m11:36:21.495486 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:36:21.728814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:36:21.729349 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:36:21.735389 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop
- models.jaffle_shop.staging
[0m11:36:21.793399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4c00ad130>]}
[0m11:36:22.056593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4c00b91c0>]}
[0m11:36:22.057385 [info ] [MainThread]: Found 18 models, 1 snapshot, 3 seeds, 8 data tests, 1 source, 573 macros
[0m11:36:22.057855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51240b0a0>]}
[0m11:36:22.060695 [info ] [MainThread]: 
[0m11:36:22.061447 [debug] [MainThread]: Acquiring new teradata connection 'master'
[0m11:36:22.069247 [debug] [ThreadPool]: Acquiring new teradata connection 'list_schemas'
[0m11:36:22.083790 [debug] [ThreadPool]: Using teradata connection "list_schemas"
[0m11:36:22.084225 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_schemas"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
[0m11:36:22.084538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:23.311333 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:36:23.314708 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:36:23.509064 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 46 in 1.422 seconds
[0m11:36:23.517204 [debug] [ThreadPool]: On list_schemas: Close
[0m11:36:23.598256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_schemas, now list_None_rt186001)
[0m11:36:23.610029 [debug] [ThreadPool]: Using teradata connection "list_None_rt186001"
[0m11:36:23.610689 [debug] [ThreadPool]: On list_None_rt186001: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_None_rt186001"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'rt186001' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
[0m11:36:23.611209 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:24.372284 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:36:24.374893 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:36:24.569464 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 0 in 0.957 seconds
[0m11:36:24.575759 [debug] [ThreadPool]: On list_None_rt186001: Close
[0m11:36:24.690655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None_rt186001, now list_None_demo_user)
[0m11:36:24.698998 [debug] [ThreadPool]: Using teradata connection "list_None_demo_user"
[0m11:36:24.699876 [debug] [ThreadPool]: On list_None_demo_user: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_None_demo_user"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
[0m11:36:24.700555 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:25.397343 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:36:25.400308 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:36:25.592886 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 21 in 0.892 seconds
[0m11:36:25.599197 [debug] [ThreadPool]: On list_None_demo_user: Close
[0m11:36:25.671717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e06572e0>]}
[0m11:36:25.673012 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:36:25.673711 [info ] [MainThread]: 
[0m11:36:25.692687 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.key_customer
[0m11:36:25.693737 [info ] [Thread-1  ]: 1 of 18 START sql incremental model demo_user.key_customer ..................... [RUN]
[0m11:36:25.694622 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_None_demo_user, now model.jaffle_shop_teradata.key_customer)
[0m11:36:25.695305 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.key_customer
[0m11:36:25.712592 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.key_customer"
[0m11:36:25.725555 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.key_customer
[0m11:36:25.752760 [debug] [Thread-1  ]: Setting query_band
[0m11:36:25.772870 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.key_customer"
[0m11:36:25.773243 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.key_customer"} */
DROP table /*+ IF EXISTS */ "demo_user"."key_customer__dbt_backup";
[0m11:36:25.773540 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:36:26.475262 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:36:26.478196 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:36:26.522813 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1096] [Teradata Database] [Error 3807] Object 'demo_user.key_customer__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:36:26.536240 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.key_customer"
[0m11:36:26.536884 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.key_customer"} */

    DROP table /*+ IF EXISTS */ "demo_user"."key_customer__dbt_backup";
  
[0m11:36:26.580878 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1096] [Teradata Database] [Error 3807] Object 'demo_user.key_customer__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:36:26.583246 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.key_customer"
[0m11:36:26.583963 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.key_customer"} */

    RENAME table "demo_user"."key_customer" TO "demo_user"."key_customer__dbt_backup"
  
[0m11:36:27.005794 [debug] [Thread-1  ]: SQL status: activity: Rename Table, rows_affected: 2 in 0.421 seconds
[0m11:36:27.031778 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.key_customer"
[0m11:36:27.032488 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.key_customer"} */

      CREATE  TABLE
      "demo_user"."key_customer"
      AS (
            



--Create the surrogate key table with default members if it doesn't exist
select
    -1 (integer) customer_key
    ,'UNKNOWN' (varchar(10000)) customer_nk
    ,'' (char(100)) domain_cd
    ,current_timestamp created_ts
from (sel 1 a) dummy
        ) WITH NO DATA
      
      ;
    
[0m11:36:27.375927 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.342 seconds
[0m11:36:27.380755 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.key_customer"
[0m11:36:27.389643 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.key_customer"
[0m11:36:27.390310 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.key_customer"} */

   
  
    
    

    INSERT INTO "demo_user"."key_customer"
          



--Create the surrogate key table with default members if it doesn't exist
select
    -1 (integer) customer_key
    ,'UNKNOWN' (varchar(10000)) customer_nk
    ,'' (char(100)) domain_cd
    ,current_timestamp created_ts
from (sel 1 a) dummy
    ;
  

  

[0m11:36:27.517782 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 1 in 0.126 seconds
[0m11:36:27.547747 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.key_customer"
[0m11:36:27.548407 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.key_customer"} */
DROP table /*+ IF EXISTS */ "demo_user"."key_customer__dbt_backup";
[0m11:36:27.909708 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 17 in 0.360 seconds
[0m11:36:27.917416 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.key_customer: Close
[0m11:36:27.990819 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa512639520>]}
[0m11:36:27.992385 [info ] [Thread-1  ]: 1 of 18 OK created sql incremental model demo_user.key_customer ................ [[32mactivity: Insert, rows_affected: 1[0m in 2.29s]
[0m11:36:27.993874 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.key_customer
[0m11:36:27.994881 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_market_customers
[0m11:36:27.996101 [info ] [Thread-1  ]: 2 of 18 START sql view model demo_user.lim_market_customers .................... [RUN]
[0m11:36:27.997229 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.key_customer, now model.jaffle_shop_teradata.lim_market_customers)
[0m11:36:27.997967 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_market_customers
[0m11:36:28.058660 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_market_customers"
[0m11:36:28.066413 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_market_customers
[0m11:36:28.069718 [debug] [Thread-1  ]: Setting query_band
[0m11:36:28.087741 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:36:28.088083 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    drop table demo_user.raw_market_customers;
  
[0m11:36:28.088363 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:36:28.767813 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:36:28.769305 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:36:29.084538 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 24 in 0.995 seconds
[0m11:36:29.088919 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:36:29.089447 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    create foreign table demo_user.raw_market_customers using (location('/GS/storage.googleapis.com/clearscape_analytics_demo_data/DEMO_Market/Customer/'));
  
[0m11:36:38.125293 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 9.034 seconds
[0m11:36:38.143225 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.lim_market_customers"
[0m11:36:38.160193 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:36:38.160903 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

  

  
  REPLACE VIEW "demo_user"."lim_market_customers__dbt_tmp" AS
    /*
  Build a light integrated modeled layer from source image 
  for entity `market_customers`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
*/

select
spend,
nearby5,
nearby10,
new ST_GEOMETRY(ptLocWkt) location_pt
from "demo_user"."raw_market_customers" s


[0m11:36:38.499487 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 0.337 seconds
[0m11:36:38.510270 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:36:38.511116 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    DROP view /*+ IF EXISTS */ "demo_user"."lim_market_customers__dbt_backup";
  
[0m11:36:38.555226 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1097] [Teradata Database] [Error 3807] Object 'demo_user.lim_market_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:36:38.560118 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:36:38.561123 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    RENAME view "demo_user"."lim_market_customers" TO "demo_user"."lim_market_customers__dbt_backup"
  
[0m11:36:38.794645 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.232 seconds
[0m11:36:38.802516 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:36:38.803260 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    DROP view /*+ IF EXISTS */ "demo_user"."lim_market_customers";
  
[0m11:36:38.847855 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1097] [Teradata Database] [Error 3807] Object 'demo_user.lim_market_customers' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:36:38.851399 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:36:38.852343 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */

    RENAME view "demo_user"."lim_market_customers__dbt_tmp" TO "demo_user"."lim_market_customers"
  
[0m11:36:39.043280 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.189 seconds
[0m11:36:39.058850 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_customers"
[0m11:36:39.059571 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_customers"} */
DROP view /*+ IF EXISTS */ "demo_user"."lim_market_customers__dbt_backup";
[0m11:36:39.250440 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 10 in 0.189 seconds
[0m11:36:39.256617 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_customers: Close
[0m11:36:39.335480 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51266a160>]}
[0m11:36:39.337401 [info ] [Thread-1  ]: 2 of 18 OK created sql view model demo_user.lim_market_customers ............... [[32mactivity: Create View, rows_affected: 0[0m in 11.34s]
[0m11:36:39.339222 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_market_customers
[0m11:36:39.340373 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.stg_customers
[0m11:36:39.341328 [info ] [Thread-1  ]: 3 of 18 START sql view model demo_user.stg_customers ........................... [RUN]
[0m11:36:39.342545 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.lim_market_customers, now model.jaffle_shop_teradata.stg_customers)
[0m11:36:39.343452 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.stg_customers
[0m11:36:39.350707 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.stg_customers"
[0m11:36:39.358700 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.stg_customers
[0m11:36:39.361189 [debug] [Thread-1  ]: Setting query_band
[0m11:36:39.364240 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.stg_customers"
[0m11:36:39.366627 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_customers"
[0m11:36:39.367025 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_customers"} */

  

  
  REPLACE VIEW "demo_user"."stg_customers__dbt_tmp" AS
    locking row for access
select
    id as customer_id,
    first_name (varchar(1000)),
    last_name (varchar(1000)),
    email (varchar(1000)),
    current_timestamp last_update_ts
from "demo_user"."raw_customers" source


[0m11:36:39.367412 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:36:40.067062 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:36:40.070606 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:36:40.389127 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 1.021 seconds
[0m11:36:40.400732 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_customers"
[0m11:36:40.401725 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_customers"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_customers__dbt_backup";
  
[0m11:36:40.446071 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1098] [Teradata Database] [Error 3807] Object 'demo_user.stg_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:36:40.450469 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_customers"
[0m11:36:40.451370 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_customers"} */

    RENAME view "demo_user"."stg_customers" TO "demo_user"."stg_customers__dbt_backup"
  
[0m11:36:40.622009 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.169 seconds
[0m11:36:40.632562 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_customers"
[0m11:36:40.633433 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_customers"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_customers";
  
[0m11:36:40.678426 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1098] [Teradata Database] [Error 3807] Object 'demo_user.stg_customers' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:36:40.682952 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_customers"
[0m11:36:40.684079 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_customers"} */

    RENAME view "demo_user"."stg_customers__dbt_tmp" TO "demo_user"."stg_customers"
  
[0m11:36:40.895322 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.209 seconds
[0m11:36:40.906420 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_customers"
[0m11:36:40.907195 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_customers"} */
DROP view /*+ IF EXISTS */ "demo_user"."stg_customers__dbt_backup";
[0m11:36:41.121872 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 11 in 0.213 seconds
[0m11:36:41.128719 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_customers: Close
[0m11:36:41.192462 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa512620580>]}
[0m11:36:41.195604 [info ] [Thread-1  ]: 3 of 18 OK created sql view model demo_user.stg_customers ...................... [[32mactivity: Create View, rows_affected: 0[0m in 1.85s]
[0m11:36:41.197512 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.stg_customers
[0m11:36:41.198553 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.stg_market_customers
[0m11:36:41.199997 [info ] [Thread-1  ]: 4 of 18 START sql view model demo_user.stg_market_customers .................... [RUN]
[0m11:36:41.200989 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.stg_customers, now model.jaffle_shop_teradata.stg_market_customers)
[0m11:36:41.201745 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.stg_market_customers
[0m11:36:41.211443 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.stg_market_customers"
[0m11:36:41.234853 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.stg_market_customers
[0m11:36:41.239011 [debug] [Thread-1  ]: Setting query_band
[0m11:36:41.243229 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m11:36:41.243832 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */

    drop table demo_user.raw_market_customers;
  
[0m11:36:41.244330 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:36:42.003936 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:36:42.006959 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:36:42.343575 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 24 in 1.098 seconds
[0m11:36:42.348849 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m11:36:42.349980 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */

    create foreign table demo_user.raw_market_customers using (location('/GS/storage.googleapis.com/clearscape_analytics_demo_data/DEMO_Market/Customer/'));
  
[0m11:36:50.955072 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 8.603 seconds
[0m11:36:50.961660 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.stg_market_customers"
[0m11:36:50.974833 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m11:36:50.975606 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */

  

  
  REPLACE VIEW "demo_user"."stg_market_customers__dbt_tmp" AS
    



with source as (
    select * from "demo_user"."raw_market_customers"

),

renamed as 
(
    select
    source.*
    from source

)

select * from renamed


[0m11:36:51.314885 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 0.338 seconds
[0m11:36:51.325594 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m11:36:51.326497 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_market_customers__dbt_backup";
  
[0m11:36:51.371161 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1099] [Teradata Database] [Error 3807] Object 'demo_user.stg_market_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:36:51.375009 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m11:36:51.375966 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */

    RENAME view "demo_user"."stg_market_customers" TO "demo_user"."stg_market_customers__dbt_backup"
  
[0m11:36:51.568378 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.190 seconds
[0m11:36:51.577477 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m11:36:51.578234 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_market_customers";
  
[0m11:36:51.623025 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1099] [Teradata Database] [Error 3807] Object 'demo_user.stg_market_customers' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:36:51.626428 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m11:36:51.627306 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */

    RENAME view "demo_user"."stg_market_customers__dbt_tmp" TO "demo_user"."stg_market_customers"
  
[0m11:36:51.820936 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.192 seconds
[0m11:36:51.827140 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_market_customers"
[0m11:36:51.827681 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_market_customers"} */
DROP view /*+ IF EXISTS */ "demo_user"."stg_market_customers__dbt_backup";
[0m11:36:52.039298 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 12 in 0.210 seconds
[0m11:36:52.045263 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_market_customers: Close
[0m11:36:52.119312 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51271aa00>]}
[0m11:36:52.121153 [info ] [Thread-1  ]: 4 of 18 OK created sql view model demo_user.stg_market_customers ............... [[32mactivity: Create View, rows_affected: 0[0m in 10.92s]
[0m11:36:52.122586 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.stg_market_customers
[0m11:36:52.123589 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.stg_orders
[0m11:36:52.124925 [info ] [Thread-1  ]: 5 of 18 START sql view model demo_user.stg_orders .............................. [RUN]
[0m11:36:52.125969 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.stg_market_customers, now model.jaffle_shop_teradata.stg_orders)
[0m11:36:52.126700 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.stg_orders
[0m11:36:52.134333 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.stg_orders"
[0m11:36:52.153108 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.stg_orders
[0m11:36:52.159890 [debug] [Thread-1  ]: Setting query_band
[0m11:36:52.163050 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.stg_orders"
[0m11:36:52.174448 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_orders"
[0m11:36:52.175014 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_orders"} */

  

  
  REPLACE VIEW "demo_user"."stg_orders__dbt_tmp" AS
    locking row for access
select
    source.*,
    current_timestamp last_update_ts
from "demo_user"."raw_orders" source


[0m11:36:52.175447 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:36:52.854330 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:36:52.855955 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:36:53.194168 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 1.017 seconds
[0m11:36:53.199840 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_orders"
[0m11:36:53.200283 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_orders"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_orders__dbt_backup";
  
[0m11:36:53.244686 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1100] [Teradata Database] [Error 3807] Object 'demo_user.stg_orders__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:36:53.248997 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_orders"
[0m11:36:53.250099 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_orders"} */

    RENAME view "demo_user"."stg_orders" TO "demo_user"."stg_orders__dbt_backup"
  
[0m11:36:53.440802 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.189 seconds
[0m11:36:53.451348 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_orders"
[0m11:36:53.452167 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_orders"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_orders";
  
[0m11:36:53.496236 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1100] [Teradata Database] [Error 3807] Object 'demo_user.stg_orders' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:36:53.500294 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_orders"
[0m11:36:53.501266 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_orders"} */

    RENAME view "demo_user"."stg_orders__dbt_tmp" TO "demo_user"."stg_orders"
  
[0m11:36:53.692627 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.190 seconds
[0m11:36:53.704512 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_orders"
[0m11:36:53.705352 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_orders"} */
DROP view /*+ IF EXISTS */ "demo_user"."stg_orders__dbt_backup";
[0m11:36:53.937720 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 11 in 0.231 seconds
[0m11:36:53.944393 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_orders: Close
[0m11:36:54.011096 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5122c6400>]}
[0m11:36:54.014395 [info ] [Thread-1  ]: 5 of 18 OK created sql view model demo_user.stg_orders ......................... [[32mactivity: Create View, rows_affected: 0[0m in 1.88s]
[0m11:36:54.015813 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.stg_orders
[0m11:36:54.016574 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.stg_payments
[0m11:36:54.017966 [info ] [Thread-1  ]: 6 of 18 START sql view model demo_user.stg_payments ............................ [RUN]
[0m11:36:54.018893 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.stg_orders, now model.jaffle_shop_teradata.stg_payments)
[0m11:36:54.019604 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.stg_payments
[0m11:36:54.027385 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.stg_payments"
[0m11:36:54.048182 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.stg_payments
[0m11:36:54.053327 [debug] [Thread-1  ]: Setting query_band
[0m11:36:54.060579 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.stg_payments"
[0m11:36:54.075295 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_payments"
[0m11:36:54.075908 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_payments"} */

  

  
  REPLACE VIEW "demo_user"."stg_payments__dbt_tmp" AS
    locking row for access
select
source.*
,'2024-09-03 09:36:20.583062+00:00' (timestamp) last_update_ts
from  "demo_user"."raw_payments" source


[0m11:36:54.076437 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:36:54.735818 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:36:54.738867 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:36:55.035739 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 0.958 seconds
[0m11:36:55.046470 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_payments"
[0m11:36:55.047294 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_payments"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_payments__dbt_backup";
  
[0m11:36:55.113382 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1101] [Teradata Database] [Error 3807] Object 'demo_user.stg_payments__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:36:55.117090 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_payments"
[0m11:36:55.118031 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_payments"} */

    RENAME view "demo_user"."stg_payments" TO "demo_user"."stg_payments__dbt_backup"
  
[0m11:36:55.311109 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.191 seconds
[0m11:36:55.319454 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_payments"
[0m11:36:55.320184 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_payments"} */

    DROP view /*+ IF EXISTS */ "demo_user"."stg_payments";
  
[0m11:36:55.364742 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1101] [Teradata Database] [Error 3807] Object 'demo_user.stg_payments' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:36:55.369253 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_payments"
[0m11:36:55.370176 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_payments"} */

    RENAME view "demo_user"."stg_payments__dbt_tmp" TO "demo_user"."stg_payments"
  
[0m11:36:55.560112 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.188 seconds
[0m11:36:55.571129 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.stg_payments"
[0m11:36:55.572006 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.stg_payments"} */
DROP view /*+ IF EXISTS */ "demo_user"."stg_payments__dbt_backup";
[0m11:36:55.784820 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 11 in 0.211 seconds
[0m11:36:55.790120 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.stg_payments: Close
[0m11:36:55.867106 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5122c6400>]}
[0m11:36:55.870323 [info ] [Thread-1  ]: 6 of 18 OK created sql view model demo_user.stg_payments ....................... [[32mactivity: Create View, rows_affected: 0[0m in 1.85s]
[0m11:36:55.871892 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.stg_payments
[0m11:36:55.872888 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.customer
[0m11:36:55.874275 [info ] [Thread-1  ]: 7 of 18 START sql view model demo_user.customer ................................ [RUN]
[0m11:36:55.875340 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.stg_payments, now model.jaffle_shop_teradata.customer)
[0m11:36:55.876005 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.customer
[0m11:36:55.882506 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.customer"
[0m11:36:55.901391 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.customer
[0m11:36:55.906003 [debug] [Thread-1  ]: Setting query_band
[0m11:36:55.909254 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.customer"
[0m11:36:55.935608 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer"
[0m11:36:55.936456 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer"} */

  

  
  REPLACE VIEW "demo_user"."customer__dbt_tmp" AS
    

locking row for access
select
    customer_key,
    substr(customer_nk,1,3)||'***' email
from "demo_user"."key_customer"
where domain_cd = 'retail'


[0m11:36:55.937067 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:36:56.583565 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:36:56.586325 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:36:56.845405 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 0.907 seconds
[0m11:36:56.859243 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer"
[0m11:36:56.860089 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer"} */

    DROP view /*+ IF EXISTS */ "demo_user"."customer__dbt_backup";
  
[0m11:36:56.904759 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1102] [Teradata Database] [Error 3807] Object 'demo_user.customer__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:36:56.908325 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer"
[0m11:36:56.909217 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer"} */

    RENAME view "demo_user"."customer" TO "demo_user"."customer__dbt_backup"
  
[0m11:36:57.099741 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.189 seconds
[0m11:36:57.109573 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer"
[0m11:36:57.110312 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer"} */

    DROP view /*+ IF EXISTS */ "demo_user"."customer";
  
[0m11:36:57.154716 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1102] [Teradata Database] [Error 3807] Object 'demo_user.customer' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:36:57.159730 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer"
[0m11:36:57.160637 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer"} */

    RENAME view "demo_user"."customer__dbt_tmp" TO "demo_user"."customer"
  
[0m11:36:57.351015 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.188 seconds
[0m11:36:57.361750 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer"
[0m11:36:57.362543 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer"} */
DROP view /*+ IF EXISTS */ "demo_user"."customer__dbt_backup";
[0m11:36:57.554990 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 8 in 0.191 seconds
[0m11:36:57.559647 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer: Close
[0m11:36:57.632721 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa512735b80>]}
[0m11:36:57.636221 [info ] [Thread-1  ]: 7 of 18 OK created sql view model demo_user.customer ........................... [[32mactivity: Create View, rows_affected: 0[0m in 1.76s]
[0m11:36:57.637771 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.customer
[0m11:36:57.638783 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.sim_customers
[0m11:36:57.640009 [info ] [Thread-1  ]: 8 of 18 START sql incremental model demo_user.sim_customers .................... [RUN]
[0m11:36:57.641092 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.customer, now model.jaffle_shop_teradata.sim_customers)
[0m11:36:57.641879 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.sim_customers
[0m11:36:57.673948 [debug] [Thread-1  ]: use_qvci set to : false
[0m11:36:57.674949 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m11:36:57.675625 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        WHEN ColumnsV.ColumnType = 'JN' THEN 'JSON'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType in (1, 2) THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'stg_customers' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
[0m11:36:57.676276 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:36:58.393836 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:36:58.396787 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:36:58.819252 [debug] [Thread-1  ]: SQL status: activity: Select, rows_affected: 5 in 1.142 seconds
[0m11:36:58.836323 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.sim_customers"
[0m11:36:58.854027 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.sim_customers
[0m11:36:58.858653 [debug] [Thread-1  ]: Setting query_band
[0m11:36:58.866388 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m11:36:58.866992 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */
DROP table /*+ IF EXISTS */ "demo_user"."sim_customers__dbt_backup";
[0m11:36:58.911186 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1103] [Teradata Database] [Error 3807] Object 'demo_user.sim_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:36:58.916861 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m11:36:58.917456 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */

    DROP table /*+ IF EXISTS */ "demo_user"."sim_customers__dbt_backup";
  
[0m11:36:58.960343 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1103] [Teradata Database] [Error 3807] Object 'demo_user.sim_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:36:58.962486 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m11:36:58.963183 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */

    RENAME table "demo_user"."sim_customers" TO "demo_user"."sim_customers__dbt_backup"
  
[0m11:36:59.197370 [debug] [Thread-1  ]: SQL status: activity: Rename Table, rows_affected: 3 in 0.233 seconds
[0m11:36:59.202603 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m11:36:59.203685 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */

      CREATE  TABLE
      "demo_user"."sim_customers"
      AS (
            

-- Generic source image build for `customers` entity


select    
    customer_id,    
    first_name,    
    last_name,    
    email
    
,period(last_update_ts, '9999-12-31 23:59:59.999999+00:00' (timestamp)) as valid_period
from "demo_user"."stg_customers" source
 
 
        ) WITH NO DATA
      
      ;
    
[0m11:36:59.482806 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.277 seconds
[0m11:36:59.486410 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.sim_customers"
[0m11:36:59.503781 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m11:36:59.505977 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */

   
  
    
    

    INSERT INTO "demo_user"."sim_customers"
          

-- Generic source image build for `customers` entity


select    
    customer_id,    
    first_name,    
    last_name,    
    email
    
,period(last_update_ts, '9999-12-31 23:59:59.999999+00:00' (timestamp)) as valid_period
from "demo_user"."stg_customers" source
 
 
    ;
  

  

[0m11:36:59.683039 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 100 in 0.175 seconds
[0m11:36:59.692349 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m11:36:59.693150 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */
DROP table /*+ IF EXISTS */ "demo_user"."sim_customers__dbt_backup";
[0m11:36:59.968601 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 19 in 0.274 seconds
[0m11:36:59.974371 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: Close
[0m11:37:00.048837 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa512639280>]}
[0m11:37:00.050738 [info ] [Thread-1  ]: 8 of 18 OK created sql incremental model demo_user.sim_customers ............... [[32mactivity: Insert, rows_affected: 100[0m in 2.41s]
[0m11:37:00.051896 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.sim_customers
[0m11:37:00.052758 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.sim_orders
[0m11:37:00.053979 [info ] [Thread-1  ]: 9 of 18 START sql incremental model demo_user.sim_orders ....................... [RUN]
[0m11:37:00.055027 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.sim_customers, now model.jaffle_shop_teradata.sim_orders)
[0m11:37:00.055845 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.sim_orders
[0m11:37:00.071108 [debug] [Thread-1  ]: use_qvci set to : false
[0m11:37:00.072229 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m11:37:00.073167 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        WHEN ColumnsV.ColumnType = 'JN' THEN 'JSON'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType in (1, 2) THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'stg_orders' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
[0m11:37:00.074086 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:00.732172 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:37:00.735233 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:37:01.156437 [debug] [Thread-1  ]: SQL status: activity: Select, rows_affected: 5 in 1.081 seconds
[0m11:37:01.165488 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.sim_orders"
[0m11:37:01.182434 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.sim_orders
[0m11:37:01.191318 [debug] [Thread-1  ]: Setting query_band
[0m11:37:01.197837 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m11:37:01.198504 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */
DROP table /*+ IF EXISTS */ "demo_user"."sim_orders__dbt_backup";
[0m11:37:01.242287 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1104] [Teradata Database] [Error 3807] Object 'demo_user.sim_orders__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:37:01.249004 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m11:37:01.249723 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */

    DROP table /*+ IF EXISTS */ "demo_user"."sim_orders__dbt_backup";
  
[0m11:37:01.293701 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1104] [Teradata Database] [Error 3807] Object 'demo_user.sim_orders__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:37:01.297403 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m11:37:01.298454 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */

    RENAME table "demo_user"."sim_orders" TO "demo_user"."sim_orders__dbt_backup"
  
[0m11:37:01.532130 [debug] [Thread-1  ]: SQL status: activity: Rename Table, rows_affected: 2 in 0.232 seconds
[0m11:37:01.537264 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m11:37:01.538361 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */

      CREATE  TABLE
      "demo_user"."sim_orders"
      AS (
            

-- Generic source image build for `orders` entity


select    
    id,    
    user_id,    
    order_date,    
    status,    
    last_update_ts
from "demo_user"."stg_orders" source
 
 
        ) WITH NO DATA
      
      ;
    
[0m11:37:01.838327 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.298 seconds
[0m11:37:01.842616 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.sim_orders"
[0m11:37:01.869707 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m11:37:01.871570 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */

   
  
    
    

    INSERT INTO "demo_user"."sim_orders"
          

-- Generic source image build for `orders` entity


select    
    id,    
    user_id,    
    order_date,    
    status,    
    last_update_ts
from "demo_user"."stg_orders" source
 
 
    ;
  

  

[0m11:37:02.022534 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 99 in 0.149 seconds
[0m11:37:02.034215 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m11:37:02.035048 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */
DROP table /*+ IF EXISTS */ "demo_user"."sim_orders__dbt_backup";
[0m11:37:02.351372 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 18 in 0.315 seconds
[0m11:37:02.356847 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: Close
[0m11:37:02.428038 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa512706e20>]}
[0m11:37:02.431304 [info ] [Thread-1  ]: 9 of 18 OK created sql incremental model demo_user.sim_orders .................. [[32mactivity: Insert, rows_affected: 99[0m in 2.37s]
[0m11:37:02.432941 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.sim_orders
[0m11:37:02.433998 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.sim_payments
[0m11:37:02.435553 [info ] [Thread-1  ]: 10 of 18 START sql incremental model demo_user.sim_payments .................... [RUN]
[0m11:37:02.436541 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.sim_orders, now model.jaffle_shop_teradata.sim_payments)
[0m11:37:02.437231 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.sim_payments
[0m11:37:02.447212 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.sim_payments"
[0m11:37:02.469091 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.sim_payments
[0m11:37:02.473676 [debug] [Thread-1  ]: Setting query_band
[0m11:37:02.481228 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_payments"
[0m11:37:02.481810 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_payments"} */
DROP table /*+ IF EXISTS */ "demo_user"."sim_payments__dbt_backup";
[0m11:37:02.482241 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:03.135963 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:37:03.139180 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:37:03.183102 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1105] [Teradata Database] [Error 3807] Object 'demo_user.sim_payments__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:37:03.191383 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_payments"
[0m11:37:03.192180 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_payments"} */

    DROP table /*+ IF EXISTS */ "demo_user"."sim_payments__dbt_backup";
  
[0m11:37:03.236783 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1105] [Teradata Database] [Error 3807] Object 'demo_user.sim_payments__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:37:03.240280 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_payments"
[0m11:37:03.241196 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_payments"} */

    RENAME table "demo_user"."sim_payments" TO "demo_user"."sim_payments__dbt_backup"
  
[0m11:37:03.474056 [debug] [Thread-1  ]: SQL status: activity: Rename Table, rows_affected: 2 in 0.231 seconds
[0m11:37:03.480205 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_payments"
[0m11:37:03.481244 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_payments"} */

      CREATE  TABLE
      "demo_user"."sim_payments"
      AS (
            

-- Source image build for `payments` entity

select source.*
from "demo_user"."stg_payments" source
        ) WITH NO DATA
      
      ;
    
[0m11:37:03.779639 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.297 seconds
[0m11:37:03.783115 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.sim_payments"
[0m11:37:03.787889 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_payments"
[0m11:37:03.789048 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_payments"} */

   
  
    
    

    INSERT INTO "demo_user"."sim_payments"
          

-- Source image build for `payments` entity

select source.*
from "demo_user"."stg_payments" source
    ;
  

  

[0m11:37:03.979938 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 113 in 0.190 seconds
[0m11:37:03.987973 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_payments"
[0m11:37:03.988924 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_payments"} */
DROP table /*+ IF EXISTS */ "demo_user"."sim_payments__dbt_backup";
[0m11:37:04.284027 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 18 in 0.294 seconds
[0m11:37:04.288163 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_payments: Close
[0m11:37:04.351889 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5126206d0>]}
[0m11:37:04.354339 [info ] [Thread-1  ]: 10 of 18 OK created sql incremental model demo_user.sim_payments ............... [[32mactivity: Insert, rows_affected: 113[0m in 1.91s]
[0m11:37:04.355435 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.sim_payments
[0m11:37:04.355867 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_customers
[0m11:37:04.356359 [info ] [Thread-1  ]: 11 of 18 START sql incremental model demo_user.lim_customers ................... [RUN]
[0m11:37:04.357058 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.sim_payments, now model.jaffle_shop_teradata.lim_customers)
[0m11:37:04.357671 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_customers
[0m11:37:04.383765 [debug] [Thread-1  ]: use_qvci set to : false
[0m11:37:04.384602 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:37:04.385430 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        WHEN ColumnsV.ColumnType = 'JN' THEN 'JSON'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType in (1, 2) THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'sim_customers' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
[0m11:37:04.386229 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:05.050488 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:37:05.053004 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:37:05.434555 [debug] [Thread-1  ]: SQL status: activity: Select, rows_affected: 5 in 1.047 seconds
[0m11:37:05.446851 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_customers"
[0m11:37:05.463959 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_customers
[0m11:37:05.469126 [debug] [Thread-1  ]: Setting query_band
[0m11:37:05.479440 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:37:05.480086 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

        insert into "demo_user"."key_customer"
    select
        rank() over(partition by domain_cd order by customer_nk) (integer) customer_key 
        ,nk (varchar(10000)) customer_nk
        ,domain_cd (char(100)) domain_cd
        ,current_timestamp created_ts
    from 
    (
        select coalesce(trim(email), '') nk
        , 'retail' domain_cd 
        from "demo_user"."sim_customers"
        group by 1,2
    ) source
    where not exists
    (sel 1 from  "demo_user"."key_customer" k where k.customer_nk=source.nk and k.domain_cd=source.domain_cd )
      
[0m11:37:05.818674 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 100 in 0.337 seconds
[0m11:37:05.825896 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:37:05.827016 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

        insert into "demo_user"."key_customer"
    select
        rank() over(partition by domain_cd order by customer_nk) (integer) customer_key 
        ,nk (varchar(10000)) customer_nk
        ,domain_cd (char(100)) domain_cd
        ,current_timestamp created_ts
    from 
    (
        select coalesce(trim(last_name), '') nk
        , 'families' domain_cd 
        from "demo_user"."sim_customers"
        group by 1,2
    ) source
    where not exists
    (sel 1 from  "demo_user"."key_customer" k where k.customer_nk=source.nk and k.domain_cd=source.domain_cd )
      
[0m11:37:06.228578 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 85 in 0.400 seconds
[0m11:37:06.239123 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:37:06.239990 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */
DROP table /*+ IF EXISTS */ "demo_user"."lim_customers__dbt_backup";
[0m11:37:06.284792 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1106] [Teradata Database] [Error 3807] Object 'demo_user.lim_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:37:06.294174 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:37:06.294989 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

    DROP table /*+ IF EXISTS */ "demo_user"."lim_customers__dbt_backup";
  
[0m11:37:06.339529 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1106] [Teradata Database] [Error 3807] Object 'demo_user.lim_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:37:06.348233 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:37:06.349775 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

    RENAME table "demo_user"."lim_customers" TO "demo_user"."lim_customers__dbt_backup"
  
[0m11:37:06.582885 [debug] [Thread-1  ]: SQL status: activity: Rename Table, rows_affected: 3 in 0.231 seconds
[0m11:37:06.588250 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:37:06.589471 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

      CREATE  TABLE
      "demo_user"."lim_customers"
      AS (
            /*
  Build a light integrated modeled layer from source image 
  for entity `customers`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
  - Surrogate key assigment
  - Naming conventions alignment
*/










with source as
(
  select
  s.*
  from "demo_user"."sim_customers" s
  where valid_period contains current_timestamp
)
select
    --Value columns
      customer_id,
      first_name,
      email,
      valid_period
    --Surrogate key columns
    ,coalesce(customer.customer_key,-1) customer_key
    ,coalesce(family.customer_key,-1) family_key
from source s
--Surrogate key joins
left join "demo_user"."key_customer" customer
  on customer.customer_nk=coalesce(trim(email), '')
  and customer.domain_cd='retail'

left join "demo_user"."key_customer" family
  on family.customer_nk=coalesce(trim(last_name), '')
  and family.domain_cd='families'



        ) WITH NO DATA
      
      ;
    
[0m11:37:06.947029 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.356 seconds
[0m11:37:06.951796 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.lim_customers"
[0m11:37:06.969046 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:37:06.970937 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

   
  
    
    

    INSERT INTO "demo_user"."lim_customers"
          /*
  Build a light integrated modeled layer from source image 
  for entity `customers`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
  - Surrogate key assigment
  - Naming conventions alignment
*/










with source as
(
  select
  s.*
  from "demo_user"."sim_customers" s
  where valid_period contains current_timestamp
)
select
    --Value columns
      customer_id,
      first_name,
      email,
      valid_period
    --Surrogate key columns
    ,coalesce(customer.customer_key,-1) customer_key
    ,coalesce(family.customer_key,-1) family_key
from source s
--Surrogate key joins
left join "demo_user"."key_customer" customer
  on customer.customer_nk=coalesce(trim(email), '')
  and customer.domain_cd='retail'

left join "demo_user"."key_customer" family
  on family.customer_nk=coalesce(trim(last_name), '')
  and family.domain_cd='families'



    ;
  

  

[0m11:37:07.185712 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 100 in 0.213 seconds
[0m11:37:07.196512 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m11:37:07.197366 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */
DROP table /*+ IF EXISTS */ "demo_user"."lim_customers__dbt_backup";
[0m11:37:07.496114 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 20 in 0.297 seconds
[0m11:37:07.501110 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: Close
[0m11:37:07.575335 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5127d0310>]}
[0m11:37:07.578070 [info ] [Thread-1  ]: 11 of 18 OK created sql incremental model demo_user.lim_customers .............. [[32mactivity: Insert, rows_affected: 100[0m in 3.22s]
[0m11:37:07.579500 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_customers
[0m11:37:07.580509 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_orders
[0m11:37:07.581825 [info ] [Thread-1  ]: 12 of 18 START sql incremental model demo_user.lim_orders ...................... [RUN]
[0m11:37:07.582908 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.lim_customers, now model.jaffle_shop_teradata.lim_orders)
[0m11:37:07.583640 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_orders
[0m11:37:07.598699 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_orders"
[0m11:37:07.613609 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_orders
[0m11:37:07.617613 [debug] [Thread-1  ]: Setting query_band
[0m11:37:07.621372 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_orders"
[0m11:37:07.621922 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_orders"} */

        insert into "demo_user"."key_customer"
    select
        rank() over(partition by domain_cd order by customer_nk) (integer) customer_key 
        ,nk (varchar(10000)) customer_nk
        ,domain_cd (char(100)) domain_cd
        ,current_timestamp created_ts
    from 
    (
        select coalesce(trim(email), '') nk
        , 'retail' domain_cd 
        from "demo_user"."sim_customers"
        group by 1,2
    ) source
    where not exists
    (sel 1 from  "demo_user"."key_customer" k where k.customer_nk=source.nk and k.domain_cd=source.domain_cd )
      
[0m11:37:07.622388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:08.289303 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:37:08.292031 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:37:08.609519 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 0 in 0.986 seconds
[0m11:37:08.623400 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_orders"
[0m11:37:08.624274 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_orders"} */
DROP table /*+ IF EXISTS */ "demo_user"."lim_orders__dbt_backup";
[0m11:37:08.668899 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1107] [Teradata Database] [Error 3807] Object 'demo_user.lim_orders__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:37:08.677619 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_orders"
[0m11:37:08.678384 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_orders"} */

    DROP table /*+ IF EXISTS */ "demo_user"."lim_orders__dbt_backup";
  
[0m11:37:08.723065 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1107] [Teradata Database] [Error 3807] Object 'demo_user.lim_orders__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:37:08.725956 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_orders"
[0m11:37:08.726560 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_orders"} */

    RENAME table "demo_user"."lim_orders" TO "demo_user"."lim_orders__dbt_backup"
  
[0m11:37:08.960344 [debug] [Thread-1  ]: SQL status: activity: Rename Table, rows_affected: 2 in 0.232 seconds
[0m11:37:08.964575 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_orders"
[0m11:37:08.965638 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_orders"} */

      CREATE  TABLE
      "demo_user"."lim_orders"
      AS (
            /*
  Build a light integrated modeled layer from source image 
  for entity `orders`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
  - Surrogate key assigment
  - Naming conventions alignment
*/

with source as
(
  select
  s.*  
  ,coalesce(c.email,'UNKNOWN') email
  from "demo_user"."sim_orders" s
  left join "demo_user"."sim_customers" c
    on c.customer_id=s.user_id
    and c.valid_period contains current_timestamp
)
select
    s.*
    --Surrogate key columns
    ,coalesce(customer.customer_key,-1) customer_key
from source s
--Surrogate key joins
left join "demo_user"."key_customer" customer
  on customer.customer_nk=coalesce(trim(email), '')
  and customer.domain_cd='retail'

        ) WITH NO DATA
      
      ;
    
[0m11:37:09.325687 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.358 seconds
[0m11:37:09.330393 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.lim_orders"
[0m11:37:09.338823 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_orders"
[0m11:37:09.340123 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_orders"} */

   
  
    
    

    INSERT INTO "demo_user"."lim_orders"
          /*
  Build a light integrated modeled layer from source image 
  for entity `orders`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
  - Surrogate key assigment
  - Naming conventions alignment
*/

with source as
(
  select
  s.*  
  ,coalesce(c.email,'UNKNOWN') email
  from "demo_user"."sim_orders" s
  left join "demo_user"."sim_customers" c
    on c.customer_id=s.user_id
    and c.valid_period contains current_timestamp
)
select
    s.*
    --Surrogate key columns
    ,coalesce(customer.customer_key,-1) customer_key
from source s
--Surrogate key joins
left join "demo_user"."key_customer" customer
  on customer.customer_nk=coalesce(trim(email), '')
  and customer.domain_cd='retail'

    ;
  

  

[0m11:37:09.553173 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 99 in 0.211 seconds
[0m11:37:09.564544 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_orders"
[0m11:37:09.565442 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_orders"} */
DROP table /*+ IF EXISTS */ "demo_user"."lim_orders__dbt_backup";
[0m11:37:09.884093 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 20 in 0.317 seconds
[0m11:37:09.891966 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_orders: Close
[0m11:37:09.955207 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa512765100>]}
[0m11:37:09.958269 [info ] [Thread-1  ]: 12 of 18 OK created sql incremental model demo_user.lim_orders ................. [[32mactivity: Insert, rows_affected: 99[0m in 2.37s]
[0m11:37:09.960379 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_orders
[0m11:37:09.961673 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_payments
[0m11:37:09.962858 [info ] [Thread-1  ]: 13 of 18 START sql view model demo_user.lim_payments ........................... [RUN]
[0m11:37:09.964078 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.lim_orders, now model.jaffle_shop_teradata.lim_payments)
[0m11:37:09.964828 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_payments
[0m11:37:09.972435 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_payments"
[0m11:37:09.987190 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_payments
[0m11:37:09.991298 [debug] [Thread-1  ]: Setting query_band
[0m11:37:09.994577 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.lim_payments"
[0m11:37:10.003384 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_payments"
[0m11:37:10.003992 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_payments"} */

  

  
  REPLACE VIEW "demo_user"."lim_payments__dbt_tmp" AS
    /*
  Build a light integrated modeled layer from source image 
  for entity `payments`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
  - Naming conventions alignment
*/

sel
  id as payment_id,
  order_id,
  payment_method,
  --`amount` is currently stored in cents, so we convert it to dollars
  amount / 100 as amount_usd
  from "demo_user"."sim_payments" s


[0m11:37:10.004472 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:10.671720 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:37:10.673933 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:37:10.973656 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 0.968 seconds
[0m11:37:10.984301 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_payments"
[0m11:37:10.985100 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_payments"} */

    DROP view /*+ IF EXISTS */ "demo_user"."lim_payments__dbt_backup";
  
[0m11:37:11.030203 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1108] [Teradata Database] [Error 3807] Object 'demo_user.lim_payments__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:37:11.034246 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_payments"
[0m11:37:11.035228 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_payments"} */

    RENAME view "demo_user"."lim_payments" TO "demo_user"."lim_payments__dbt_backup"
  
[0m11:37:11.205790 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.169 seconds
[0m11:37:11.217982 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_payments"
[0m11:37:11.218771 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_payments"} */

    DROP view /*+ IF EXISTS */ "demo_user"."lim_payments";
  
[0m11:37:11.263124 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1108] [Teradata Database] [Error 3807] Object 'demo_user.lim_payments' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:37:11.267238 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_payments"
[0m11:37:11.268372 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_payments"} */

    RENAME view "demo_user"."lim_payments__dbt_tmp" TO "demo_user"."lim_payments"
  
[0m11:37:11.460718 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.190 seconds
[0m11:37:11.471888 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_payments"
[0m11:37:11.472681 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_payments"} */
DROP view /*+ IF EXISTS */ "demo_user"."lim_payments__dbt_backup";
[0m11:37:11.643172 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 10 in 0.169 seconds
[0m11:37:11.647497 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_payments: Close
[0m11:37:11.717893 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa512825280>]}
[0m11:37:11.722681 [info ] [Thread-1  ]: 13 of 18 OK created sql view model demo_user.lim_payments ...................... [[32mactivity: Create View, rows_affected: 0[0m in 1.75s]
[0m11:37:11.724196 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_payments
[0m11:37:11.726224 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.customer_lifetime_value
[0m11:37:11.727725 [info ] [Thread-1  ]: 14 of 18 START sql incremental model demo_user.customer_lifetime_value ......... [RUN]
[0m11:37:11.728741 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.lim_payments, now model.jaffle_shop_teradata.customer_lifetime_value)
[0m11:37:11.729470 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.customer_lifetime_value
[0m11:37:11.739216 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.customer_lifetime_value"
[0m11:37:11.753203 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.customer_lifetime_value
[0m11:37:11.756992 [debug] [Thread-1  ]: Setting query_band
[0m11:37:11.762444 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer_lifetime_value"
[0m11:37:11.763071 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer_lifetime_value"} */
DROP table /*+ IF EXISTS */ "demo_user"."customer_lifetime_value__dbt_backup";
[0m11:37:11.763562 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:12.414707 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:37:12.417554 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:37:12.461507 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1109] [Teradata Database] [Error 3807] Object 'demo_user.customer_lifetime_value__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:37:12.469387 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer_lifetime_value"
[0m11:37:12.470086 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer_lifetime_value"} */

    DROP table /*+ IF EXISTS */ "demo_user"."customer_lifetime_value__dbt_backup";
  
[0m11:37:12.513736 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1109] [Teradata Database] [Error 3807] Object 'demo_user.customer_lifetime_value__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:37:12.516584 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer_lifetime_value"
[0m11:37:12.517469 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer_lifetime_value"} */

    RENAME table "demo_user"."customer_lifetime_value" TO "demo_user"."customer_lifetime_value__dbt_backup"
  
[0m11:37:12.730324 [debug] [Thread-1  ]: SQL status: activity: Rename Table, rows_affected: 3 in 0.211 seconds
[0m11:37:12.736032 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer_lifetime_value"
[0m11:37:12.737342 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer_lifetime_value"} */

      CREATE  TABLE
      "demo_user"."customer_lifetime_value"
      AS (
            



select
    orders.customer_key,
    --Full load: compute the historical customer value history    
    sum(sum(amount_usd)) over(partition by orders.customer_key order by order_date ROWS UNBOUNDED PRECEDING) total_amount_usd,
    period(
        order_date, 
        coalesce(lead(order_date) over(partition by orders.customer_key order by order_date) , ('9999-12-31' (date)))
        ) valid_period

from "demo_user"."lim_payments" payments
left join  "demo_user"."lim_orders" orders on payments.order_id = orders.id


group by orders.customer_key, order_date

        ) WITH NO DATA
      
      ;
    
[0m11:37:13.031305 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.292 seconds
[0m11:37:13.036110 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.customer_lifetime_value"
[0m11:37:13.051690 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer_lifetime_value"
[0m11:37:13.053498 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer_lifetime_value"} */

   
  
    
    

    INSERT INTO "demo_user"."customer_lifetime_value"
          



select
    orders.customer_key,
    --Full load: compute the historical customer value history    
    sum(sum(amount_usd)) over(partition by orders.customer_key order by order_date ROWS UNBOUNDED PRECEDING) total_amount_usd,
    period(
        order_date, 
        coalesce(lead(order_date) over(partition by orders.customer_key order by order_date) , ('9999-12-31' (date)))
        ) valid_period

from "demo_user"."lim_payments" payments
left join  "demo_user"."lim_orders" orders on payments.order_id = orders.id


group by orders.customer_key, order_date

    ;
  

  

[0m11:37:13.308161 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 99 in 0.253 seconds
[0m11:37:13.321273 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.customer_lifetime_value"
[0m11:37:13.322126 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.customer_lifetime_value"} */
DROP table /*+ IF EXISTS */ "demo_user"."customer_lifetime_value__dbt_backup";
[0m11:37:13.637687 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 17 in 0.314 seconds
[0m11:37:13.642750 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.customer_lifetime_value: Close
[0m11:37:13.713398 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5121fcc40>]}
[0m11:37:13.714952 [info ] [Thread-1  ]: 14 of 18 OK created sql incremental model demo_user.customer_lifetime_value .... [[32mactivity: Insert, rows_affected: 99[0m in 1.98s]
[0m11:37:13.716333 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.customer_lifetime_value
[0m11:37:13.717297 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.dim_payment_method
[0m11:37:13.718747 [info ] [Thread-1  ]: 15 of 18 START sql view model demo_user.dim_payment_method ..................... [RUN]
[0m11:37:13.719741 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.customer_lifetime_value, now model.jaffle_shop_teradata.dim_payment_method)
[0m11:37:13.720445 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.dim_payment_method
[0m11:37:13.726776 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.dim_payment_method"
[0m11:37:13.750051 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.dim_payment_method
[0m11:37:13.754886 [debug] [Thread-1  ]: Setting query_band
[0m11:37:13.758119 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.dim_payment_method"
[0m11:37:13.765987 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_payment_method"
[0m11:37:13.766677 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_payment_method"} */

  

  
  REPLACE VIEW "demo_user"."dim_payment_method__dbt_tmp" AS
    with payments as (

    select * from "demo_user"."lim_payments"

),

final as (

    select
        payment_method
        ,sum(amount_usd) as total_amount
        ,count(1) as frequency_count
    from payments
    group by 1

)

select * from final


[0m11:37:13.767259 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:14.447243 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:37:14.450218 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:37:14.725961 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 0.958 seconds
[0m11:37:14.732851 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_payment_method"
[0m11:37:14.733309 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_payment_method"} */

    DROP view /*+ IF EXISTS */ "demo_user"."dim_payment_method__dbt_backup";
  
[0m11:37:14.776875 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1110] [Teradata Database] [Error 3807] Object 'demo_user.dim_payment_method__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:37:14.781068 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_payment_method"
[0m11:37:14.782085 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_payment_method"} */

    RENAME view "demo_user"."dim_payment_method" TO "demo_user"."dim_payment_method__dbt_backup"
  
[0m11:37:14.971080 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.187 seconds
[0m11:37:14.980347 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_payment_method"
[0m11:37:14.981126 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_payment_method"} */

    DROP view /*+ IF EXISTS */ "demo_user"."dim_payment_method";
  
[0m11:37:15.025898 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1110] [Teradata Database] [Error 3807] Object 'demo_user.dim_payment_method' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:37:15.030593 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_payment_method"
[0m11:37:15.031562 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_payment_method"} */

    RENAME view "demo_user"."dim_payment_method__dbt_tmp" TO "demo_user"."dim_payment_method"
  
[0m11:37:15.201780 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.169 seconds
[0m11:37:15.213534 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_payment_method"
[0m11:37:15.214294 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_payment_method"} */
DROP view /*+ IF EXISTS */ "demo_user"."dim_payment_method__dbt_backup";
[0m11:37:15.406299 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 9 in 0.190 seconds
[0m11:37:15.412845 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_payment_method: Close
[0m11:37:15.481187 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa512600820>]}
[0m11:37:15.483926 [info ] [Thread-1  ]: 15 of 18 OK created sql view model demo_user.dim_payment_method ................ [[32mactivity: Create View, rows_affected: 0[0m in 1.76s]
[0m11:37:15.485621 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.dim_payment_method
[0m11:37:15.486657 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.order_payments
[0m11:37:15.487931 [info ] [Thread-1  ]: 16 of 18 START sql view model demo_user.order_payments ......................... [RUN]
[0m11:37:15.489077 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.dim_payment_method, now model.jaffle_shop_teradata.order_payments)
[0m11:37:15.489797 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.order_payments
[0m11:37:15.497627 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.order_payments"
[0m11:37:15.517769 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.order_payments
[0m11:37:15.521917 [debug] [Thread-1  ]: Setting query_band
[0m11:37:15.525275 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.order_payments"
[0m11:37:15.534640 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.order_payments"
[0m11:37:15.535316 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.order_payments"} */

  

  
  REPLACE VIEW "demo_user"."order_payments__dbt_tmp" AS
    

with payments as (

    select * from "demo_user"."lim_payments"

),

final as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount_usd else 0 end) as credit_card_amount_usd,
        sum(case when payment_method = 'coupon' then amount_usd else 0 end) as coupon_amount_usd,
        sum(case when payment_method = 'bank_transfer' then amount_usd else 0 end) as bank_transfer_amount_usd,
        sum(case when payment_method = 'gift_card' then amount_usd else 0 end) as gift_card_amount_usd,
        sum(amount_usd) as total_amount_usd

    from payments

    group by 1

)

select * from final


[0m11:37:15.535929 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:16.236012 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:37:16.238720 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:37:16.555429 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 1.018 seconds
[0m11:37:16.566287 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.order_payments"
[0m11:37:16.567159 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.order_payments"} */

    DROP view /*+ IF EXISTS */ "demo_user"."order_payments__dbt_backup";
  
[0m11:37:16.612204 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1111] [Teradata Database] [Error 3807] Object 'demo_user.order_payments__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:37:16.616436 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.order_payments"
[0m11:37:16.617417 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.order_payments"} */

    RENAME view "demo_user"."order_payments" TO "demo_user"."order_payments__dbt_backup"
  
[0m11:37:16.789726 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.171 seconds
[0m11:37:16.796445 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.order_payments"
[0m11:37:16.796947 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.order_payments"} */

    DROP view /*+ IF EXISTS */ "demo_user"."order_payments";
  
[0m11:37:16.840660 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1111] [Teradata Database] [Error 3807] Object 'demo_user.order_payments' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:37:16.845103 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.order_payments"
[0m11:37:16.846128 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.order_payments"} */

    RENAME view "demo_user"."order_payments__dbt_tmp" TO "demo_user"."order_payments"
  
[0m11:37:17.057414 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.210 seconds
[0m11:37:17.068080 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.order_payments"
[0m11:37:17.068842 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.order_payments"} */
DROP view /*+ IF EXISTS */ "demo_user"."order_payments__dbt_backup";
[0m11:37:17.301703 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 12 in 0.231 seconds
[0m11:37:17.306391 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.order_payments: Close
[0m11:37:17.376548 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51274d2b0>]}
[0m11:37:17.379230 [info ] [Thread-1  ]: 16 of 18 OK created sql view model demo_user.order_payments .................... [[32mactivity: Create View, rows_affected: 0[0m in 1.89s]
[0m11:37:17.380754 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.order_payments
[0m11:37:17.381771 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.dim_customers
[0m11:37:17.383076 [info ] [Thread-1  ]: 17 of 18 START sql view model demo_user.dim_customers .......................... [RUN]
[0m11:37:17.384322 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.order_payments, now model.jaffle_shop_teradata.dim_customers)
[0m11:37:17.385095 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.dim_customers
[0m11:37:17.394615 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.dim_customers"
[0m11:37:17.405960 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.dim_customers
[0m11:37:17.460548 [debug] [Thread-1  ]: Setting query_band
[0m11:37:17.462299 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.dim_customers"
[0m11:37:17.469638 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_customers"
[0m11:37:17.470000 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_customers"} */

  

  
  REPLACE VIEW "demo_user"."dim_customers__dbt_tmp" AS
    with customers as (
    
    select * from "demo_user"."key_customer"
    where domain_cd in ('retail', 'business')

),

customer_orders as (
    
    select
        customer_key,
        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(id) as number_of_orders
    from "demo_user"."lim_orders"
    group by 1

),

customer_lifetime_value as (
     
    select * from "demo_user"."customer_lifetime_value"
    where customer_lifetime_value.valid_period contains current_date

),

final as (

    select
        customers.customer_key,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_lifetime_value.total_amount_usd as customer_lifetime_value

    from customers

    left join customer_orders on customers.customer_key = customer_orders.customer_key
    left join customer_lifetime_value on customers.customer_key = customer_lifetime_value.customer_key

)

select * from final


[0m11:37:17.470335 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:18.132568 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:37:18.135907 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:37:18.619372 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 1.148 seconds
[0m11:37:18.630182 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_customers"
[0m11:37:18.631117 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_customers"} */

    DROP view /*+ IF EXISTS */ "demo_user"."dim_customers";
  
[0m11:37:18.677625 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1112] [Teradata Database] [Error 3807] Object 'demo_user.dim_customers' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:37:18.680970 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_customers"
[0m11:37:18.681888 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_customers"} */

    RENAME view "demo_user"."dim_customers__dbt_tmp" TO "demo_user"."dim_customers"
  
[0m11:37:18.893927 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.211 seconds
[0m11:37:18.900995 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.dim_customers"
[0m11:37:18.901490 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.dim_customers"} */
DROP view /*+ IF EXISTS */ "demo_user"."dim_customers__dbt_backup";
[0m11:37:18.945576 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1112] [Teradata Database] [Error 3807] Object 'demo_user.dim_customers__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:37:18.950601 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.dim_customers: Close
[0m11:37:19.049991 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51286a730>]}
[0m11:37:19.052874 [info ] [Thread-1  ]: 17 of 18 OK created sql view model demo_user.dim_customers ..................... [[32mactivity: Create View, rows_affected: 0[0m in 1.67s]
[0m11:37:19.054405 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.dim_customers
[0m11:37:19.055340 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.fct_orders
[0m11:37:19.056701 [info ] [Thread-1  ]: 18 of 18 START sql view model demo_user.fct_orders ............................. [RUN]
[0m11:37:19.057949 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.dim_customers, now model.jaffle_shop_teradata.fct_orders)
[0m11:37:19.058840 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.fct_orders
[0m11:37:19.067367 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.fct_orders"
[0m11:37:19.088295 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.fct_orders
[0m11:37:19.093341 [debug] [Thread-1  ]: Setting query_band
[0m11:37:19.096760 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.fct_orders"
[0m11:37:19.107846 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.fct_orders"
[0m11:37:19.108540 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.fct_orders"} */

  

  
  REPLACE VIEW "demo_user"."fct_orders__dbt_tmp" AS
    

with orders as (

    select * from "demo_user"."lim_orders"

),

order_payments as (

    select * from "demo_user"."order_payments"

),

final as (

    select
        orders.customer_key,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount_usd,

        order_payments.coupon_amount_usd,

        order_payments.bank_transfer_amount_usd,

        order_payments.gift_card_amount_usd,

        order_payments.total_amount_usd as amount

    from orders

    left join order_payments on orders.id = order_payments.order_id

)

select * from final


[0m11:37:19.109148 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:19.831748 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:37:19.834436 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m11:37:20.319918 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 1.210 seconds
[0m11:37:20.333019 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.fct_orders"
[0m11:37:20.333924 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.fct_orders"} */

    DROP view /*+ IF EXISTS */ "demo_user"."fct_orders__dbt_backup";
  
[0m11:37:20.380160 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1113] [Teradata Database] [Error 3807] Object 'demo_user.fct_orders__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:37:20.383795 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.fct_orders"
[0m11:37:20.384792 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.fct_orders"} */

    RENAME view "demo_user"."fct_orders" TO "demo_user"."fct_orders__dbt_backup"
  
[0m11:37:20.596022 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.209 seconds
[0m11:37:20.606217 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.fct_orders"
[0m11:37:20.607123 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.fct_orders"} */

    DROP view /*+ IF EXISTS */ "demo_user"."fct_orders";
  
[0m11:37:20.651629 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1113] [Teradata Database] [Error 3807] Object 'demo_user.fct_orders' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m11:37:20.655741 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.fct_orders"
[0m11:37:20.656739 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.fct_orders"} */

    RENAME view "demo_user"."fct_orders__dbt_tmp" TO "demo_user"."fct_orders"
  
[0m11:37:20.848968 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.190 seconds
[0m11:37:20.859984 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.fct_orders"
[0m11:37:20.860884 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.fct_orders"} */
DROP view /*+ IF EXISTS */ "demo_user"."fct_orders__dbt_backup";
[0m11:37:21.112923 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 14 in 0.251 seconds
[0m11:37:21.118061 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.fct_orders: Close
[0m11:37:21.184734 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00936665-6b0a-4da0-be9d-7e7c10fb10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5126f15b0>]}
[0m11:37:21.187948 [info ] [Thread-1  ]: 18 of 18 OK created sql view model demo_user.fct_orders ........................ [[32mactivity: Create View, rows_affected: 0[0m in 2.13s]
[0m11:37:21.189509 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.fct_orders
[0m11:37:21.192129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:21.192820 [debug] [MainThread]: Connection 'model.jaffle_shop_teradata.fct_orders' was properly closed.
[0m11:37:21.193708 [info ] [MainThread]: 
[0m11:37:21.194357 [info ] [MainThread]: Finished running 7 incremental models, 11 view models in 0 hours 0 minutes and 59.13 seconds (59.13s).
[0m11:37:21.199678 [debug] [MainThread]: Command end result
[0m11:37:21.268867 [info ] [MainThread]: 
[0m11:37:21.269347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:37:21.269663 [info ] [MainThread]: 
[0m11:37:21.269970 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m11:37:21.279838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 60.744476, "process_user_time": 5.514683, "process_kernel_time": 0.956341, "process_mem_max_rss": "129794048", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:37:21.280313 [debug] [MainThread]: Command `dbt run` succeeded at 11:37:21.280227 after 60.75 seconds
[0m11:37:21.280678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f038e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa500239c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4c00d0970>]}
[0m11:37:21.281023 [debug] [MainThread]: Flushing usage events
[0m17:09:27.335305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe8c50670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe9b01eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe9b013a0>]}


============================== 17:09:27.354080 | e1bd1eaa-7c63-4638-98ee-2f45af975359 ==============================
[0m17:09:27.354080 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:09:27.354760 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/remi.turpaud/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m17:09:28.701822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1bd1eaa-7c63-4638-98ee-2f45af975359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe8d8f760>]}
[0m17:09:28.747465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1bd1eaa-7c63-4638-98ee-2f45af975359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe03ad370>]}
[0m17:09:28.757889 [info ] [MainThread]: Registered adapter: teradata=1.8.0
[0m17:09:28.801146 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:09:29.038657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:09:29.039164 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:09:29.045380 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.staging
- models.jaffle_shop
[0m17:09:29.107376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1bd1eaa-7c63-4638-98ee-2f45af975359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd8b97130>]}
[0m17:09:29.308353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1bd1eaa-7c63-4638-98ee-2f45af975359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd8baffd0>]}
[0m17:09:29.308991 [info ] [MainThread]: Found 19 models, 1 snapshot, 3 seeds, 8 data tests, 2 sources, 572 macros
[0m17:09:29.309368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1bd1eaa-7c63-4638-98ee-2f45af975359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd8baf220>]}
[0m17:09:29.310816 [info ] [MainThread]: 
[0m17:09:29.311406 [debug] [MainThread]: Acquiring new teradata connection 'master'
[0m17:09:29.312446 [debug] [ThreadPool]: Acquiring new teradata connection 'list_schemas'
[0m17:09:29.325335 [debug] [ThreadPool]: Using teradata connection "list_schemas"
[0m17:09:29.325901 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_schemas"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
[0m17:09:29.326262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:40.855867 [debug] [ThreadPool]: teradata adapter: Got a retryable error when attempting to open a teradata connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
[Version 20.0.0.15] [Session 0] [Teradata SQL Driver] Failed to connect to dbt-testing-vikzqtnd0db0nglk.env.clearscape.teradata.com
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).makeDriverError ErrorUtil.go:193
 at gosqldriver/teradatasql.connectToHost LCC.go:249
 at gosqldriver/teradatasql.newTeradataConnection TeradataConnection.go:155
 at gosqldriver/teradatasql.(*teradataDriver).Open TeradataDriver.go:32
 at database/sql.dsnConnector.Connect sql.go:791
 at database/sql.(*DB).conn sql.go:1415
 at database/sql.(*DB).Conn.func1 sql.go:1940
 at database/sql.(*DB).retry sql.go:1566
 at database/sql.(*DB).Conn sql.go:1939
 at main.goCreateConnection goside.go:298
 at _cgoexp_97cde1c53cf8_goCreateConnection _cgo_gotypes.go:265
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
Caused by dial tcp 35.242.247.163:1025: i/o timeout
[0m17:09:52.873612 [debug] [ThreadPool]: teradata adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_schemas"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
[0m17:09:52.875001 [debug] [ThreadPool]: teradata adapter: Rolling back transaction.
[0m17:09:52.876159 [debug] [ThreadPool]: teradata adapter: Error running SQL: macro list_schemas
[0m17:09:52.876888 [debug] [ThreadPool]: teradata adapter: Rolling back transaction.
[0m17:09:52.877673 [debug] [ThreadPool]: On list_schemas: No close available on handle
[0m17:09:52.879332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:52.880060 [debug] [MainThread]: Connection 'list_schemas' was properly closed.
[0m17:09:52.881141 [info ] [MainThread]: 
[0m17:09:52.882042 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 23.57 seconds (23.57s).
[0m17:09:52.883988 [error] [MainThread]: Encountered an error:
Database Error
  [Version 20.0.0.15] [Session 0] [Teradata SQL Driver] Failed to connect to dbt-testing-vikzqtnd0db0nglk.env.clearscape.teradata.com
   at gosqldriver/teradatasql.formatError ErrorUtil.go:91
   at gosqldriver/teradatasql.(*teradataConnection).makeDriverError ErrorUtil.go:193
   at gosqldriver/teradatasql.connectToHost LCC.go:249
   at gosqldriver/teradatasql.newTeradataConnection TeradataConnection.go:155
   at gosqldriver/teradatasql.(*teradataDriver).Open TeradataDriver.go:32
   at database/sql.dsnConnector.Connect sql.go:791
   at database/sql.(*DB).conn sql.go:1415
   at database/sql.(*DB).Conn.func1 sql.go:1940
   at database/sql.(*DB).retry sql.go:1566
   at database/sql.(*DB).Conn sql.go:1939
   at main.goCreateConnection goside.go:298
   at _cgoexp_97cde1c53cf8_goCreateConnection _cgo_gotypes.go:265
   at runtime.cgocallbackg1 cgocall.go:420
   at runtime.cgocallbackg cgocall.go:339
   at runtime.cgocallback asm_amd64.s:1079
   at runtime.goexit asm_amd64.s:1695
  Caused by dial tcp 35.242.247.163:1025: i/o timeout
[0m17:09:52.922170 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 25.718445, "process_user_time": 1.842791, "process_kernel_time": 0.444509, "process_mem_max_rss": "115286016", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:09:52.923087 [debug] [MainThread]: Command `cli run` failed at 17:09:52.922965 after 25.72 seconds
[0m17:09:52.923609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe8c50670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfea182c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfea1f37f0>]}
[0m17:09:52.924083 [debug] [MainThread]: Flushing usage events
[0m17:10:04.829045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0a84c0640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe068301f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe068301310>]}


============================== 17:10:04.836504 | 69973de6-63bd-4c6a-bea5-39ae33e7475d ==============================
[0m17:10:04.836504 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:10:04.837258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/remi.turpaud/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:10:05.139668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69973de6-63bd-4c6a-bea5-39ae33e7475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe06831bbe0>]}
[0m17:10:05.178653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69973de6-63bd-4c6a-bea5-39ae33e7475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe088255250>]}
[0m17:10:05.179862 [info ] [MainThread]: Registered adapter: teradata=1.8.0
[0m17:10:05.216390 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:10:05.471417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:10:05.471926 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:10:05.478421 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.staging
- models.jaffle_shop
[0m17:10:05.541264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69973de6-63bd-4c6a-bea5-39ae33e7475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe09a878130>]}
[0m17:10:05.703352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69973de6-63bd-4c6a-bea5-39ae33e7475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe068395af0>]}
[0m17:10:05.704036 [info ] [MainThread]: Found 19 models, 1 snapshot, 3 seeds, 8 data tests, 2 sources, 572 macros
[0m17:10:05.704440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69973de6-63bd-4c6a-bea5-39ae33e7475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe09a897760>]}
[0m17:10:05.706060 [info ] [MainThread]: 
[0m17:10:05.706702 [debug] [MainThread]: Acquiring new teradata connection 'master'
[0m17:10:05.707647 [debug] [ThreadPool]: Acquiring new teradata connection 'list_schemas'
[0m17:10:05.720804 [debug] [ThreadPool]: Using teradata connection "list_schemas"
[0m17:10:05.721384 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_schemas"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
[0m17:10:05.721773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:06.475324 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:10:06.477787 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:10:06.631668 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 46 in 0.907 seconds
[0m17:10:06.638554 [debug] [ThreadPool]: On list_schemas: Close
[0m17:10:06.713123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_schemas, now list_None_rt186001)
[0m17:10:06.723663 [debug] [ThreadPool]: Using teradata connection "list_None_rt186001"
[0m17:10:06.724372 [debug] [ThreadPool]: On list_None_rt186001: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_None_rt186001"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'rt186001' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
[0m17:10:06.724881 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:07.379818 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:10:07.380349 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:10:07.549171 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 0 in 0.824 seconds
[0m17:10:07.551538 [debug] [ThreadPool]: On list_None_rt186001: Close
[0m17:10:07.609078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None_rt186001, now list_None_demo_user)
[0m17:10:07.614694 [debug] [ThreadPool]: Using teradata connection "list_None_demo_user"
[0m17:10:07.615619 [debug] [ThreadPool]: On list_None_demo_user: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_None_demo_user"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
[0m17:10:07.616286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:08.311140 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:10:08.314391 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:10:08.789393 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 22 in 1.172 seconds
[0m17:10:08.796018 [debug] [ThreadPool]: On list_None_demo_user: Close
[0m17:10:08.867003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69973de6-63bd-4c6a-bea5-39ae33e7475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe068395c70>]}
[0m17:10:08.868432 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:08.869231 [info ] [MainThread]: 
[0m17:10:08.889603 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_market_competitors
[0m17:10:08.890901 [info ] [Thread-1  ]: 1 of 1 START sql view model demo_user.lim_market_competitors ................... [RUN]
[0m17:10:08.891848 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_None_demo_user, now model.jaffle_shop_teradata.lim_market_competitors)
[0m17:10:08.892676 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_market_competitors
[0m17:10:08.905336 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:10:08.906853 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_market_competitors
[0m17:10:08.916372 [debug] [Thread-1  ]: Setting query_band
[0m17:10:08.944806 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:10:08.945395 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_competitors"} */

    create foreign table demo_user.raw_market_competitors using (location('/GS/storage.googleapis.com/clearscape_analytics_demo_data/DEMO_Market/Competitor/'));
  
[0m17:10:08.945778 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:10:09.687889 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:10:09.690408 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:10:13.833936 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 4.888 seconds
[0m17:10:13.848006 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:10:13.851718 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:10:13.852409 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_competitors"} */

  

  
  REPLACE VIEW "demo_user"."lim_market_competitors__dbt_tmp" AS
    /*
  Build a light integrated modeled layer from source image 
  for entity `market_competitors`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
*/

select *
from "demo_user"."raw_market_competitors" s


[0m17:10:14.128325 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 0.275 seconds
[0m17:10:14.134685 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:10:14.135150 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_competitors"} */

    DROP view /*+ IF EXISTS */ "demo_user"."lim_market_competitors";
  
[0m17:10:14.178002 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1144] [Teradata Database] [Error 3807] Object 'demo_user.lim_market_competitors' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m17:10:14.179414 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:10:14.179795 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_competitors"} */

    RENAME view "demo_user"."lim_market_competitors__dbt_tmp" TO "demo_user"."lim_market_competitors"
  
[0m17:10:14.397424 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.216 seconds
[0m17:10:14.494201 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:10:14.494876 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_competitors"} */
DROP view /*+ IF EXISTS */ "demo_user"."lim_market_competitors__dbt_backup";
[0m17:10:14.537371 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1144] [Teradata Database] [Error 3807] Object 'demo_user.lim_market_competitors__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m17:10:14.540451 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: Close
[0m17:10:14.618410 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69973de6-63bd-4c6a-bea5-39ae33e7475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0a83ad280>]}
[0m17:10:14.619492 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo_user.lim_market_competitors .............. [[32mactivity: Create View, rows_affected: 0[0m in 5.73s]
[0m17:10:14.620298 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_market_competitors
[0m17:10:14.621624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:14.622092 [debug] [MainThread]: Connection 'model.jaffle_shop_teradata.lim_market_competitors' was properly closed.
[0m17:10:14.622534 [info ] [MainThread]: 
[0m17:10:14.622988 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.92 seconds (8.92s).
[0m17:10:14.623795 [debug] [MainThread]: Command end result
[0m17:10:14.676771 [info ] [MainThread]: 
[0m17:10:14.677357 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:10:14.677802 [info ] [MainThread]: 
[0m17:10:14.678276 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:10:14.680806 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.939001, "process_user_time": 2.004336, "process_kernel_time": 0.319986, "process_mem_max_rss": "122925056", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:10:14.681353 [debug] [MainThread]: Command `cli run` succeeded at 17:10:14.681263 after 9.94 seconds
[0m17:10:14.681797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0a84c0640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0882e0fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0882e0df0>]}
[0m17:10:14.682191 [debug] [MainThread]: Flushing usage events
[0m17:14:50.082155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd770d6e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd790436160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd790436430>]}


============================== 17:14:50.087959 | 5df53fa7-f6d7-4f98-9cb2-64c7c81f7d45 ==============================
[0m17:14:50.087959 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:14:50.088494 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/remi.turpaud/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:14:50.388885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5df53fa7-f6d7-4f98-9cb2-64c7c81f7d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7710bac40>]}
[0m17:14:50.426294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5df53fa7-f6d7-4f98-9cb2-64c7c81f7d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7725f6520>]}
[0m17:14:50.427478 [info ] [MainThread]: Registered adapter: teradata=1.8.0
[0m17:14:50.453813 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:14:50.676820 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m17:14:50.677326 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop_teradata://models/discovery/light-integration/lim_market_competitors.sql
[0m17:14:50.774002 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop
- models.jaffle_shop.staging
[0m17:14:50.788027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5df53fa7-f6d7-4f98-9cb2-64c7c81f7d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd772d33f40>]}
[0m17:14:50.829372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5df53fa7-f6d7-4f98-9cb2-64c7c81f7d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd772d62610>]}
[0m17:14:50.829903 [info ] [MainThread]: Found 18 models, 1 snapshot, 3 seeds, 8 data tests, 2 sources, 572 macros
[0m17:14:50.830202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5df53fa7-f6d7-4f98-9cb2-64c7c81f7d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd772d62790>]}
[0m17:14:50.832240 [info ] [MainThread]: 
[0m17:14:50.832755 [debug] [MainThread]: Acquiring new teradata connection 'master'
[0m17:14:50.838385 [debug] [ThreadPool]: Acquiring new teradata connection 'list_None_demo_user'
[0m17:14:50.851222 [debug] [ThreadPool]: Using teradata connection "list_None_demo_user"
[0m17:14:50.851551 [debug] [ThreadPool]: On list_None_demo_user: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_None_demo_user"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
[0m17:14:50.851818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:51.577333 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:14:51.578342 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:14:51.796173 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 24 in 0.943 seconds
[0m17:14:51.804485 [debug] [ThreadPool]: On list_None_demo_user: Close
[0m17:14:51.867996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None_demo_user, now list_None_rt186001)
[0m17:14:51.879944 [debug] [ThreadPool]: Using teradata connection "list_None_rt186001"
[0m17:14:51.880544 [debug] [ThreadPool]: On list_None_rt186001: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_None_rt186001"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'rt186001' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
[0m17:14:51.881058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:52.592549 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:14:52.595391 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:14:52.767333 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 0 in 0.885 seconds
[0m17:14:52.772243 [debug] [ThreadPool]: On list_None_rt186001: Close
[0m17:14:52.832665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5df53fa7-f6d7-4f98-9cb2-64c7c81f7d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd79046ee50>]}
[0m17:14:52.834348 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:14:52.835109 [info ] [MainThread]: 
[0m17:14:52.845961 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.key_customer
[0m17:14:52.846975 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_None_rt186001, now model.jaffle_shop_teradata.key_customer)
[0m17:14:52.847493 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.key_customer
[0m17:14:52.858011 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.key_customer"
[0m17:14:52.861219 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.key_customer
[0m17:14:52.861887 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.key_customer
[0m17:14:52.862247 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_market_customers
[0m17:14:52.862689 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.key_customer, now model.jaffle_shop_teradata.lim_market_customers)
[0m17:14:52.863088 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_market_customers
[0m17:14:52.866481 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_market_customers"
[0m17:14:52.868766 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_market_customers
[0m17:14:52.869376 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_market_customers
[0m17:14:52.869730 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.stg_market_customers
[0m17:14:52.870085 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.lim_market_customers, now model.jaffle_shop_teradata.stg_market_customers)
[0m17:14:52.870374 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.stg_market_customers
[0m17:14:52.873513 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.stg_market_customers"
[0m17:14:52.878026 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.stg_market_customers
[0m17:14:52.878727 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.stg_market_customers
[0m17:14:52.879080 [debug] [Thread-1  ]: Began running node seed.jaffle_shop_teradata.raw_customers
[0m17:14:52.879454 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.stg_market_customers, now seed.jaffle_shop_teradata.raw_customers)
[0m17:14:52.879739 [debug] [Thread-1  ]: Began compiling node seed.jaffle_shop_teradata.raw_customers
[0m17:14:52.881759 [debug] [Thread-1  ]: Began executing node seed.jaffle_shop_teradata.raw_customers
[0m17:14:52.882350 [debug] [Thread-1  ]: Finished running node seed.jaffle_shop_teradata.raw_customers
[0m17:14:52.882674 [debug] [Thread-1  ]: Began running node seed.jaffle_shop_teradata.raw_orders
[0m17:14:52.883057 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.jaffle_shop_teradata.raw_customers, now seed.jaffle_shop_teradata.raw_orders)
[0m17:14:52.883335 [debug] [Thread-1  ]: Began compiling node seed.jaffle_shop_teradata.raw_orders
[0m17:14:52.885152 [debug] [Thread-1  ]: Began executing node seed.jaffle_shop_teradata.raw_orders
[0m17:14:52.885665 [debug] [Thread-1  ]: Finished running node seed.jaffle_shop_teradata.raw_orders
[0m17:14:52.885972 [debug] [Thread-1  ]: Began running node seed.jaffle_shop_teradata.raw_payments
[0m17:14:52.886328 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.jaffle_shop_teradata.raw_orders, now seed.jaffle_shop_teradata.raw_payments)
[0m17:14:52.886600 [debug] [Thread-1  ]: Began compiling node seed.jaffle_shop_teradata.raw_payments
[0m17:14:52.888449 [debug] [Thread-1  ]: Began executing node seed.jaffle_shop_teradata.raw_payments
[0m17:14:52.888968 [debug] [Thread-1  ]: Finished running node seed.jaffle_shop_teradata.raw_payments
[0m17:14:52.889275 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.customer
[0m17:14:52.889696 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.jaffle_shop_teradata.raw_payments, now model.jaffle_shop_teradata.customer)
[0m17:14:52.890008 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.customer
[0m17:14:52.892581 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.customer"
[0m17:14:52.894966 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.customer
[0m17:14:52.895513 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.customer
[0m17:14:52.895835 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.stg_customers
[0m17:14:52.896146 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.customer, now model.jaffle_shop_teradata.stg_customers)
[0m17:14:52.896484 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.stg_customers
[0m17:14:52.900481 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.stg_customers"
[0m17:14:52.903438 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.stg_customers
[0m17:14:52.904013 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.stg_customers
[0m17:14:52.904329 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.stg_orders
[0m17:14:52.904752 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.stg_customers, now model.jaffle_shop_teradata.stg_orders)
[0m17:14:52.905033 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.stg_orders
[0m17:14:52.908016 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.stg_orders"
[0m17:14:52.910485 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.stg_orders
[0m17:14:52.911054 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.stg_orders
[0m17:14:52.911373 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.stg_payments
[0m17:14:52.911704 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.stg_orders, now model.jaffle_shop_teradata.stg_payments)
[0m17:14:52.911980 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.stg_payments
[0m17:14:52.915127 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.stg_payments"
[0m17:14:52.917212 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.stg_payments
[0m17:14:52.917819 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.stg_payments
[0m17:14:52.918150 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.sim_customers
[0m17:14:52.918583 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.stg_payments, now model.jaffle_shop_teradata.sim_customers)
[0m17:14:52.918859 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.sim_customers
[0m17:14:52.938285 [debug] [Thread-1  ]: use_qvci set to : false
[0m17:14:52.938913 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_customers"
[0m17:14:52.939409 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_customers"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        WHEN ColumnsV.ColumnType = 'JN' THEN 'JSON'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType in (1, 2) THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'stg_customers' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
[0m17:14:52.939892 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:14:53.614349 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:14:53.617115 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:14:54.146561 [debug] [Thread-1  ]: SQL status: activity: Select, rows_affected: 5 in 1.205 seconds
[0m17:14:54.167124 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.sim_customers"
[0m17:14:54.182341 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.sim_customers
[0m17:14:54.183040 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_customers: Close
[0m17:14:54.262431 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.sim_customers
[0m17:14:54.264231 [debug] [Thread-1  ]: Began running node test.jaffle_shop_teradata.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:14:54.265902 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.sim_customers, now test.jaffle_shop_teradata.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m17:14:54.266923 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop_teradata.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:14:54.343126 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop_teradata.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:14:54.349097 [debug] [Thread-1  ]: Began executing node test.jaffle_shop_teradata.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:14:54.349826 [debug] [Thread-1  ]: Finished running node test.jaffle_shop_teradata.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:14:54.350181 [debug] [Thread-1  ]: Began running node test.jaffle_shop_teradata.unique_stg_customers_customer_id.c7614daada
[0m17:14:54.350522 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.jaffle_shop_teradata.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop_teradata.unique_stg_customers_customer_id.c7614daada)
[0m17:14:54.350879 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop_teradata.unique_stg_customers_customer_id.c7614daada
[0m17:14:54.356205 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop_teradata.unique_stg_customers_customer_id.c7614daada"
[0m17:14:54.358627 [debug] [Thread-1  ]: Began executing node test.jaffle_shop_teradata.unique_stg_customers_customer_id.c7614daada
[0m17:14:54.359242 [debug] [Thread-1  ]: Finished running node test.jaffle_shop_teradata.unique_stg_customers_customer_id.c7614daada
[0m17:14:54.359582 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.sim_orders
[0m17:14:54.359937 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.jaffle_shop_teradata.unique_stg_customers_customer_id.c7614daada, now model.jaffle_shop_teradata.sim_orders)
[0m17:14:54.360224 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.sim_orders
[0m17:14:54.366532 [debug] [Thread-1  ]: use_qvci set to : false
[0m17:14:54.367116 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.sim_orders"
[0m17:14:54.367570 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.sim_orders"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        WHEN ColumnsV.ColumnType = 'JN' THEN 'JSON'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType in (1, 2) THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'stg_orders' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
[0m17:14:54.368010 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:14:55.021582 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:14:55.023277 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:14:55.472440 [debug] [Thread-1  ]: SQL status: activity: Select, rows_affected: 5 in 1.103 seconds
[0m17:14:55.480101 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.sim_orders"
[0m17:14:55.493343 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.sim_orders
[0m17:14:55.494286 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.sim_orders: Close
[0m17:14:55.552755 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.sim_orders
[0m17:14:55.554848 [debug] [Thread-1  ]: Began running node test.jaffle_shop_teradata.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m17:14:55.556556 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.sim_orders, now test.jaffle_shop_teradata.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad)
[0m17:14:55.557561 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop_teradata.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m17:14:55.576496 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop_teradata.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m17:14:55.578823 [debug] [Thread-1  ]: Began executing node test.jaffle_shop_teradata.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m17:14:55.579867 [debug] [Thread-1  ]: Finished running node test.jaffle_shop_teradata.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m17:14:55.580467 [debug] [Thread-1  ]: Began running node test.jaffle_shop_teradata.not_null_stg_orders_order_id.81cfe2fe64
[0m17:14:55.581138 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.jaffle_shop_teradata.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad, now test.jaffle_shop_teradata.not_null_stg_orders_order_id.81cfe2fe64)
[0m17:14:55.581725 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop_teradata.not_null_stg_orders_order_id.81cfe2fe64
[0m17:14:55.587253 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop_teradata.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:14:55.588528 [debug] [Thread-1  ]: Began executing node test.jaffle_shop_teradata.not_null_stg_orders_order_id.81cfe2fe64
[0m17:14:55.589330 [debug] [Thread-1  ]: Finished running node test.jaffle_shop_teradata.not_null_stg_orders_order_id.81cfe2fe64
[0m17:14:55.589809 [debug] [Thread-1  ]: Began running node test.jaffle_shop_teradata.unique_stg_orders_order_id.e3b841c71a
[0m17:14:55.590338 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.jaffle_shop_teradata.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop_teradata.unique_stg_orders_order_id.e3b841c71a)
[0m17:14:55.590763 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop_teradata.unique_stg_orders_order_id.e3b841c71a
[0m17:14:55.597043 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop_teradata.unique_stg_orders_order_id.e3b841c71a"
[0m17:14:55.597992 [debug] [Thread-1  ]: Began executing node test.jaffle_shop_teradata.unique_stg_orders_order_id.e3b841c71a
[0m17:14:55.598722 [debug] [Thread-1  ]: Finished running node test.jaffle_shop_teradata.unique_stg_orders_order_id.e3b841c71a
[0m17:14:55.599162 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.sim_payments
[0m17:14:55.599592 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.jaffle_shop_teradata.unique_stg_orders_order_id.e3b841c71a, now model.jaffle_shop_teradata.sim_payments)
[0m17:14:55.600021 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.sim_payments
[0m17:14:55.605380 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.sim_payments"
[0m17:14:55.610965 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.sim_payments
[0m17:14:55.611601 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.sim_payments
[0m17:14:55.611999 [debug] [Thread-1  ]: Began running node test.jaffle_shop_teradata.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m17:14:55.612388 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.sim_payments, now test.jaffle_shop_teradata.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278)
[0m17:14:55.612795 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop_teradata.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m17:14:55.619026 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop_teradata.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m17:14:55.619844 [debug] [Thread-1  ]: Began executing node test.jaffle_shop_teradata.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m17:14:55.620474 [debug] [Thread-1  ]: Finished running node test.jaffle_shop_teradata.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m17:14:55.620856 [debug] [Thread-1  ]: Began running node test.jaffle_shop_teradata.not_null_stg_payments_payment_id.c19cc50075
[0m17:14:55.621275 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.jaffle_shop_teradata.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278, now test.jaffle_shop_teradata.not_null_stg_payments_payment_id.c19cc50075)
[0m17:14:55.621622 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop_teradata.not_null_stg_payments_payment_id.c19cc50075
[0m17:14:55.625374 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop_teradata.not_null_stg_payments_payment_id.c19cc50075"
[0m17:14:55.626119 [debug] [Thread-1  ]: Began executing node test.jaffle_shop_teradata.not_null_stg_payments_payment_id.c19cc50075
[0m17:14:55.626727 [debug] [Thread-1  ]: Finished running node test.jaffle_shop_teradata.not_null_stg_payments_payment_id.c19cc50075
[0m17:14:55.627092 [debug] [Thread-1  ]: Began running node test.jaffle_shop_teradata.unique_stg_payments_payment_id.3744510712
[0m17:14:55.627480 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.jaffle_shop_teradata.not_null_stg_payments_payment_id.c19cc50075, now test.jaffle_shop_teradata.unique_stg_payments_payment_id.3744510712)
[0m17:14:55.627837 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop_teradata.unique_stg_payments_payment_id.3744510712
[0m17:14:55.631479 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop_teradata.unique_stg_payments_payment_id.3744510712"
[0m17:14:55.632177 [debug] [Thread-1  ]: Began executing node test.jaffle_shop_teradata.unique_stg_payments_payment_id.3744510712
[0m17:14:55.632749 [debug] [Thread-1  ]: Finished running node test.jaffle_shop_teradata.unique_stg_payments_payment_id.3744510712
[0m17:14:55.633110 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_customers
[0m17:14:55.633481 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.jaffle_shop_teradata.unique_stg_payments_payment_id.3744510712, now model.jaffle_shop_teradata.lim_customers)
[0m17:14:55.633793 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_customers
[0m17:14:55.650200 [debug] [Thread-1  ]: use_qvci set to : false
[0m17:14:55.650766 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m17:14:55.651225 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        WHEN ColumnsV.ColumnType = 'JN' THEN 'JSON'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType in (1, 2) THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'sim_customers' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
[0m17:14:55.651682 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:14:56.306181 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:14:56.308948 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:14:56.774375 [debug] [Thread-1  ]: SQL status: activity: Select, rows_affected: 5 in 1.122 seconds
[0m17:14:56.785922 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_customers"
[0m17:14:56.802477 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_customers
[0m17:14:56.803268 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: Close
[0m17:14:56.871563 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_customers
[0m17:14:56.873625 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_orders
[0m17:14:56.874822 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.lim_customers, now model.jaffle_shop_teradata.lim_orders)
[0m17:14:56.875762 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_orders
[0m17:14:56.892277 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_orders"
[0m17:14:56.905596 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_orders
[0m17:14:56.906720 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_orders
[0m17:14:56.907281 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_payments
[0m17:14:56.907912 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.lim_orders, now model.jaffle_shop_teradata.lim_payments)
[0m17:14:56.908414 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_payments
[0m17:14:56.913741 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_payments"
[0m17:14:56.941185 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_payments
[0m17:14:56.942929 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_payments
[0m17:14:56.944463 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.customer_lifetime_value
[0m17:14:56.945368 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.lim_payments, now model.jaffle_shop_teradata.customer_lifetime_value)
[0m17:14:56.945937 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.customer_lifetime_value
[0m17:14:56.953397 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.customer_lifetime_value"
[0m17:14:56.958323 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.customer_lifetime_value
[0m17:14:56.959424 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.customer_lifetime_value
[0m17:14:56.959996 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.dim_payment_method
[0m17:14:56.960654 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.customer_lifetime_value, now model.jaffle_shop_teradata.dim_payment_method)
[0m17:14:56.961262 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.dim_payment_method
[0m17:14:56.965414 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.dim_payment_method"
[0m17:14:56.968657 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.dim_payment_method
[0m17:14:56.969579 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.dim_payment_method
[0m17:14:56.970054 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.order_payments
[0m17:14:56.970549 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.dim_payment_method, now model.jaffle_shop_teradata.order_payments)
[0m17:14:56.970936 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.order_payments
[0m17:14:56.977052 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.order_payments"
[0m17:14:56.980710 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.order_payments
[0m17:14:56.981571 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.order_payments
[0m17:14:56.982016 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.dim_customers
[0m17:14:56.982496 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.order_payments, now model.jaffle_shop_teradata.dim_customers)
[0m17:14:56.982959 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.dim_customers
[0m17:14:56.987138 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.dim_customers"
[0m17:14:56.990573 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.dim_customers
[0m17:14:56.991617 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.dim_customers
[0m17:14:56.992052 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.fct_orders
[0m17:14:56.992726 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.dim_customers, now model.jaffle_shop_teradata.fct_orders)
[0m17:14:56.993166 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.fct_orders
[0m17:14:56.997318 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.fct_orders"
[0m17:14:57.004897 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.fct_orders
[0m17:14:57.005644 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.fct_orders
[0m17:14:57.006033 [debug] [Thread-1  ]: Began running node snapshot.jaffle_shop_teradata.dim_customers_snapshot
[0m17:14:57.006422 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop_teradata.fct_orders, now snapshot.jaffle_shop_teradata.dim_customers_snapshot)
[0m17:14:57.006727 [debug] [Thread-1  ]: Began compiling node snapshot.jaffle_shop_teradata.dim_customers_snapshot
[0m17:14:57.010024 [debug] [Thread-1  ]: Began executing node snapshot.jaffle_shop_teradata.dim_customers_snapshot
[0m17:14:57.010584 [debug] [Thread-1  ]: Finished running node snapshot.jaffle_shop_teradata.dim_customers_snapshot
[0m17:14:57.011258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:57.011498 [debug] [MainThread]: Connection 'snapshot.jaffle_shop_teradata.dim_customers_snapshot' was properly closed.
[0m17:14:57.014831 [debug] [MainThread]: Command end result
[0m17:14:57.303682 [debug] [MainThread]: Acquiring new teradata connection 'generate_catalog'
[0m17:14:57.304055 [info ] [MainThread]: Building catalog
[0m17:14:57.313532 [debug] [ThreadPool]: Acquiring new teradata connection 'None.information_schema'
[0m17:14:57.319417 [debug] [ThreadPool]: use_qvci set to : false
[0m17:14:57.325532 [debug] [ThreadPool]: Using teradata connection "None.information_schema"
[0m17:14:57.326389 [debug] [ThreadPool]: On None.information_schema: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "None.information_schema"} */
with tables as (
              SELECT			
        NULL AS table_database,
        DatabaseName AS table_schema,
        TableName AS table_name,
        CASE WHEN TableKind = 'T' THEN 'table'
            WHEN TableKind = 'O' THEN 'view'
            WHEN TableKind = 'V' THEN 'view'
            ELSE TableKind
        END AS table_type,
        NULL AS table_owner
    FROM DBC.tablesV
              where (
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('raw_customers')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('lim_customers')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('stg_customers')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('fct_orders')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('stg_orders')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('order_payments')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('sim_customers')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('raw_market_customers')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('customer')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('raw_market_competitors')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('stg_payments')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('sim_orders')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('key_customer')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('dim_customers')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('stg_market_customers')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('sim_payments')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('lim_payments')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('dim_payment_method')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('raw_payments')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('lim_market_customers')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('lim_orders')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('customer_lifetime_value')
                )
             or 
                (
                    upper("table_schema") = upper('rt186001')
                    and upper("table_name") = upper('dim_customers_snapshot')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('raw_orders')
                )
            )
          ),
          columns as (
              
    SELECT
        NULL AS table_database,
        DatabaseName AS table_schema,
        TableName AS table_name,
        NULL AS table_comment,		
        ColumnName AS column_name,
        ColumnID AS column_index,
        ColumnType AS column_type,
        CommentString AS column_comment
		
        FROM DBC.ColumnsV
        
              where (
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('raw_customers')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('lim_customers')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('stg_customers')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('fct_orders')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('stg_orders')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('order_payments')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('sim_customers')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('raw_market_customers')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('customer')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('raw_market_competitors')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('stg_payments')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('sim_orders')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('key_customer')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('dim_customers')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('stg_market_customers')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('sim_payments')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('lim_payments')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('dim_payment_method')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('raw_payments')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('lim_market_customers')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('lim_orders')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('customer_lifetime_value')
                )
             or 
                (
                    upper("table_schema") = upper('rt186001')
                    and upper("table_name") = upper('dim_customers_snapshot')
                )
             or 
                (
                    upper("table_schema") = upper('demo_user')
                    and upper("table_name") = upper('raw_orders')
                )
            )
          )
          ,
    columns_transformed AS (
        SELECT
          table_database,
          table_schema,
          table_name,
          table_comment,
          column_name,
          column_index,
          CASE
            WHEN column_type = '++' THEN 'TD_ANYTYPE'
            WHEN column_type = 'A1' THEN 'ARRAY'
            WHEN column_type = 'AN' THEN 'ARRAY'
            WHEN column_type = 'I8' THEN 'BIGINT'
            WHEN column_type = 'BO' THEN 'BINARY LARGE OBJECT'
            WHEN column_type = 'BF' THEN 'BYTE'
            WHEN column_type = 'BV' THEN 'BYTE VARYING'
            WHEN column_type = 'I1' THEN 'BYTEINT'
            WHEN column_type = 'CF' THEN 'CHARACTER'
            WHEN column_type = 'CV' THEN 'CHARACTER'
            WHEN column_type = 'CO' THEN 'CHARACTER LARGE OBJECT'
            WHEN column_type = 'D' THEN 'DECIMAL'
            WHEN column_type = 'DA' THEN 'DATE'
            WHEN column_type = 'F' THEN 'DOUBLE PRECISION'
            WHEN column_type = 'I' THEN 'INTEGER'
            WHEN column_type = 'DY' THEN 'INTERVAL DAY'
            WHEN column_type = 'DH' THEN 'INTERVAL DAY TO HOUR'
            WHEN column_type = 'DM' THEN 'INTERVAL DAY TO MINUTE'
            WHEN column_type = 'DS' THEN 'INTERVAL DAY TO SECOND'
            WHEN column_type = 'HR' THEN 'INTERVAL HOUR'
            WHEN column_type = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
            WHEN column_type = 'HS' THEN 'INTERVAL HOUR TO SECOND'
            WHEN column_type = 'MI' THEN 'INTERVAL MINUTE'
            WHEN column_type = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
            WHEN column_type = 'MO' THEN 'INTERVAL MONTH'
            WHEN column_type = 'SC' THEN 'INTERVAL SECOND'
            WHEN column_type = 'YR' THEN 'INTERVAL YEAR'
            WHEN column_type = 'YM' THEN 'INTERVAL YEAR TO MONTH'
            WHEN column_type = 'N' THEN 'NUMBER'
            WHEN column_type = 'D' THEN 'NUMERIC'
            WHEN column_type = 'PD' THEN 'PERIOD(DATE)'
            WHEN column_type = 'PT' THEN 'PERIOD(TIME(n))'
            WHEN column_type = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
            WHEN column_type = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
            WHEN column_type = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
            WHEN column_type = 'F' THEN 'REAL'
            WHEN column_type = 'I2' THEN 'SMALLINT'
            WHEN column_type = 'AT' THEN 'TIME'
            WHEN column_type = 'TS' THEN 'TIMESTAMP'
            WHEN column_type = 'TZ' THEN 'TIME WITH TIME ZONE'
            WHEN column_type = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
            WHEN column_type = 'UT' THEN 'USER‑DEFINED TYPE'
            WHEN column_type = 'XM' THEN 'XML'
            ELSE 'N/A'
          END AS column_type,
          column_comment
        FROM columns
    ),
    joined AS (
      SELECT
          columns_transformed.table_database,
          columns_transformed.table_schema,
          columns_transformed.table_name,
          tables.table_type,
          columns_transformed.table_comment,
          tables.table_owner,
          columns_transformed.column_name,
          columns_transformed.column_index,
          columns_transformed.column_type,
          columns_transformed.column_comment
      FROM tables
      JOIN columns_transformed ON
        tables.table_schema = columns_transformed.table_schema
        AND tables.table_name = columns_transformed.table_name
    )
    SELECT *
    FROM joined
    ORDER BY table_schema, table_name, column_index
[0m17:14:57.327208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:57.992643 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:14:57.995358 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:14:58.855556 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 109 in 1.528 seconds
[0m17:14:58.882074 [debug] [ThreadPool]: On None.information_schema: Close
[0m17:14:59.013934 [info ] [MainThread]: Catalog written to /Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata/target/catalog.json
[0m17:14:59.025152 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 9.018523, "process_user_time": 2.305524, "process_kernel_time": 0.328518, "process_mem_max_rss": "125579264", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:14:59.025867 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:14:59.025764 after 9.02 seconds
[0m17:14:59.026222 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:14:59.026481 [debug] [MainThread]: Connection 'None.information_schema' was properly closed.
[0m17:14:59.026787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd770d6e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77211e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd772e1e160>]}
[0m17:14:59.027142 [debug] [MainThread]: Flushing usage events
[0m17:15:06.420751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2003252e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd212b01ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd212b01c10>]}


============================== 17:15:06.425866 | 3fa276a6-160e-4b51-9eab-f18dbb3837c7 ==============================
[0m17:15:06.425866 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:15:06.426380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/remi.turpaud/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:15:06.687576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fa276a6-160e-4b51-9eab-f18dbb3837c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd213057100>]}
[0m17:15:06.724096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fa276a6-160e-4b51-9eab-f18dbb3837c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd212940ca0>]}
[0m17:17:31.239634 [error] [MainThread]: Encountered an error:

[0m17:17:31.305298 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata/venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata/venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata/venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata/venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata/venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata/venv/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata/venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Users/remi.turpaud/opt/anaconda3/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/Users/remi.turpaud/opt/anaconda3/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m17:17:31.312979 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 144.96446, "process_user_time": 1.129306, "process_kernel_time": 0.227701, "process_mem_max_rss": "101003264", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:17:31.314859 [debug] [MainThread]: Command `dbt docs serve` failed at 17:17:31.314272 after 144.97 seconds
[0m17:17:31.316177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2003252e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2132d9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2132d9f10>]}
[0m17:17:31.317099 [debug] [MainThread]: Flushing usage events
[0m17:30:20.023991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad18fa76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7face835ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7face835a130>]}


============================== 17:30:20.033343 | 82bece57-21e9-48e8-9526-e4c748403c0b ==============================
[0m17:30:20.033343 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:30:20.033968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/remi.turpaud/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:30:20.905247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82bece57-21e9-48e8-9526-e4c748403c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facf88faac0>]}
[0m17:30:20.943998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82bece57-21e9-48e8-9526-e4c748403c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad082c0880>]}
[0m17:30:20.953139 [info ] [MainThread]: Registered adapter: teradata=1.8.0
[0m17:30:20.997731 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:30:21.246592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:30:21.247073 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:30:21.253209 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop
- models.jaffle_shop.staging
[0m17:30:21.315315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82bece57-21e9-48e8-9526-e4c748403c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facf8a16130>]}
[0m17:30:21.551471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82bece57-21e9-48e8-9526-e4c748403c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad1a8d5df0>]}
[0m17:30:21.552118 [info ] [MainThread]: Found 19 models, 1 snapshot, 3 seeds, 8 data tests, 2 sources, 572 macros
[0m17:30:21.552498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82bece57-21e9-48e8-9526-e4c748403c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad1a8d2880>]}
[0m17:30:21.554147 [info ] [MainThread]: 
[0m17:30:21.554798 [debug] [MainThread]: Acquiring new teradata connection 'master'
[0m17:30:21.555701 [debug] [ThreadPool]: Acquiring new teradata connection 'list_schemas'
[0m17:30:21.568154 [debug] [ThreadPool]: Using teradata connection "list_schemas"
[0m17:30:21.568661 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_schemas"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
[0m17:30:21.568992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:22.900918 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:22.901951 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:23.051035 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 46 in 1.481 seconds
[0m17:30:23.055915 [debug] [ThreadPool]: On list_schemas: Close
[0m17:30:23.130151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_schemas, now list_None_rt186001)
[0m17:30:23.139086 [debug] [ThreadPool]: Using teradata connection "list_None_rt186001"
[0m17:30:23.139685 [debug] [ThreadPool]: On list_None_rt186001: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_None_rt186001"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'rt186001' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
[0m17:30:23.140168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:23.808391 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:23.810680 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:23.982269 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 0 in 0.842 seconds
[0m17:30:23.984165 [debug] [ThreadPool]: On list_None_rt186001: Close
[0m17:30:24.046377 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None_rt186001, now list_None_demo_user)
[0m17:30:24.049099 [debug] [ThreadPool]: Using teradata connection "list_None_demo_user"
[0m17:30:24.049483 [debug] [ThreadPool]: On list_None_demo_user: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_None_demo_user"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
[0m17:30:24.049802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:24.688617 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:24.689148 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:24.879062 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 24 in 0.829 seconds
[0m17:30:24.882758 [debug] [ThreadPool]: On list_None_demo_user: Close
[0m17:30:24.952507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82bece57-21e9-48e8-9526-e4c748403c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad1a8d58e0>]}
[0m17:30:24.954239 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:30:24.954991 [info ] [MainThread]: 
[0m17:30:24.985506 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_market_competitors
[0m17:30:24.986828 [info ] [Thread-1  ]: 1 of 1 START sql view model demo_user.lim_market_competitors ................... [RUN]
[0m17:30:24.987884 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_None_demo_user, now model.jaffle_shop_teradata.lim_market_competitors)
[0m17:30:24.988575 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_market_competitors
[0m17:30:25.001050 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:30:25.009182 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_market_competitors
[0m17:30:25.018431 [debug] [Thread-1  ]: Setting query_band
[0m17:30:25.047529 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:30:25.048035 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_competitors"} */

    drop table demo_user.raw_market_competitors;
  
[0m17:30:25.048414 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:30:25.743265 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:25.745632 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:26.000354 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 21 in 0.952 seconds
[0m17:30:26.002762 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:30:26.003589 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_competitors"} */

    create foreign table demo_user.raw_market_competitors using (location('/GS/storage.googleapis.com/clearscape_analytics_demo_data/DEMO_Market/Competitor/'));
  
[0m17:30:28.607594 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 2.602 seconds
[0m17:30:28.625758 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:30:28.635994 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:30:28.636792 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_competitors"} */

  

  
  REPLACE VIEW "demo_user"."lim_market_competitors__dbt_tmp" AS
    /*
  Build a light integrated modeled layer from source image 
  for entity `market_competitors`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
*/

select new ST_GEOMETRY(ptLocWkt) competitor_location_pt
from "demo_user"."stg_market_customers" s


[0m17:30:28.849056 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 0.211 seconds
[0m17:30:28.855956 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:30:28.856452 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_competitors"} */

    DROP view /*+ IF EXISTS */ "demo_user"."lim_market_competitors__dbt_backup";
  
[0m17:30:28.899457 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1159] [Teradata Database] [Error 3807] Object 'demo_user.lim_market_competitors__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m17:30:28.901067 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:30:28.901454 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_competitors"} */

    RENAME view "demo_user"."lim_market_competitors" TO "demo_user"."lim_market_competitors__dbt_backup"
  
[0m17:30:29.090155 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.188 seconds
[0m17:30:29.097675 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:30:29.098377 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_competitors"} */

    DROP view /*+ IF EXISTS */ "demo_user"."lim_market_competitors";
  
[0m17:30:29.141914 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1159] [Teradata Database] [Error 3807] Object 'demo_user.lim_market_competitors' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m17:30:29.143965 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:30:29.144508 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_competitors"} */

    RENAME view "demo_user"."lim_market_competitors__dbt_tmp" TO "demo_user"."lim_market_competitors"
  
[0m17:30:29.313346 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.168 seconds
[0m17:30:29.369935 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:30:29.370486 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_competitors"} */
DROP view /*+ IF EXISTS */ "demo_user"."lim_market_competitors__dbt_backup";
[0m17:30:29.560494 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 9 in 0.190 seconds
[0m17:30:29.562891 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: Close
[0m17:30:29.626241 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82bece57-21e9-48e8-9526-e4c748403c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad1928ce50>]}
[0m17:30:29.627030 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo_user.lim_market_competitors .............. [[32mactivity: Create View, rows_affected: 0[0m in 4.64s]
[0m17:30:29.627619 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_market_competitors
[0m17:30:29.628614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:29.628915 [debug] [MainThread]: Connection 'model.jaffle_shop_teradata.lim_market_competitors' was properly closed.
[0m17:30:29.629220 [info ] [MainThread]: 
[0m17:30:29.629541 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.07 seconds (8.07s).
[0m17:30:29.630146 [debug] [MainThread]: Command end result
[0m17:30:29.673285 [info ] [MainThread]: 
[0m17:30:29.673922 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:30:29.674484 [info ] [MainThread]: 
[0m17:30:29.674987 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:30:29.679426 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.749972, "process_user_time": 2.171049, "process_kernel_time": 0.366527, "process_mem_max_rss": "123441152", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:30:29.680076 [debug] [MainThread]: Command `cli run` succeeded at 17:30:29.679976 after 9.75 seconds
[0m17:30:29.680544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad18fa76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facf89a87f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facf89a8b20>]}
[0m17:30:29.680961 [debug] [MainThread]: Flushing usage events
[0m17:30:34.769889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c0f28640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5902b2f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5902b2310>]}


============================== 17:30:34.776813 | a4d1a5f9-b088-4406-870b-db8638596ff4 ==============================
[0m17:30:34.776813 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:30:34.777391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/remi.turpaud/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:30:35.091683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4d1a5f9-b088-4406-870b-db8638596ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa590633be0>]}
[0m17:30:35.133730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4d1a5f9-b088-4406-870b-db8638596ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b03ed250>]}
[0m17:30:35.135326 [info ] [MainThread]: Registered adapter: teradata=1.8.0
[0m17:30:35.166814 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:30:35.410692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:30:35.411210 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:30:35.417611 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop
- models.jaffle_shop.staging
[0m17:30:35.481104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4d1a5f9-b088-4406-870b-db8638596ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c1e3e130>]}
[0m17:30:35.640492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4d1a5f9-b088-4406-870b-db8638596ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5805efaf0>]}
[0m17:30:35.641237 [info ] [MainThread]: Found 19 models, 1 snapshot, 3 seeds, 8 data tests, 2 sources, 572 macros
[0m17:30:35.641700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4d1a5f9-b088-4406-870b-db8638596ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c1e4f760>]}
[0m17:30:35.643357 [info ] [MainThread]: 
[0m17:30:35.644032 [debug] [MainThread]: Acquiring new teradata connection 'master'
[0m17:30:35.644986 [debug] [ThreadPool]: Acquiring new teradata connection 'list_schemas'
[0m17:30:35.656922 [debug] [ThreadPool]: Using teradata connection "list_schemas"
[0m17:30:35.657399 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_schemas"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
[0m17:30:35.657740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:36.658163 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:36.659840 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:36.836607 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 46 in 1.177 seconds
[0m17:30:36.844056 [debug] [ThreadPool]: On list_schemas: Close
[0m17:30:36.936851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_schemas, now list_None_rt186001)
[0m17:30:36.946787 [debug] [ThreadPool]: Using teradata connection "list_None_rt186001"
[0m17:30:36.947408 [debug] [ThreadPool]: On list_None_rt186001: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_None_rt186001"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'rt186001' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
[0m17:30:36.947912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:37.585649 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:37.589148 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:37.784389 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 0 in 0.835 seconds
[0m17:30:37.788571 [debug] [ThreadPool]: On list_None_rt186001: Close
[0m17:30:37.849781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None_rt186001, now list_None_demo_user)
[0m17:30:37.856358 [debug] [ThreadPool]: Using teradata connection "list_None_demo_user"
[0m17:30:37.857303 [debug] [ThreadPool]: On list_None_demo_user: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_None_demo_user"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
[0m17:30:37.858250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:38.748944 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:38.750127 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:38.983211 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 24 in 1.125 seconds
[0m17:30:38.987841 [debug] [ThreadPool]: On list_None_demo_user: Close
[0m17:30:39.112296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4d1a5f9-b088-4406-870b-db8638596ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5805efc70>]}
[0m17:30:39.112969 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:30:39.113334 [info ] [MainThread]: 
[0m17:30:39.116684 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_customers
[0m17:30:39.117298 [info ] [Thread-1  ]: 1 of 1 START sql incremental model demo_user.lim_customers ..................... [RUN]
[0m17:30:39.117800 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_None_demo_user, now model.jaffle_shop_teradata.lim_customers)
[0m17:30:39.118213 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_customers
[0m17:30:39.145190 [debug] [Thread-1  ]: use_qvci set to : false
[0m17:30:39.146100 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m17:30:39.146759 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        WHEN ColumnsV.ColumnType = 'JN' THEN 'JSON'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType in (1, 2) THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'sim_customers' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
[0m17:30:39.147464 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:30:39.793340 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:39.793933 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:40.174037 [debug] [Thread-1  ]: SQL status: activity: Select, rows_affected: 5 in 1.026 seconds
[0m17:30:40.183142 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_customers"
[0m17:30:40.187892 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_customers
[0m17:30:40.214368 [debug] [Thread-1  ]: Setting query_band
[0m17:30:40.233142 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m17:30:40.233662 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

        insert into "demo_user"."key_customer"
    select
        rank() over(partition by domain_cd order by customer_nk) (integer) customer_key 
        ,nk (varchar(10000)) customer_nk
        ,domain_cd (char(100)) domain_cd
        ,current_timestamp created_ts
    from 
    (
        select coalesce(trim(email), '') nk
        , 'retail' domain_cd 
        from "demo_user"."sim_customers"
        group by 1,2
    ) source
    where not exists
    (sel 1 from  "demo_user"."key_customer" k where k.customer_nk=source.nk and k.domain_cd=source.domain_cd )
      
[0m17:30:40.556072 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 0 in 0.320 seconds
[0m17:30:40.563466 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m17:30:40.564503 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

        insert into "demo_user"."key_customer"
    select
        rank() over(partition by domain_cd order by customer_nk) (integer) customer_key 
        ,nk (varchar(10000)) customer_nk
        ,domain_cd (char(100)) domain_cd
        ,current_timestamp created_ts
    from 
    (
        select coalesce(trim(last_name), '') nk
        , 'families' domain_cd 
        from "demo_user"."sim_customers"
        group by 1,2
    ) source
    where not exists
    (sel 1 from  "demo_user"."key_customer" k where k.customer_nk=source.nk and k.domain_cd=source.domain_cd )
      
[0m17:30:40.868723 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 0 in 0.303 seconds
[0m17:30:40.895328 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m17:30:40.896140 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

      CREATE  TABLE
      "demo_user"."lim_customers__dbt_tmp"
      AS (
            /*
  Build a light integrated modeled layer from source image 
  for entity `customers`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
  - Surrogate key assigment
  - Naming conventions alignment
*/










with source as
(
  select
  s.*
  from "demo_user"."sim_customers" s
  where valid_period contains current_timestamp
)
select
    --Value columns
      customer_id,
      first_name,
      email,
      valid_period
    --Surrogate key columns
    ,coalesce(customer.customer_key,-1) customer_key
    ,coalesce(family.customer_key,-1) family_key
from source s
--Surrogate key joins
left join "demo_user"."key_customer" customer
  on customer.customer_nk=coalesce(trim(email), '')
  and customer.domain_cd='retail'

left join "demo_user"."key_customer" family
  on family.customer_nk=coalesce(trim(last_name), '')
  and family.domain_cd='families'



        ) WITH NO DATA
      
      ;
    
[0m17:30:41.173986 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 0.277 seconds
[0m17:30:41.178531 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m17:30:41.179344 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

    
  
    
    

    INSERT INTO "demo_user"."lim_customers__dbt_tmp"
          /*
  Build a light integrated modeled layer from source image 
  for entity `customers`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
  - Surrogate key assigment
  - Naming conventions alignment
*/










with source as
(
  select
  s.*
  from "demo_user"."sim_customers" s
  where valid_period contains current_timestamp
)
select
    --Value columns
      customer_id,
      first_name,
      email,
      valid_period
    --Surrogate key columns
    ,coalesce(customer.customer_key,-1) customer_key
    ,coalesce(family.customer_key,-1) family_key
from source s
--Surrogate key joins
left join "demo_user"."key_customer" customer
  on customer.customer_nk=coalesce(trim(email), '')
  and customer.domain_cd='retail'

left join "demo_user"."key_customer" family
  on family.customer_nk=coalesce(trim(last_name), '')
  and family.domain_cd='families'



    ;
  

  
  
[0m17:30:41.455723 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 100 in 0.275 seconds
[0m17:30:41.517803 [debug] [Thread-1  ]: use_qvci set to : false
[0m17:30:41.518747 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m17:30:41.519399 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        WHEN ColumnsV.ColumnType = 'JN' THEN 'JSON'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType in (1, 2) THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'lim_customers__dbt_tmp' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
[0m17:30:41.989118 [debug] [Thread-1  ]: SQL status: activity: Select, rows_affected: 6 in 0.468 seconds
[0m17:30:41.999408 [debug] [Thread-1  ]: use_qvci set to : false
[0m17:30:42.001331 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m17:30:42.002543 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        WHEN ColumnsV.ColumnType = 'JN' THEN 'JSON'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType in (1, 2) THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'lim_customers' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
[0m17:30:42.384004 [debug] [Thread-1  ]: SQL status: activity: Select, rows_affected: 6 in 0.380 seconds
[0m17:30:42.393043 [debug] [Thread-1  ]: use_qvci set to : false
[0m17:30:42.394304 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m17:30:42.395133 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        WHEN ColumnsV.ColumnType = 'JN' THEN 'JSON'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType in (1, 2) THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'lim_customers' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
[0m17:30:42.859529 [debug] [Thread-1  ]: SQL status: activity: Select, rows_affected: 6 in 0.464 seconds
[0m17:30:42.872089 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m17:30:42.872649 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

            
            DELETE
            FROM "demo_user"."lim_customers"
            WHERE (customer_key) IN (
                SELECT (customer_key)
                FROM "demo_user"."lim_customers__dbt_tmp"
            );

        
    
[0m17:30:43.083160 [debug] [Thread-1  ]: SQL status: activity: Delete, rows_affected: 100 in 0.210 seconds
[0m17:30:43.084781 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.lim_customers"
[0m17:30:43.094557 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m17:30:43.095102 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */

   
    INSERT INTO "demo_user"."lim_customers" ("customer_id", "first_name", "email", "valid_period", "customer_key", "family_key")
       SELECT "customer_id", "first_name", "email", "valid_period", "customer_key", "family_key"
       FROM "demo_user"."lim_customers__dbt_tmp"
    ;

[0m17:30:43.241537 [debug] [Thread-1  ]: SQL status: activity: Insert, rows_affected: 100 in 0.146 seconds
[0m17:30:43.261194 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_customers"
[0m17:30:43.262072 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_customers"} */
DROP table /*+ IF EXISTS */ "demo_user"."lim_customers__dbt_tmp";
[0m17:30:43.537600 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 20 in 0.275 seconds
[0m17:30:43.540456 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_customers: Close
[0m17:30:43.601682 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d1a5f9-b088-4406-870b-db8638596ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b06bd280>]}
[0m17:30:43.602718 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model demo_user.lim_customers ................ [[32mactivity: Insert, rows_affected: 100[0m in 4.48s]
[0m17:30:43.603388 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_customers
[0m17:30:43.604567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:43.604960 [debug] [MainThread]: Connection 'model.jaffle_shop_teradata.lim_customers' was properly closed.
[0m17:30:43.605332 [info ] [MainThread]: 
[0m17:30:43.605707 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.96 seconds (7.96s).
[0m17:30:43.606356 [debug] [MainThread]: Command end result
[0m17:30:43.648215 [info ] [MainThread]: 
[0m17:30:43.648769 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:30:43.649206 [info ] [MainThread]: 
[0m17:30:43.649678 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:30:43.652522 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.971373, "process_user_time": 2.150118, "process_kernel_time": 0.321683, "process_mem_max_rss": "125304832", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:30:43.653040 [debug] [MainThread]: Command `cli run` succeeded at 17:30:43.652959 after 8.97 seconds
[0m17:30:43.653420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c0f28640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa590503310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c197aee0>]}
[0m17:30:43.653770 [debug] [MainThread]: Flushing usage events
[0m17:30:52.236423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc578f086a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc56839ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc56839a130>]}


============================== 17:30:52.242348 | 3d33e791-b387-41eb-8934-2bb01ad4375d ==============================
[0m17:30:52.242348 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:30:52.242992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/remi.turpaud/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/remi.turpaud/Code/dbt/testing/jaffle_shop_teradata/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m17:30:52.522772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d33e791-b387-41eb-8934-2bb01ad4375d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc57a7fdac0>]}
[0m17:30:52.562390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d33e791-b387-41eb-8934-2bb01ad4375d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc598510880>]}
[0m17:30:52.563801 [info ] [MainThread]: Registered adapter: teradata=1.8.0
[0m17:30:52.596310 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:30:52.859386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:30:52.859900 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:30:52.866325 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.staging
- models.jaffle_shop
[0m17:30:52.929334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d33e791-b387-41eb-8934-2bb01ad4375d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc57a857130>]}
[0m17:30:53.084899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d33e791-b387-41eb-8934-2bb01ad4375d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc59877ddf0>]}
[0m17:30:53.085554 [info ] [MainThread]: Found 19 models, 1 snapshot, 3 seeds, 8 data tests, 2 sources, 572 macros
[0m17:30:53.085965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d33e791-b387-41eb-8934-2bb01ad4375d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc59877b880>]}
[0m17:30:53.087614 [info ] [MainThread]: 
[0m17:30:53.088394 [debug] [MainThread]: Acquiring new teradata connection 'master'
[0m17:30:53.089512 [debug] [ThreadPool]: Acquiring new teradata connection 'list_schemas'
[0m17:30:53.101915 [debug] [ThreadPool]: Using teradata connection "list_schemas"
[0m17:30:53.102417 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_schemas"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
[0m17:30:53.102751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:53.890534 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:53.892455 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:54.045988 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 46 in 0.941 seconds
[0m17:30:54.049877 [debug] [ThreadPool]: On list_schemas: Close
[0m17:30:54.127384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_schemas, now list_None_demo_user)
[0m17:30:54.136909 [debug] [ThreadPool]: Using teradata connection "list_None_demo_user"
[0m17:30:54.137704 [debug] [ThreadPool]: On list_None_demo_user: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_None_demo_user"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'demo_user' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
[0m17:30:54.138304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:54.975145 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:54.977029 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:55.210342 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 24 in 1.072 seconds
[0m17:30:55.213081 [debug] [ThreadPool]: On list_None_demo_user: Close
[0m17:30:55.278883 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None_demo_user, now list_None_rt186001)
[0m17:30:55.284395 [debug] [ThreadPool]: Using teradata connection "list_None_rt186001"
[0m17:30:55.284804 [debug] [ThreadPool]: On list_None_rt186001: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "connection_name": "list_None_rt186001"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'rt186001' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
[0m17:30:55.285158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:55.910695 [debug] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:55.911569 [info ] [ThreadPool]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:56.083540 [debug] [ThreadPool]: SQL status: activity: Select, rows_affected: 0 in 0.798 seconds
[0m17:30:56.088834 [debug] [ThreadPool]: On list_None_rt186001: Close
[0m17:30:56.149808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d33e791-b387-41eb-8934-2bb01ad4375d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc59852ff40>]}
[0m17:30:56.152572 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:30:56.153836 [info ] [MainThread]: 
[0m17:30:56.162989 [debug] [Thread-1  ]: Began running node model.jaffle_shop_teradata.lim_market_competitors
[0m17:30:56.164567 [info ] [Thread-1  ]: 1 of 1 START sql view model demo_user.lim_market_competitors ................... [RUN]
[0m17:30:56.165795 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_None_rt186001, now model.jaffle_shop_teradata.lim_market_competitors)
[0m17:30:56.166584 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop_teradata.lim_market_competitors
[0m17:30:56.182362 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:30:56.188420 [debug] [Thread-1  ]: Began executing node model.jaffle_shop_teradata.lim_market_competitors
[0m17:30:56.198251 [debug] [Thread-1  ]: Setting query_band
[0m17:30:56.227051 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:30:56.227567 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_competitors"} */

    drop table demo_user.raw_market_competitors;
  
[0m17:30:56.227953 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:30:56.888593 [debug] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:56.891416 [info ] [Thread-1  ]: teradata adapter: Query Band set to ['=S> org=teradata-internal-telem;appname=dbt;']
[0m17:30:57.149129 [debug] [Thread-1  ]: SQL status: activity: Drop Table, rows_affected: 21 in 0.920 seconds
[0m17:30:57.155552 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:30:57.156892 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_competitors"} */

    create foreign table demo_user.raw_market_competitors using (location('/GS/storage.googleapis.com/clearscape_analytics_demo_data/DEMO_Market/Competitor/'));
  
[0m17:31:00.025057 [debug] [Thread-1  ]: SQL status: activity: Create Table, rows_affected: 0 in 2.867 seconds
[0m17:31:00.035786 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:31:00.046181 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:31:00.046883 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_competitors"} */

  

  
  REPLACE VIEW "demo_user"."lim_market_competitors__dbt_tmp" AS
    /*
  Build a light integrated modeled layer from source image 
  for entity `market_competitors`, performing: 
  - Data domain aligments (eg. using standard data types, units conversions, codes standardization...)
*/

select new ST_GEOMETRY(ptLocWkt) competitor_location_pt
from "demo_user"."stg_market_customers" s


[0m17:31:00.304072 [debug] [Thread-1  ]: SQL status: activity: Create View, rows_affected: 0 in 0.254 seconds
[0m17:31:00.314318 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:31:00.314874 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_competitors"} */

    DROP view /*+ IF EXISTS */ "demo_user"."lim_market_competitors__dbt_backup";
  
[0m17:31:00.361615 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1167] [Teradata Database] [Error 3807] Object 'demo_user.lim_market_competitors__dbt_backup' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m17:31:00.363435 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:31:00.364037 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_competitors"} */

    RENAME view "demo_user"."lim_market_competitors" TO "demo_user"."lim_market_competitors__dbt_backup"
  
[0m17:31:00.553030 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.188 seconds
[0m17:31:00.557059 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:31:00.557520 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_competitors"} */

    DROP view /*+ IF EXISTS */ "demo_user"."lim_market_competitors";
  
[0m17:31:00.599702 [debug] [Thread-1  ]: teradata adapter: Teradata error: [Version 20.0.0.15] [Session 1167] [Teradata Database] [Error 3807] Object 'demo_user.lim_market_competitors' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
[0m17:31:00.601094 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:31:00.601498 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_competitors"} */

    RENAME view "demo_user"."lim_market_competitors__dbt_tmp" TO "demo_user"."lim_market_competitors"
  
[0m17:31:00.769073 [debug] [Thread-1  ]: SQL status: activity: Rename View, rows_affected: 2 in 0.167 seconds
[0m17:31:00.824252 [debug] [Thread-1  ]: Using teradata connection "model.jaffle_shop_teradata.lim_market_competitors"
[0m17:31:00.824727 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "jaffle_shop_teradata", "target_name": "dev", "node_id": "model.jaffle_shop_teradata.lim_market_competitors"} */
DROP view /*+ IF EXISTS */ "demo_user"."lim_market_competitors__dbt_backup";
[0m17:31:00.992864 [debug] [Thread-1  ]: SQL status: activity: Drop View, rows_affected: 7 in 0.168 seconds
[0m17:31:00.996577 [debug] [Thread-1  ]: On model.jaffle_shop_teradata.lim_market_competitors: Close
[0m17:31:01.056113 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d33e791-b387-41eb-8934-2bb01ad4375d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc579074e50>]}
[0m17:31:01.057572 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo_user.lim_market_competitors .............. [[32mactivity: Create View, rows_affected: 0[0m in 4.89s]
[0m17:31:01.058761 [debug] [Thread-1  ]: Finished running node model.jaffle_shop_teradata.lim_market_competitors
[0m17:31:01.060532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:01.061051 [debug] [MainThread]: Connection 'model.jaffle_shop_teradata.lim_market_competitors' was properly closed.
[0m17:31:01.061571 [info ] [MainThread]: 
[0m17:31:01.062107 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.97 seconds (7.97s).
[0m17:31:01.063022 [debug] [MainThread]: Command end result
[0m17:31:01.115348 [info ] [MainThread]: 
[0m17:31:01.115910 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:31:01.116462 [info ] [MainThread]: 
[0m17:31:01.116938 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:31:01.119666 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.9636545, "process_user_time": 1.970561, "process_kernel_time": 0.306778, "process_mem_max_rss": "122462208", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:31:01.120288 [debug] [MainThread]: Command `cli run` succeeded at 17:31:01.120196 after 8.96 seconds
[0m17:31:01.120715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc578f086a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc568498730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc568498760>]}
[0m17:31:01.121162 [debug] [MainThread]: Flushing usage events
